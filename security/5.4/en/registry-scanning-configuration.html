<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Registry Scanning Configuration :: Rancher product documentation</title>
    <link rel="canonical" href="https://documentation.suse.com/cloudnative/security/5.4/en/registry-scanning-configuration.html">
    <link rel="prev" href="compliance.html">
    <link rel="next" href="harbor.html">
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../../../_/css/site.css">
<meta http-equiv="last-modified" content="2025-06-25"/>
<link rel="stylesheet" href="../../../_/css/search.css">
<link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="../../../_/css/font-styles.css">
<link rel="stylesheet" href="../../../_/fonts/css/all.css">
<link rel="stylesheet" href="../../../_/css/site-extra.css">
<link rel="stylesheet" href="../../../_/css/vendor/tabs.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=SUSE:wght@100..800&display=swap&family=SUSE+Mono:ital,wght@0,100..800;1,100..800" rel="stylesheet">
<link href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css" rel="stylesheet">
<!-- <link href="https://fonts.googleapis.com/css?family=Montserrat|Roboto&display=swap" rel="stylesheet"> -->
<link rel="stylesheet" href="../../../_/css/vendor/light.css">
<script src="/docserv/res/lightheaded/analytics.js" type="text/javascript"></script>

<script type="module">
  import { defineCustomElements, setAssetPath } from 'https://d12w0ryu9hjsx8.cloudfront.net/shared-header/1.5/shared-header.esm.js';
  defineCustomElements();
  setAssetPath("https://d12w0ryu9hjsx8.cloudfront.net/shared-header/1.5/assets");
</script>    <script>var uiRootPath = '../../../_'</script>
  </head>
  <body class="article">
<script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs'; mermaid.initialize({"startOnLoad":true});</script><!-- Canonical link -->
<link href="https://documentation.suse.com/cloudnative/security/5.4/en/registry-scanning-configuration.html" rel="canonical"/>

<!-- Default English link -->
<link href="https://documentation.suse.com/cloudnative/security/5.4/en/registry-scanning-configuration.html" hreflang="x-default" rel="alternate"/>

<!-- Link for the currently processed page -->
<link href="https://documentation.suse.com/cloudnative/security/5.4/en/registry-scanning-configuration.html" hrefLang="en-US" rel="alternate" />











<shared-header language="en" languages='{
"en": { "label": "English", "url": "https://documentation.suse.com/en-us/" },
"de": { "label": "Deutsch", "url": "https://documentation.suse.com/de-de/" },
"fr": { "label": "Français", "url": "https://documentation.suse.com/fr-fr/" },
"es": { "label": "Español", "url": "https://documentation.suse.com/es-es/" },
"zh_CN": { "label": "中文", "url": "https://documentation.suse.com/zh-cn/" },
"pt_BR": { "label": "Português Brasileiro", "url": "https://documentation.suse.com/pt-br/" }
}'>
</shared-header>

<!-- Leaving as a comment, I expect it will be required again next year.
<a target=_blank"" class="survey-link" href="https://suselinux.fra1.qualtrics.com/jfe/form/SV_bEiGZbUNzLD8Tcy"> Documentation survey </a>
--><div class="body">
<div class="nav-container" data-component="security" data-version="5.4">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title">SUSE® Security</h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="overview.html">SUSE® Security Overview</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Understanding SUSE® Security</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="requirements.html">System Requirements</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="installation.html">Deployment Preparation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="policy-overview.html">Security Policy Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="integration.html">Enterprise Integration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="ci-workflow.html">CI/CD Workflow</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Operational Tasks</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Deploying SUSE® Security</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="configmap.html">Deploy Using ConfigMap</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="operators.html">Deploy Using Operators</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="publick8s.html">Deploying SUSE Security on Public Cloud</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="awsmarketplace.html">AWS Marketplace Listing</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="kubernetes.html">Kubernetes</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="openshift.html">OpenShift</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="rancher.html">Rancher Deployment</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="airgap.html">Air-Gapped Deployment</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="docker.html">Docker</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="updating.html">Updating SUSE® Security</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="testing.html">Evaluating and Testing SUSE® Security</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="troubleshooting.html">Troubleshooting Deployments</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="users.html">Users and Roles</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="restore.html">Restoring SUSE® Security Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="remove.html">Removing or Resetting SUSE® Security</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="internal.html">Replacing Internal Certificates</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="replacecert.html">Replacing Self-Signed Certificates</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="rest-api.html">Connect to Manager, REST API Server</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="automation.html">Automation with REST API</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">SUSE® Security Interface</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="navigation.html">Navigating the Console</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="multicluster.html">Enterprise Multi-Cluster Management</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="modes.html">Modes: Discover, Monitor, Protect</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="reporting.html">Reporting &amp; Notifications</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="customui.html">Customizing the UI</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Security Management</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Security Policy</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Admission Controls</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="admission.html">Admission Controls</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="sigstore.html">Sigstore Cosign Signature Verifiers</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="assessment.html">Configuration Assessment for Kubernetes Resources</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="groups.html">Groups</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="networkrules.html">Network Rules</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="processrules.html">Process Profile Rules</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="filerules.html">File Access Rules</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="responserules.html">Response Rules</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="dlp.html">DLP &amp; WAF Sensors</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="threats.html">Network Threat Signatures</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="customcompliance.html">Custom Compliance Checks</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="federated.html">Federated Policy</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Custom Resource Definitions</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="usingcrd.html">Using CRD</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="import.html">Importing CRD from Console</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Security Risks, Scanning &amp; Compliance</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Scanning &amp; Compliance</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="scanning.html">Scanning</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="vulnerabilities.html">Vulnerability Management</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="compliance.html">Compliance &amp; CIS Benchmarks</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Registry Scanning</span>
<ul class="nav-list">
  <li class="nav-item is-current-page" data-depth="4">
    <a class="nav-link" href="registry-scanning-configuration.html">Registry Scanning Configuration</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="harbor.html">Harbor Pluggable Scanner Module</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="ecr-iam.html">ECR Scanning Using IAM Roles</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="gcr-sa.html">GCR Scanning Using Service Accounts</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Build Phase Image Scanning</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="build-image-scanning.html">Local</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="jenkins.html">Jenkins</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="bamboo.html">Bamboo</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="circleci.html">CircleCI</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="azuredevops.html">Azure DevOps</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="gitlab.html">Gitlab</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="github.html">GitHub</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="improve-score.html">Improve Security Risk Score</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="cve-sources.html">CVE Database Sources &amp; Version</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="updating-cve-database.html">Updating the CVE Database</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="scanners.html">Parallel &amp; Stand-Alone Scanners</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Enterprise Features</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Integration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="ldap.html">LDAP</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="msad.html">Microsoft AD</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="saml.html">SAML (Okta)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="msazure.html">SAML (Azure AD)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="adfs.html">SAML (ADFS)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="openid.html">OpenID Connect Azure/Okta</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="oidc-adfs.html">OpenID Connect (OIDC) for ADFS</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="ibmsa.html">IBM Security Advisor</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="ibmqr.html">IBM QRadar</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="splunk.html">Splunk</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">References</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="details.html">Environment Variables Details</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="cli.html">Command Line</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Release Notes</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="5x.html">5.x Release Notes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="4x.html">4.x Release Notes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="other.html">Integrations &amp; Other Components</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">UI Extension</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="dashboard.html">5.x Dashboard</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="runtime_security.html">5.x Runtime Security</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="notifications.html">5.x Notifications</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Security Advisories and CVEs</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="cve.html">Security Advisories and CVEs</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">SUSE® Security</span>
    <span class="version">5.4</span>
  </div>
  <ul class="components">
        <li class="component">
          <div class="title"><a href="../../../admission-controller/1.29/en/introduction.html">Admission Controller</a></div>
          <ul class="versions">
            <li class="version">
              <a href="../../../admission-controller/1.30/en/introduction.html">1.30-next</a>
            </li>
            <li class="version is-latest">
              <a href="../../../admission-controller/1.29/en/introduction.html">1.29</a>
            </li>
            <li class="version">
              <a href="../../../admission-controller/1.28/en/introduction.html">1.28</a>
            </li>
            <li class="version">
              <a href="../../../admission-controller/1.27/en/introduction.html">1.27</a>
            </li>
            <li class="version">
              <a href="../../../admission-controller/1.26/en/introduction.html">1.26</a>
            </li>
            <li class="version">
              <a href="../../../admission-controller/1.25/en/introduction.html">1.25</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../cluster-api/latest/en/index.html">Cluster API</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../cluster-api/latest/en/index.html">Latest</a>
            </li>
            <li class="version">
              <a href="../../../cluster-api/v0.24/en/index.html">0.24</a>
            </li>
            <li class="version">
              <a href="../../../cluster-api/v0.23/en/index.html">0.23</a>
            </li>
            <li class="version">
              <a href="../../../cluster-api/v0.22/en/index.html">0.22</a>
            </li>
            <li class="version">
              <a href="../../../cluster-api/v0.21/en/index.html">0.21</a>
            </li>
            <li class="version">
              <a href="../../../cluster-api/v0.20/en/index.html">0.20</a>
            </li>
            <li class="version">
              <a href="../../../cluster-api/v0.19/en/index.html">0.19</a>
            </li>
            <li class="version">
              <a href="../../../cluster-api/v0.18/en/index.html">0.18</a>
            </li>
            <li class="version">
              <a href="../../../cluster-api/v0.17/en/index.html">0.17</a>
            </li>
            <li class="version">
              <a href="../../../cluster-api/v0.16/en/index.html">0.16</a>
            </li>
            <li class="version">
              <a href="../../../cluster-api/v0.15/en/index.html">0.15</a>
            </li>
            <li class="version">
              <a href="../../../cluster-api/v0.14/en/index.html">0.14</a>
            </li>
            <li class="version">
              <a href="../../../cluster-api/v0.13/en/index.html">0.13</a>
            </li>
            <li class="version">
              <a href="../../../cluster-api/v0.12/en/index.html">0.12</a>
            </li>
            <li class="version">
              <a href="../../../cluster-api/v0.11/en/index.html">0.11</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../continuous-delivery/v0.12/en/index.html">Continuous Delivery</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../continuous-delivery/v0.12/en/index.html">0.12</a>
            </li>
            <li class="version">
              <a href="../../../continuous-delivery/v0.11/en/index.html">0.11</a>
            </li>
            <li class="version">
              <a href="../../../continuous-delivery/v0.10/en/index.html">0.10</a>
            </li>
            <li class="version">
              <a href="../../../continuous-delivery/v0.9/en/index.html">0.9</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../k3s/latest/en/introduction.html">K3s</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../k3s/latest/en/introduction.html">Latest</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../os-manager/next/en/index.html">OS Manager</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../os-manager/next/en/index.html">Next</a>
            </li>
            <li class="version">
              <a href="../../../os-manager/latest/en/index.html">Latest</a>
            </li>
            <li class="version">
              <a href="../../../os-manager/1.7/en/index.html">1.7</a>
            </li>
            <li class="version">
              <a href="../../../os-manager/1.6/en/index.html">1.6</a>
            </li>
            <li class="version">
              <a href="../../../os-manager/1.5/en/index.html">1.5</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../rke2/latest/en/introduction.html">RKE2</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../rke2/latest/en/introduction.html">Latest</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../suse-observability/latest/en/classic.html">SUSE Observability</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../suse-observability/latest/en/classic.html">Latest</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../rancher-manager/latest/en/about-rancher/what-is-rancher.html">SUSE® Rancher Manager</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../rancher-manager/latest/en/about-rancher/what-is-rancher.html">latest</a>
            </li>
            <li class="version">
              <a href="../../../rancher-manager/v2.12/en/about-rancher/what-is-rancher.html">v2.12</a>
            </li>
            <li class="version">
              <a href="../../../rancher-manager/v2.11/en/about-rancher/what-is-rancher.html">v2.11</a>
            </li>
            <li class="version">
              <a href="../../../rancher-manager/v2.10/en/about-rancher/what-is-rancher.html">v2.10</a>
            </li>
            <li class="version">
              <a href="../../../rancher-manager/v2.9/en/about-rancher/what-is-rancher.html">v2.9</a>
            </li>
            <li class="version">
              <a href="../../../rancher-manager/v2.8/en/about-rancher/what-is-rancher.html">v2.8</a>
            </li>
          </ul>
        </li>
        <li class="component is-current">
          <div class="title"><a href="overview.html">SUSE® Security</a></div>
          <ul class="versions">
            <li class="version is-current is-latest">
              <a href="overview.html">5.4</a>
            </li>
            <li class="version">
              <a href="../../5.3/en/overview.html">5.3</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../storage/latest/en/longhorn-documentation.html">SUSE® Storage</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../storage/latest/en/longhorn-documentation.html">Latest</a>
            </li>
            <li class="version">
              <a href="../../../storage/1.11/en/longhorn-documentation.html">1.11 (Dev)</a>
            </li>
            <li class="version">
              <a href="../../../storage/1.10/en/longhorn-documentation.html">1.10 (Dev)</a>
            </li>
            <li class="version">
              <a href="../../../storage/1.9/en/longhorn-documentation.html">1.9 (Latest)</a>
            </li>
            <li class="version">
              <a href="../../../storage/1.8/en/longhorn-documentation.html">1.8</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../virtualization/v1.5/en/introduction/overview.html">SUSE® Virtualization</a></div>
          <ul class="versions">
            <li class="version">
              <a href="../../../virtualization/v1.6/en/introduction/overview.html">v1.6 (Dev)</a>
            </li>
            <li class="version is-latest">
              <a href="../../../virtualization/v1.5/en/introduction/overview.html">v1.5 (Latest)</a>
            </li>
            <li class="version">
              <a href="../../../virtualization/v1.4/en/introduction/overview.html">v1.4</a>
            </li>
            <li class="version">
              <a href="../../../virtualization/v1.3/en/introduction/overview.html">v1.3</a>
            </li>
          </ul>
        </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
<ul>
    <li>
      <a href="https://documentation.suse.com/" title="documentation.suse.com" aria-label="SUSE Documentation Home">Documentation Home</a>
    </li>
    <li>
      <a href="https://documentation.suse.com/cloudnative/security" title="SUSE Security" aria-label="SUSE Documentation - SUSE Security">
        SUSE Security
      </a>
    </li>
      <li>
          Security Management
      </li>
  </ul>
</nav><div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">5.4</button>
  <div class="version-menu">
    <a class="version is-current" href="registry-scanning-configuration.html">5.4</a>
    <a class="version" href="../../5.3/en/registry-scanning-configuration.html">5.3</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/rancher/neuvector-product-docs/edit/main/docs/5.4/modules/en/pages/registry-scanning-configuration.adoc"><strong>Edit</strong></a></div>
        <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <label class="visual-search-label-bc" for="search-input">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>
          <input label="Search" aria-label="Search" id="search-input" type="text" placeholder="Search the docs" >
          <label class="filter checkbox" style="display: none">
            <input type="checkbox" data-facet-filter="component:security" checked> Only this project
          </label>
        </div>
      </div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="On this page" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Registry Scanning Configuration</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Registry scanning requires that the SUSE® Security Allinone or Controller container be deployed on a host/node. Please see the <a href="installation.html" class="xref page">Installation/Deployment</a> section for how to deploy the SUSE® Security containers. Configure registry scanning from the SUSE® Security console after logging in to the manager.</p>
</div>
<div class="paragraph">
<p>In addition, make sure there is a SUSE® Security scanner container deployed and configured to connect to the Allinone or Controller. In 4.0 and later, the neuvector/scanner container must be deployed separate from the allinone or controller.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Registry image scanning is performed by the scanner and the image is pulled and expanded in memory. If expanded image sizes larger than 500MB are expected, consider increasing the scanner memory to 1.5GB or more to provide capacity and headroom for the scanner.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To increase registry scanning performance and scalability, multiple scanner pods can be deployed on different nodes to distribute the scanning tasks across multiple scanners. See the section <a href="scanners.html" class="xref page">Multiple Parallel Scanners</a> for details.</p>
</div>
<div class="paragraph">
<p>For multi-cluster (federated) environments, the primary (master) cluster can scan a registry/repo designated as a federated registry. The scan results from these registries will be synchronized to all managed (remote) clusters. This enables display of scan results in the managed cluster console as well as use of the results in admission control rules of the managed cluster. Registries only need to be scanned once instead of by each cluster, reducing CPU/memory and network bandwidth usage. See the <a href="multicluster.html" class="xref page">multi-cluster</a> section for more details.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configure_registry_scanning"><a class="anchor" href="#_configure_registry_scanning"></a>Configure Registry Scanning</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To configure registries and repositories to be scanning, go to the Assets &#8594; Registries menu in the SUSE® Security console. Add or edit registries to be scanned. Use the Filter to define repositories or subsets of images to be scanned. If your registry requires access through a proxy, this can be configured in Settings &#8594; Configuration.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/registry-scan.png" alt="Registry"></span></p>
</div>
<div class="paragraph">
<p>The registry will be scanned according to a schedule, which is configurable. By default, only new or updated images will be scanned. If you want to re-scan all applicable images whenever the CVE database is updated, select the Rescan After CVE DB Update button when configuring the registry. You can also select Layered Scan to show vulnerabilities by each layer in the image (note: layered scans can take longer and consume more resources to complete).</p>
</div>
<div class="paragraph">
<p>After the scan is completed you will see the results below it. Click on the repository/tag to see vulnerabilities and click on the vulnerability to see more info. You can also download the report in a CSV file or see the results in the Event logs.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/image_scan_4.png" alt="Layered"></span></p>
</div>
<div class="paragraph">
<p>NeuVector provides a <strong>"View all scanned images"</strong> option. Users don&#8217;t have to look into a registry to see a specific image. Instead, users can click the last row to list all scanned images.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/view-all-scanned-images.png" alt="Registry"></span></p>
</div>
<div class="paragraph">
<p>Users can also land on the <strong>Registries</strong> page and open specific images from the hyperlink from the <strong>Containers</strong> page. If the image name is not clickable, it means that the image has not been scanned yet.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/link-to-image-scan-result.png" alt="Container"></span></p>
</div>
<div class="paragraph">
<p>The scan results include vulnerabilities by image layer, if this option was selected during registry/repository configuration, as well the compliance checks results. Click the compliance tab when viewing the scan results for the image to see compliance checks.</p>
</div>
<div class="paragraph">
<p>Scanning will also discover and list all Modules (ie, an inventory) in the image, as shown below. It will also summarize the vulnerability risk by module and list all vulnerabilities for each module.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/Image_Modules.png" alt="Modules"></span></p>
</div>
<div class="paragraph">
<p>Scanning is supported for images on public and private docker registries that are based on Native Docker, Amazon ECR, Redhat/Openshift, jFrog, Microsoft ACR, Sonatype Nexus, Harbor, Google cloud and other registries.  The scan report for the image comprises of the vulnerability status of various packages and binaries in the image. The brief summary of the scan report can be sent via webhook using the Response rule configuration in Policy &#8594; Response Rules, or by Syslog by configuring a syslog server in Settings &#8594; Configuration. Results can also be viewed in the Event logs.</p>
</div>
<div class="paragraph">
<p>At least one repository filter is required (can&#8217;t be left blank).</p>
</div>
<div class="sect2">
<h3 id="_repository_filter_examples"><a class="anchor" href="#_repository_filter_examples"></a>Repository filter examples</h3>
<div class="paragraph">
<p><span class="image"><img src="_images/1-filter-examples.png" alt="filters"></span></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To scan all image tags, add filter as &#42; or &#42;:&#42;. This works on all registry types except the public docker registry.</p>
</li>
<li>
<p>Repository should be full name if organization is nil for public docker registry or add library before repository as given above.</p>
</li>
<li>
<p>Create a virtual repository and add all local repository to it to scan all tags on a JFrog registry with the subdomain docker access method.</p>
</li>
<li>
<p>Regular expressions can be used in a filter. For example alpine:3.[8|9].* will scan all 3.8.x and 3.9.x images and tags on docker hub.</p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_registry_scan_options"><a class="anchor" href="#_registry_scan_options"></a>Registry scan options</h3>
<div class="ulist">
<ul>
<li>
<p>Scan Layers:</p>
<div class="ulist">
<ul>
<li>
<p>Provides vulnerability scan result for every image layer separately</p>
</li>
<li>
<p>Provides information about commands executed, packages added in the layer</p>
</li>
<li>
<p>Images size of each layer</p>
</li>
</ul>
</div>
</li>
<li>
<p>Auto Scan:</p>
<div class="ulist">
<ul>
<li>
<p>Auto Scan is only supported with OpenShift imagestream integration. Proper role binding should be configured in advance.</p>
</li>
<li>
<p>When Auto Scan is enabled, as soon as an image is pushed to the registry, the image scan will be scheduled.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Periodical Scan:</p>
<div class="ulist">
<ul>
<li>
<p>Enable periodic scan to scan periodically</p>
</li>
<li>
<p>Scan interval can set to be between 5 minutes to every 7 days.</p>
</li>
<li>
<p>Because many Admission Control checks rely on image scan result, enabling periodical scan helps make sure Admission Control has the up-to-date information of the images.</p>
</li>
<li>
<p>Note that SUSE® Security will scan images in a regsistry that are new/changed from the previous scan.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Rescan after CVE DB update</p>
<div class="ulist">
<ul>
<li>
<p>Enable this option to rescan all images after the vulnerability database is updated.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_configuring_proxy_server_for_registry"><a class="anchor" href="#_configuring_proxy_server_for_registry"></a>Configuring Proxy server for Registry</h3>
<div class="paragraph">
<p>Please go to Settings &#8594; Configuration to configure proxy settings for registry scanning.</p>
</div>
</div>
<div class="sect2">
<h3 id="_native_docker_registry_also_quay_and_harbor"><a class="anchor" href="#_native_docker_registry_also_quay_and_harbor"></a>Native Docker registry (also Quay and Harbor)</h3>
<div class="sect3">
<h4 id="_add_native_docker_registry"><a class="anchor" href="#_add_native_docker_registry"></a>Add Native Docker registry</h4>
<div class="ulist">
<ul>
<li>
<p>Choose Docker registry as type</p>
</li>
<li>
<p>Give unique name to the registry</p>
</li>
<li>
<p>Type registry URL with port</p>
</li>
<li>
<p>Provide username and password if required by the registry</p>
</li>
<li>
<p>Add repository as filter in the below format</p>
<div class="ulist">
<ul>
<li>
<p>Organization/repository:tag</p>
</li>
<li>
<p>Repository can have wildcard with starting string</p>
</li>
<li>
<p>Example neuvector/all&#42;:2&#42;</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Adding private docker registry with username/password, scan layers enabled, periodic scan for every 30 minutes enabled and * as filter to scan all tags from all repository.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/2-dockerprivate.png" alt="docker"></span></p>
</div>
<div class="paragraph">
<p>Adding public docker registry for scanning without username/password and 2 repositories with wildcard, scan layers enabled and periodic scan enabled.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/3-dockerpublic.png" alt="docker3"></span></p>
</div>
<div class="paragraph">
<p>Adding public docker registry for scanning with username/password, wildcard repository, scan layers enabled, and periodic scan enabled.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/4-dockerpub-wild.png" alt="docker4"></span></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Quay registry</div>
<div class="ulist">
<ul>
<li>
<p>Enter the top-level URL for your Quay registry; do not enter any directories to the path.</p>
</li>
<li>
<p>You will need to generate an encrypted password in your Quay server/account, and use these credentials here.  Then, pass filter(s) as described above.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="https://user-images.githubusercontent.com/13239496/218163999-9b281bd9-d049-49f6-85cd-395d7c20c481.png" alt="4 1-quay"></span></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_start_scanning_the_docker_registry"><a class="anchor" href="#_start_scanning_the_docker_registry"></a>Start scanning the Docker registry</h4>
<div class="ulist">
<ul>
<li>
<p>Select registry to be scanned</p>
</li>
<li>
<p>Click start button to scan</p>
</li>
<li>
<p>Wait till status changes from scanning to idle</p>
<div class="ulist">
<ul>
<li>
<p>Scanning time varies depending on the size of the repository</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/5-scandocker.png" alt="scandocker"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_view_the_scan_result"><a class="anchor" href="#_view_the_scan_result"></a>View the scan result</h4>
<div class="ulist">
<ul>
<li>
<p>Click on an image from images pane to view the scan result for the image.</p>
</li>
<li>
<p>Access the scan result to find the vulnerability status of the image.</p>
</li>
<li>
<p>Click download button to download scan result of the image if needed</p>
</li>
<li>
<p>Move mouse in between CVE detail and images to get back to summary</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Showing images scanned for the selected registry</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/6-imagescan.png" alt="scanned"></span></p>
</div>
<div class="paragraph">
<p>Example showing layer scan result of an image, which shows vulnerabilities of each layer, layer size and commands run on each layer. In addition, there is a Compliance tab which shows the compliance test results for the image.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/image_scan_4.png" alt="layered"></span></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_amazon_ecr_registry"><a class="anchor" href="#_amazon_ecr_registry"></a>Amazon ECR Registry</h3>
<div class="paragraph">
<p>Ref:  <a href="https://docs.aws.amazon.com/AmazonECR/latest/userguide/Registries.html" class="bare">https://docs.aws.amazon.com/AmazonECR/latest/userguide/Registries.html</a></p>
</div>
<div class="sect3">
<h4 id="_add_amazon_ecr_registry"><a class="anchor" href="#_add_amazon_ecr_registry"></a>Add Amazon ECR registry</h4>
<div class="ulist">
<ul>
<li>
<p>Choose Amazon registry as type</p>
</li>
<li>
<p>Give unique name to the registry</p>
</li>
<li>
<p>Registry URL is automatically found with other information</p>
</li>
<li>
<p>Supply below information for the registry. Refer above amazon link to get below information</p>
<div class="ulist">
<ul>
<li>
<p>Registry id</p>
</li>
<li>
<p>Region</p>
</li>
<li>
<p>Access key id</p>
</li>
<li>
<p>Secret access key</p>
</li>
</ul>
</div>
</li>
<li>
<p>Add repository as filter in the following format</p>
<div class="ulist">
<ul>
<li>
<p>Organization/repository:tag</p>
</li>
<li>
<p>Repository can have wildcard with starting string</p>
</li>
<li>
<p>Example neuvector/all&#42;:2&#42;</p>
</li>
<li>
<p>Organization can be empty if such image available in the registry</p>
</li>
<li>
<p>&#42; to scan all image tags</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/9-aws.png" alt="aws"></span></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_redhat_registry"><a class="anchor" href="#_redhat_registry"></a>Redhat registry</h3>
<div class="paragraph">
<p>Ref:  <a href="https://access.redhat.com/containers" class="bare">https://access.redhat.com/containers</a></p>
</div>
<div class="sect3">
<h4 id="_add_red_hat_registry"><a class="anchor" href="#_add_red_hat_registry"></a>Add Red Hat registry</h4>
<div class="ulist">
<ul>
<li>
<p>Choose Redhat registry as type</p>
</li>
<li>
<p>Give unique name to the registry</p>
</li>
<li>
<p>Type registry URL <a href="https://registry.connect.redhat.com/" class="bare">https://registry.connect.redhat.com/</a></p>
</li>
<li>
<p>Provide username and password of the account used for managing registry</p>
</li>
<li>
<p>Add repository as filter in the below format</p>
<div class="ulist">
<ul>
<li>
<p>Organization/repository:tag</p>
</li>
<li>
<p>Repository can have wildcard with starting string</p>
</li>
<li>
<p>Example neuvector/all&#42;:2&#42;</p>
</li>
<li>
<p>&#42; to scan all image tags</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/10-redhat.png" alt="redhat"></span></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_openshift_registry"><a class="anchor" href="#_openshift_registry"></a>Openshift registry</h3>
<div class="sect3">
<h4 id="_add_openshift_registry_with_username_and_password"><a class="anchor" href="#_add_openshift_registry_with_username_and_password"></a>Add OpenShift registry with username and password</h4>
<div class="ulist">
<ul>
<li>
<p>Choose OpenShift registry as type</p>
</li>
<li>
<p>Give unique name to the registry</p>
</li>
<li>
<p>Type registry URL (obtain from the output of "oc get is" command in OpenShift network if it is different than default)</p>
<div class="ulist">
<ul>
<li>
<p>Default registry URL <code>https://docker-registry.default.svc:5000/</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Provide username and password of the account used for managing registry</p>
</li>
<li>
<p>Add repository as filter in the below format</p>
<div class="ulist">
<ul>
<li>
<p>Organization/repository:tag</p>
</li>
<li>
<p>Example openshift/htt&#42;:&#42;</p>
</li>
<li>
<p>&#42; to scan all image tags</p>
</li>
</ul>
</div>
</li>
<li>
<p>Enable auto scan to start the scan as soon as image is updated on OpenShift image stream.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/1a_openshift.png" alt="openshift"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_add_openshift_registry_with_token"><a class="anchor" href="#_add_openshift_registry_with_token"></a>Add OpenShift registry with token</h4>
<div class="ulist">
<ul>
<li>
<p>Choose OpenShift registry as type</p>
</li>
<li>
<p>Give unique name to the registry</p>
</li>
<li>
<p>Type registry URL (obtain from the output of "oc get is" command in OpenShift network if it is different than default)</p>
<div class="ulist">
<ul>
<li>
<p>Default registry URL <code>https://docker-registry.default.svc:5000/</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Provide token of the service account which has access to all namespaces</p>
<div class="ulist">
<ul>
<li>
<p>Check below note to create service account and get token.</p>
</li>
<li>
<p>Create service account</p>
<div class="ulist">
<ul>
<li>
<p>oc project default</p>
</li>
<li>
<p>oc create sa nvqa</p>
</li>
<li>
<p>oc get sa</p>
</li>
</ul>
</div>
</li>
<li>
<p>Assign cluster admin role to service account to read all registry</p>
<div class="ulist">
<ul>
<li>
<p>oc adm policy add-cluster-role-to-user cluster-admin system:serviceaccount:default:nvqa</p>
</li>
</ul>
</div>
</li>
<li>
<p>Get token for the service account</p>
<div class="ulist">
<ul>
<li>
<p>oc sa get-token nvqa</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Add repository as filter in the below format</p>
<div class="ulist">
<ul>
<li>
<p>Organization/repository:tag</p>
</li>
<li>
<p>Example openshift/htt&#42;:&#42;</p>
</li>
<li>
<p>&#42; to scan all image tags</p>
</li>
</ul>
</div>
</li>
<li>
<p>Enable auto scan to start the scan as soon image is updated on OpenShift image stream.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/1a_openshift_token.png" alt="openshift"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_stability_issues_in_openshift_3_7_registry"><a class="anchor" href="#_stability_issues_in_openshift_3_7_registry"></a>Stability issues in Openshift 3.7 Registry</h4>
<div class="paragraph">
<p>In OpenShift 3.7, API calls to pull container image metadata or to download an image can fail randomly. It can also fail on random images in different scan runs. You may see incomplete image lists or scans may fail on some images when this happens. If this occurs, the repository can be rescanned.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_jfrog_artifactory"><a class="anchor" href="#_jfrog_artifactory"></a>JFrog Artifactory</h3>
<div class="paragraph">
<p>Adding JFrog Artifactory registry (Docker Access method&#8201;&#8212;&#8201;Repository Path)
JFrog management page admin&#8594;HTTP Setting showing docker access method  - Repository Path</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/12-jfrog.png" alt="jfrog"></span></p>
</div>
<div class="sect3">
<h4 id="_add_jfrog_artifactory_registry_docker_access_methodrepository_path"><a class="anchor" href="#_add_jfrog_artifactory_registry_docker_access_methodrepository_path"></a>Add JFrog Artifactory registry (Docker Access method&#8201;&#8212;&#8201;Repository Path)</h4>
<div class="ulist">
<ul>
<li>
<p>Choose JFrog Artifactory as type</p>
</li>
<li>
<p>Give a unique name to the registry</p>
<div class="ulist">
<ul>
<li>
<p>Type the registry URL with port, for example <code>http://10.1.7.122:8081/</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Provide a username and password if required by the registry</p>
</li>
<li>
<p>Add the repository as a filter in the below format</p>
<div class="ulist">
<ul>
<li>
<p>Organization/repository:tag</p>
</li>
<li>
<p>Repository or tag can have wildcards at end, such as abc/&#42;, abc/n&#42;</p>
</li>
<li>
<p>To scan all tags for a repository, for example alpine, use alpine:&#42;</p>
</li>
<li>
<p>The wildcard must be preceded by the full name, path, or starting string</p>
</li>
<li>
<p>&#42; to scan all tags</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_adding_jfrog_artifactory_registry_docker_access_methodsubdomain"><a class="anchor" href="#_adding_jfrog_artifactory_registry_docker_access_methodsubdomain"></a>Adding JFrog Artifactory registry (Docker Access method&#8201;&#8212;&#8201;subdomain)</h4>
<div class="paragraph">
<p>JFrog management page admin&#8594;HTTP Setting showing docker access method&#8201;&#8212;&#8201;Sub Domain</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/14-artifact.png" alt="artifactory"></span></p>
</div>
<div class="paragraph">
<p>Add JFrog Artifactory registry (Docker Access method&#8201;&#8212;&#8201;subdomain)</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Choose JFrog Artifactory as type</p>
</li>
<li>
<p>Give a unique name to the registry</p>
</li>
<li>
<p>Type the registry URL with port, for example <code>http://10.1.7.122:8081/</code></p>
</li>
<li>
<p>Choose Subdomain as JFrog Docker Access Method</p>
</li>
<li>
<p>Provide a username and password if required by the registry</p>
</li>
<li>
<p>Add the repository as a filter in the below format</p>
<div class="ulist">
<ul>
<li>
<p>Subdomain/repository:tag</p>
</li>
<li>
<p>Repository or tag can have wildcards at end, such as abc/&#42;, abc/n&#42;</p>
</li>
<li>
<p>To scan all tags for a repository, for example alpine, use alpine:&#42;</p>
</li>
<li>
<p>The wildcard must be preceded by the full name, path, or starting string</p>
</li>
<li>
<p>&#42; for scanning all tags from all subdomains</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Create a virtual repository and add all local and remote repository to it. Specify this virtual repository in the filter section to scan all tags from local and remote remote repository.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Adding subdomain based JFrog registry to scan images from docker-local subdomain</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/jfrog_sub_local.png" alt="local"></span></p>
</div>
<div class="paragraph">
<p>Adding subdomain based JFrog registry to scan all tags from all subdomains</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/jfrog_all_subs.png" alt="all"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_add_jfrog_artifactory_registry_docker_access_methodport"><a class="anchor" href="#_add_jfrog_artifactory_registry_docker_access_methodport"></a>Add JFrog Artifactory registry (Docker Access method&#8201;&#8212;&#8201;port)</h4>
<div class="paragraph">
<p>JFrog management page admin&#8594;HTTP Setting showing docker access method - Port</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/jfrogport1.png" alt="jfrogport"></span></p>
</div>
<div class="paragraph">
<p>JFrog management page admin&#8594;Local Repository&#8594;docker-local repository&#8594; Advanced - showing repository URL and registry port 8181</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/jfrogport2.png" alt="jfrogport"></span></p>
</div>
<div class="paragraph">
<p>JFrog management page admin&#8594;Local Repository&#8594;guo repository&#8594; Advanced - showing repository URL and registry port 8182</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/jfrogport3.png" alt="jfrogport"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Choose JFrog Artifactory as type</p>
</li>
<li>
<p>Give a unique name to the registry</p>
</li>
<li>
<p>Type the registry URL with port, for example <code>http://10.1.7.122:8181/</code></p>
<div class="ulist">
<ul>
<li>
<p>Every Registry name has unique port</p>
</li>
</ul>
</div>
</li>
<li>
<p>Choose Port as JFrog Docker Access Method</p>
</li>
<li>
<p>Provide a username and password if required by the registry</p>
</li>
<li>
<p>Add the repository as a filter in the below format</p>
<div class="ulist">
<ul>
<li>
<p>Organization/repository:tag</p>
</li>
<li>
<p>Repository or tag can have wildcards at end, such as abc/<em>, abc/n</em></p>
</li>
<li>
<p>To scan all tags for a repository, for example alpine, use alpine:*</p>
</li>
<li>
<p>The wildcard must be preceded by the full name, path, or starting string</p>
</li>
<li>
<p>&#42; for scanning all tags</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Adding JFrog registry for port access method for registry docker-local with port 8181</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/jfrog104.png" alt="jfrogport"></span></p>
</div>
<div class="paragraph">
<p>Adding JFrog registry for port access method for registry with port 8182</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/jfrog105.png" alt="jfrogport"></span></p>
</div>
<div class="paragraph">
<p>Adding JFrog registry for port access method for the virtual registry with port 8188, which has all local registries added to it.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/jfrog106.png" alt="jfrogport"></span></p>
</div>
<div class="paragraph">
<p>Showing scanned result for docker-local registry</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/jfrogport6.png" alt="jfrogport"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_add_saas_jfrog_artifactory_registry_docker_access_methodport"><a class="anchor" href="#_add_saas_jfrog_artifactory_registry_docker_access_methodport"></a>Add SaaS JFrog Artifactory registry (Docker access method&#8201;&#8212;&#8201;Port)</h4>
<div class="paragraph">
<p>Choose JFrog Artifactory as type</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Give a unique name to the registry</p>
</li>
<li>
<p>Type the registry URL, for example <a href="https://jfrogtraining-docker-nv-virtual.jfrog.io" class="bare">https://jfrogtraining-docker-nv-virtual.jfrog.io</a></p>
</li>
<li>
<p>Choose Port as JFrog Docker Access Method</p>
</li>
<li>
<p>Provide a username and password if required by the registry</p>
</li>
<li>
<p>Add the repository as a filter in the below format</p>
<div class="ulist">
<ul>
<li>
<p>Organization/repository:tag</p>
</li>
<li>
<p>&#42; to scan all tags of all repository</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/jfrog_saas.png" alt="jfrogsaas"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_start_scanning_a_jfrog_artifactory_registry"><a class="anchor" href="#_start_scanning_a_jfrog_artifactory_registry"></a>Start Scanning a JFrog Artifactory Registry</h4>
<div class="ulist">
<ul>
<li>
<p>Select registry to be scanned</p>
</li>
<li>
<p>Click start button to scan</p>
</li>
<li>
<p>Wait until status changes from scanning to idle</p>
<div class="ulist">
<ul>
<li>
<p>Scanning time varies depending on the size of the repository</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_google_container_registry"><a class="anchor" href="#_google_container_registry"></a>Google Container Registry</h3>
<div class="paragraph">
<p>Ref:
<a href="https://cloud.google.com/container-registry/docs/advanced-authentication" class="bare">https://cloud.google.com/container-registry/docs/advanced-authentication</a>
<a href="https://cloud.google.com/container-registry/docs/advanced-authentication#json_key_file" class="bare">https://cloud.google.com/container-registry/docs/advanced-authentication#json_key_file</a></p>
</div>
<div class="sect3">
<h4 id="_enable_cloud_resource_manager_api_for_the_project"><a class="anchor" href="#_enable_cloud_resource_manager_api_for_the_project"></a>Enable Cloud Resource Manager API for the project</h4>
<div class="paragraph">
<p>Google Cloud Platform&#8594;Choose Project&#8594;API and Services&#8594;Enable APIS and Services&#8594;Search &#8220;Cloud Resource Manager API&#8221;&#8594;Enable API
<a href="https://console.cloud.google.com/apis/library?project=nvtest-219600&amp;q=Cloud%20Resource%20Manager%20API" class="bare">https://console.cloud.google.com/apis/library?project=nvtest-219600&amp;q=Cloud%20Resource%20Manager%20API</a>   (change project name)</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/17-gcp.png" alt="gcp"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_create_key_for_container_service_account"><a class="anchor" href="#_create_key_for_container_service_account"></a>Create key for container service account</h4>
<div class="paragraph">
<p>Google Cloud Platform&#8594;IAM&#8594;Service Account&#8594;account with container registry&#8594;CreateKey(action)</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/18-gcpiam.png" alt="gcpiam"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_copy_json_file_to_client_machine"><a class="anchor" href="#_copy_json_file_to_client_machine"></a>Copy json file to client machine</h4>

</div>
<div class="sect3">
<h4 id="_add_google_container_registry_from_the_suse_security_gui"><a class="anchor" href="#_add_google_container_registry_from_the_suse_security_gui"></a>Add Google Container Registry from the SUSE® Security GUI</h4>
<div class="ulist">
<ul>
<li>
<p>Choose Google registry as type</p>
</li>
<li>
<p>Give unique name to the registry</p>
</li>
<li>
<p>Type registry URL. Sample <a href="https://gcr.io/" class="bare">https://gcr.io/</a> (this could also be us.gcr.io, eu.gcr.io etc)</p>
</li>
<li>
<p>Paste all content above captured json file into JSON key.</p>
</li>
<li>
<p>Add repository as filter in the below format</p>
<div class="ulist">
<ul>
<li>
<p>Project-id/repository:tag</p>
</li>
<li>
<p>Example nvtestid-1/neuvector&#42;:&#42;</p>
</li>
<li>
<p>&#42; to scan all image tags</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/19-gcpscan.png" alt="gcpscan"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_start_scanning_a_google_container_registry"><a class="anchor" href="#_start_scanning_a_google_container_registry"></a>Start Scanning a Google Container Registry</h4>
<div class="ulist">
<ul>
<li>
<p>Select registry to be scanned</p>
</li>
<li>
<p>Click start button to scan</p>
</li>
<li>
<p>Wait until status changes from scanning to idle</p>
<div class="ulist">
<ul>
<li>
<p>Scanning time varies depending on the size of the repository</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_azure_container_registry"><a class="anchor" href="#_azure_container_registry"></a>Azure Container Registry</h3>
<div class="paragraph">
<p>Ref:
<a href="https://azure.microsoft.com/en-us/services/container-registry/" class="bare">https://azure.microsoft.com/en-us/services/container-registry/</a></p>
</div>
<div class="sect3">
<h4 id="_obtain_azure_container_username_and_password_as_shown_below"><a class="anchor" href="#_obtain_azure_container_username_and_password_as_shown_below"></a>Obtain Azure container username and password as shown below</h4>
<div class="paragraph">
<p>Azure container registry &#8594; user&#8594; access keys&#8594;password</p>
</div>
<div class="paragraph">
<p>Showing azure portal username and password for container registry access</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/20-azure.png" alt="azure"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_add_azure_container_registry_from_the_suse_security_gui"><a class="anchor" href="#_add_azure_container_registry_from_the_suse_security_gui"></a>Add Azure Container Registry from the SUSE® Security GUI</h4>
<div class="ulist">
<ul>
<li>
<p>Choose Azure registry as type</p>
</li>
<li>
<p>Give unique name to the registry</p>
</li>
<li>
<p>Type registry URL. Sample <code>https://neuvector.azure.io</code> (obtain from azure portal)</p>
<div class="ulist">
<ul>
<li>
<p>Container registry&#8594;user&#8594;Overview&#8594;Login Server</p>
</li>
</ul>
</div>
</li>
<li>
<p>Add username and password</p>
<div class="ulist">
<ul>
<li>
<p>Azure container registry &#8594; user&#8594; access keys&#8594;password</p>
</li>
</ul>
</div>
</li>
<li>
<p>Add repository as filter in the below format</p>
<div class="ulist">
<ul>
<li>
<p>repository:tag</p>
</li>
<li>
<p>example alpine:&#42;</p>
</li>
<li>
<p>&#42; to scan all image tags</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Showing azure portal login server for Azure container registry</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/21-azurereg.png" alt="azure"></span></p>
</div>
<div class="paragraph">
<p>Adding Azure container registry to scan all tags</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/22-azureadd.png" alt="azureadd"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_start_scanning_a_azure_container_registry"><a class="anchor" href="#_start_scanning_a_azure_container_registry"></a>Start Scanning a Azure Container Registry</h4>
<div class="ulist">
<ul>
<li>
<p>Select registry to be scanned</p>
</li>
<li>
<p>Click start button to scan</p>
</li>
<li>
<p>Wait until status changes from scanning to idle</p>
<div class="ulist">
<ul>
<li>
<p>Scanning time varies depending on the size of the repository</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_sonatype_nexus_docker_registry"><a class="anchor" href="#_sonatype_nexus_docker_registry"></a>Sonatype Nexus Docker registry</h3>
<div class="paragraph">
<p>Ref:
<a href="https://help.sonatype.com/repomanager3/private-registry-for-docker" class="bare">https://help.sonatype.com/repomanager3/private-registry-for-docker</a>
<a href="https://hub.docker.com/r/sonatype/nexus3/" class="bare">https://hub.docker.com/r/sonatype/nexus3/</a></p>
</div>
<div class="sect3">
<h4 id="_add_sonatype_nexus_docker_registry"><a class="anchor" href="#_add_sonatype_nexus_docker_registry"></a>Add Sonatype Nexus Docker registry</h4>
<div class="ulist">
<ul>
<li>
<p>Choose Sonatype Nexus as type</p>
</li>
<li>
<p>Give unique name to the registry</p>
</li>
<li>
<p>Type registry URL with port</p>
</li>
<li>
<p>Provide username and password if required by the registry</p>
</li>
<li>
<p>Add repository as filter in the below format</p>
<div class="ulist">
<ul>
<li>
<p>Organization/repository:tag</p>
</li>
<li>
<p>Repository can have wildcard with starting string</p>
</li>
<li>
<p>Example neuvector/all&#42;:2&#42;</p>
</li>
<li>
<p>&#42; to scan all image tags</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Adding Sonatype Nexus docker registry with username/password and repository &#42;:&#42;  for scanning</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/23-sonatype.png" alt="sonatype"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_start_scanning_sonatype_nexus_docker_registry"><a class="anchor" href="#_start_scanning_sonatype_nexus_docker_registry"></a>Start scanning Sonatype Nexus Docker registry</h4>
<div class="ulist">
<ul>
<li>
<p>Select registry to be scanned</p>
</li>
<li>
<p>Click start button to scan</p>
</li>
<li>
<p>Wait till status changes from scanning to idle</p>
<div class="ulist">
<ul>
<li>
<p>Scanning time varies depending on the size of the repository</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_gitlab_container_registry"><a class="anchor" href="#_gitlab_container_registry"></a>Gitlab Container Registry</h3>
<div class="sect3">
<h4 id="_sample_gitlab_environmnent_configurations"><a class="anchor" href="#_sample_gitlab_environmnent_configurations"></a>Sample GitLab Environmnent Configurations</h4>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">sudo docker run --detach \
  --hostname gitlab \
  --env GITLAB_OMNIBUS_CONFIG="external_url 'http://10.1.7.73:9096'; gitlab_rails['lfs_enabled'] = true;" \
  --publish 10.1.7.73:9095:9095 --publish 10.1.7.73:9096:9096 --publish 10.1.7.73:6222:22 \
  --name gitlab \
  --restart always \
  --volume /srv/gitlab/config:/etc/gitlab \
  --volume /srv/gitlab/logs:/var/log/gitlab \
  --volume /srv/gitlab/data:/var/opt/gitlab \
gitlab/gitlab-ce:latest
External_URL:  http://10.1.7.73:9096
Registry_URL: https://10.1.7.73:9095</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_obtain_gitlab_private_token_as_shown_below"><a class="anchor" href="#_obtain_gitlab_private_token_as_shown_below"></a>Obtain Gitlab private token as shown below</h4>
<div class="ulist">
<ul>
<li>
<p>Navigate to the settings page from the icon located at the upper-righthand corner of the GitLab login page as illustrated below:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/gitlabsettings.png" alt="gitlab"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Navigate to the Access_Tokens page as shown below from the User_Settings page:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/gitlabusersettings.png" alt="gitlab"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Fill in all applicable fields, and click &#8220;Create personal access token&#8221; when ready to generate the access token:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/gitlabpersonaltoken_new.png" alt="gitlab"></span></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Access token will no longer be available once the user has navigated away from the generated token page.  Therefore, it is highly recommended to make a copy of the access token prior to navigating or closing the following page:</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/gitlabaccesstoken.png" alt="gitlab"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_obtaining_external_and_registry_urls"><a class="anchor" href="#_obtaining_external_and_registry_urls"></a>Obtaining External and Registry URLs</h4>
<div class="paragraph">
<p>External-URL:   The external url is the API-Server&#8217;s URL.<br>
Registry-URL:  This can be obtained from the Container Registry page of the GitLab webconsole.  One way to get to this page is navigating from the GitLab&#8217;s webconsole from Projects &gt; Your Projects &gt; Administrator / &#8230;&#8203; &gt; Left-Pane (Container Registry) &gt; Mouse-over (root/&#8230;&#8203;/)</p>
</div>
<div class="paragraph">
<p>The following is a sample screen-capture of the page that reveals both the External-URL and the Registry-URL:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/gitlabexternalurl.png" alt="gitlab"></span></p>
</div>
</div>
<div class="sect3">
<h4 id="_add_gitlab_registry_from_the_suse_security_console"><a class="anchor" href="#_add_gitlab_registry_from_the_suse_security_console"></a>Add Gitlab Registry from the SUSE® Security Console</h4>
<div class="ulist">
<ul>
<li>
<p>Choose Gitlab as the registry type</p>
</li>
<li>
<p>Give unique name to the registry</p>
</li>
<li>
<p>Type registry URL with port</p>
</li>
<li>
<p>Provide username and password if required by the registry</p>
</li>
<li>
<p>Provide Gitlab external URL and the private token obtained from the last section</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/gitlabregistryscan.png" alt="gitlab"></span></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The Registry URL is used for pulling images into the SUSE® Security scanner-platform from GitLab to do registry scanning.  While the External URL is used for retrieving a list of images, registries, and metadata used by the registry scanning feature.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ibm_cloud_container_registry"><a class="anchor" href="#_ibm_cloud_container_registry"></a>IBM Cloud Container Registry</h3>
<div class="paragraph">
<p>Ref:  <a href="https://www.ibm.com/cloud/container-registry" class="bare">https://www.ibm.com/cloud/container-registry</a></p>
</div>
<div class="sect3">
<h4 id="_add_ibm_container_registry"><a class="anchor" href="#_add_ibm_container_registry"></a>Add IBM Container registry</h4>
<div class="ulist">
<ul>
<li>
<p>Choose IBM Cloud Container Registry as type</p>
</li>
<li>
<p>Give unique name to the registry</p>
</li>
<li>
<p>Type registry URL <a href="https://us.icr.io/" class="bare">https://us.icr.io/</a></p>
</li>
<li>
<p>Provide iamapikey as username and the apikey below as password</p>
<div class="ulist">
<ul>
<li>
<p>Create apikey from CLI</p>
<div class="ulist">
<ul>
<li>
<p>ibmcloud iam api-key-create atibmKey</p>
</li>
</ul>
</div>
</li>
<li>
<p>Create apikey from GUI</p>
<div class="ulist">
<ul>
<li>
<p>IBM Cloud&#8594;Manage-Access(IAM)-IBM Cloud API Keys</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Provide IBM Cloud Account</p>
<div class="ulist">
<ul>
<li>
<p>Obtain IBM cloud account from CLI</p>
<div class="ulist">
<ul>
<li>
<p>Ibmcloud cr info</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Add repository as filter in the below format</p>
<div class="ulist">
<ul>
<li>
<p>Organization/repository:tag</p>
</li>
<li>
<p>Repository can have wildcard with starting string</p>
</li>
<li>
<p>Example neuvector/all<em>:2</em></p>
</li>
<li>
<p></p>
<div class="ulist">
<ul>
<li>
<p>to scan all image tags</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Enable other parameters if needed</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/ibm-1.png" alt="ibm"></span></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The username for the registry authentication must be 'iamapikey'</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_harbor_registry"><a class="anchor" href="#_harbor_registry"></a>Harbor Registry</h3>
<div class="paragraph">
<p>Use the same instructions as the Native Docker registry, choosing <strong>Harbor Registry</strong> as the registry.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="https://github.com/user-attachments/assets/9d382fde-7be4-423d-8401-c1034a9e4c2f" alt="Harbor">
</div>
</div>
<div class="paragraph">
<p>The filter field can not be left blank. Enter a repository filter, or add filter as * to scan all repositories.</p>
</div>
</div>
<div class="sect2">
<h3 id="_github_container_registry"><a class="anchor" href="#_github_container_registry"></a>GitHub Container Registry</h3>
<div class="paragraph">
<p>Available in NeuVector v5.4.3 and later, image scanning is now supported from the <a href="https://ghcr.io">GitHub Container Registry (GHCR)</a>, enabling users to include images stored in GitHub in their security and compliance workflows.</p>
</div>
<div class="sect3">
<h4 id="_add_the_github_container_registry"><a class="anchor" href="#_add_the_github_container_registry"></a>Add the GitHub Container Registry</h4>
<div class="paragraph">
<p>To configure the GHCR in NeuVector, go to <strong>Add Registry</strong> and select <strong>GitHub Container Registry</strong> from the registry type dropdown.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A name to identify this registry configuration.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Registry</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The GHCR registry URL. Example: <code><a href="https://ghcr.io/" class="bare">https://ghcr.io/</a></code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>User Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Your GitHub username.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Token</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A <a href="https://github.com/settings/tokens">GitHub Personal Access Token</a> with <code>read:packages</code> permission (and <code>repo</code> if accessing private images).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Filter</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specify the namespace to scan (e.g., <code>github_user/hello-world:*</code> or <code>repo/package_name:version</code>).</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_token_permissions"><a class="anchor" href="#_token_permissions"></a>Token Permissions</h4>
<div class="paragraph">
<p>To access GHCR, you must generate a GitHub token with the following scopes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>read:packages</code> (required)</p>
</li>
<li>
<p><code>repo</code> (if accessing private repositories)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can create a token <a href="https://github.com/settings/tokens">here</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_troubleshooting"><a class="anchor" href="#_troubleshooting"></a>Troubleshooting</h4>
<div class="paragraph">
<p>If you encounter issues such as <code>403 Forbidden</code> or <code>invalid credentials</code>, please ensure:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Your token has the correct scopes.</p>
</li>
<li>
<p>The registry URL is correctly formatted (e.g., <code>https://ghcr.io/</code>).</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="compliance.html">Compliance &amp; CIS Benchmarks</a></span>
  <span class="next"><a href="harbor.html">Harbor Pluggable Scanner Module</a></span>
</nav>
</article>
  </div>
</main>
</div>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/vendor/lunr-languages.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
<script src="../../../_/js/vendor/langSelection.js"></script>
<script async src="../../../_/js/vendor/tabs.js"></script>


<script src="../../../_/js/CNLanguageSwitcher.js"></script>
  </body>
</html>
