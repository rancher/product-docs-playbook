<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Configure a Backup Target :: Rancher product documentation</title>
    <link rel="canonical" href="https://documentation.suse.com/cloudnative/storage/latest/en/snapshots-backups/volume-snapshots-backups/configure-backup-target.html">
    <link rel="prev" href="snapshot-space-management.html">
    <link rel="next" href="create-backup.html">
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../../../../../_/css/site.css">
<meta http-equiv="last-modified" content="2025-07-14"/>
<link rel="stylesheet" href="../../../../../_/css/search.css">
<link rel="icon" href="../../../../../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="../../../../../_/css/font-styles.css">
<link rel="stylesheet" href="../../../../../_/fonts/css/all.css">
<link rel="stylesheet" href="../../../../../_/css/site-extra.css">
<link rel="stylesheet" href="../../../../../_/css/vendor/tabs.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=SUSE:wght@100..800&display=swap&family=SUSE+Mono:ital,wght@0,100..800;1,100..800" rel="stylesheet">
<link href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css" rel="stylesheet">
<!-- <link href="https://fonts.googleapis.com/css?family=Montserrat|Roboto&display=swap" rel="stylesheet"> -->
<link rel="stylesheet" href="../../../../../_/css/vendor/light.css">
<script src="/docserv/res/lightheaded/analytics.js" type="text/javascript"></script>

<script type="module">
  import { defineCustomElements, setAssetPath } from 'https://d12w0ryu9hjsx8.cloudfront.net/shared-header/1.5/shared-header.esm.js';
  defineCustomElements();
  setAssetPath("https://d12w0ryu9hjsx8.cloudfront.net/shared-header/1.5/assets");
</script>    <script>var uiRootPath = '../../../../../_'</script>
  </head>
  <body class="article">
<script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs'; mermaid.initialize({"startOnLoad":true});</script><!-- Canonical link -->
<link href="https://documentation.suse.com/cloudnative/storage/latest/en/snapshots-backups/volume-snapshots-backups/configure-backup-target.html" rel="canonical"/>

<!-- Default English link -->
<link href="https://documentation.suse.com/cloudnative/storage/1.10/en/snapshots-backups/volume-snapshots-backups/configure-backup-target.html" hreflang="x-default" rel="alternate"/>

<!-- Link for the currently processed page -->
<link href="https://documentation.suse.com/cloudnative/storage/1.10/en/snapshots-backups/volume-snapshots-backups/configure-backup-target.html" hrefLang="en-US" rel="alternate" />











<shared-header language="en" languages='{
"en": { "label": "English", "url": "https://documentation.suse.com/en-us/" },
"de": { "label": "Deutsch", "url": "https://documentation.suse.com/de-de/" },
"fr": { "label": "Français", "url": "https://documentation.suse.com/fr-fr/" },
"es": { "label": "Español", "url": "https://documentation.suse.com/es-es/" },
"zh_CN": { "label": "中文", "url": "https://documentation.suse.com/zh-cn/" },
"pt_BR": { "label": "Português Brasileiro", "url": "https://documentation.suse.com/pt-br/" }
}'>
</shared-header>

<!-- Leaving as a comment, I expect it will be required again next year.
<a target=_blank"" class="survey-link" href="https://suselinux.fra1.qualtrics.com/jfe/form/SV_bEiGZbUNzLD8Tcy"> Documentation survey </a>
--><div class="body">
<div class="nav-container" data-component="storage" data-version="1.10">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title">SUSE® Storage</h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../longhorn-documentation.html">SUSE® Storage Overview</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../../introduction/introduction.html">Introduction</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../introduction/concepts.html">Architecture and Concepts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../introduction/terminology.html">Terminology</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../introduction/document-conventions.html">Document Conventions</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../important-notes.html">Important Notes</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Installation and Setup</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../installation-setup/requirements.html">Requirements</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../installation-setup/best-practices.html">Best Practices</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../../installation-setup/installation/installation.html">Installation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../installation-setup/installation/install-using-argocd.html">Install SUSE Storage Using ArgoCD</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../installation-setup/installation/install-using-fleet.html">Install SUSE Storage Using Fleet</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../installation-setup/installation/install-using-flux.html">Install SUSE® Storage Using Flux</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../installation-setup/installation/install-using-helm.html">Install SUSE Storage Using Helm</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../installation-setup/installation/install-using-helm-controller.html">Install SUSE Storage Using Helm Controller</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../installation-setup/installation/helm-values.html">Helm Values</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../installation-setup/installation/install-using-kubectl.html">Install SUSE Storage Using Kubectl</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../installation-setup/installation/install-using-rancher.html">Install SUSE Storage Using Rancher</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../installation-setup/installation/rancher-windows-cluster.html">Rancher Windows Cluster</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../installation-setup/installation/airgapped-environment.html">Install SUSE Storage in an Air-Gapped Environment</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Operating System and Distribution Configuration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../installation-setup/os-distro/container-optimized-os.html">Container-Optimized OS (COS)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../installation-setup/os-distro/gke.html">Google Kubernetes Engine (GKE)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../installation-setup/os-distro/k3s.html">K3s</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../installation-setup/os-distro/ocp-okd.html">Red Hat OpenShift Container Platform and OKD</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../installation-setup/os-distro/rke-coreos.html">RKE and CoreOS</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../installation-setup/os-distro/talos-linux.html">Talos Linux</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../installation-setup/setup-performance-scalability-sizing-guidelines.html">Setup, Performance, Scalability, and Sizing Guidelines</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../installation-setup/uninstallation.html">Uninstallation</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../../upgrades/upgrades.html">Upgrades</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Component Upgrades</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../upgrades/longhorn-components/auto-upgrade-engine.html">Automatically Upgrade the Longhorn Engine</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../upgrades/longhorn-components/manually-upgrade-engine.html">Manually Upgrade the Longhorn Engine</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../upgrades/longhorn-components/upgrade-longhorn-manager.html">Upgrade Longhorn Manager</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Kubernetes Upgrades</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../upgrades/kubernetes/upgrade-k8s-on-aks.html">Upgrade Kubernetes on Azure Kubernetes Service (AKS)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../upgrades/kubernetes/upgrade-k8s-on-eks.html">Upgrade Kubernetes on Amazon Elastic Kubernetes Service (Amazon EKS)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../upgrades/kubernetes/upgrade-k8s-on-gke.html">Upgrade Kubernetes on Google Kubernetes Engine (GKE)</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">SUSE® Storage System</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../../longhorn-system/system-access/system-access.html">System Access</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../longhorn-system/system-access/longhorn-ui.html">Access the User Interface</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../longhorn-system/system-access/create-ingress.html">Create an Ingress with Basic Authentication (nginx)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../longhorn-system/system-access/longhorn-cli.html">Command Line Interface (CLI)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../longhorn-system/system-access/install-longhorn-cli.html">Install the CLI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../longhorn-system/system-access/longhorn-python-client.html">Python Client</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../../longhorn-system/networking/networking.html">Networking</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../longhorn-system/networking/storage-network.html">Storage Network</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../longhorn-system/mtls-support.html">Mutual TLS (mTLS) Support</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../longhorn-system/customize-default-settings.html">Customize Default Settings</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../longhorn-system/settings.html">Settings</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">V2 Data Engine (Preview Feature)</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../../longhorn-system/v2-data-engine/features/features.html">V2 Data Engine Features</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../longhorn-system/v2-data-engine/features/selective-engine-activation.html">Selective V2 Data Engine Activation</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../longhorn-system/v2-data-engine/features/ublk-frontend-support.html">UBLK Frontend Support</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../longhorn-system/v2-data-engine/features/node-disk-support.html">Node Disk Support</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../longhorn-system/v2-data-engine/features/replica-rebuild-qos.html">Replica Rebuild QoS</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../longhorn-system/v2-data-engine/features/interrupt-mode.html">Interrupt Mode</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../longhorn-system/v2-data-engine/features/volume-expansion.html">Volume Expansion</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../../longhorn-system/v2-data-engine/features/volume-clone.html">Volume Clone</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../longhorn-system/v2-data-engine/prerequisites.html">Prerequisites</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../longhorn-system/v2-data-engine/quick-start-guide.html">Quick Start Guide</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../longhorn-system/v2-data-engine/performance.html">Performance</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../longhorn-system/examples-resources.html">Examples of Kubernetes Resources that Use SUSE® Storage</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../longhorn-system/migrate-flexvolume.html">Migrate from the Flexvolume Driver to CSI</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Nodes</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../nodes/node-space-usage.html">Node Space Usage</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../nodes/default-disk-and-node-config.html">Configure Default Node and Disk Settings</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../nodes/storage-tags.html">Storage Tags</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../nodes/multiple-disks.html">Multiple Disks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../nodes/disks-or-nodes-eviction.html">Evicting Replicas on Disabled Disks or Nodes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../nodes/scheduling.html">Scheduling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../nodes/node-conditions.html">Node Conditions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../nodes/node-selector.html">Node Selector</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../nodes/taints-tolerations.html">Taints and Tolerations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../nodes/priority-class.html">Priority Class</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Managed Kubernetes</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../nodes/managed-kubernetes/aks-managed-node-groups.html">Managed Node Groups on Azure Kubernetes Service (AKS)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../nodes/managed-kubernetes/eks-managed-node-pools.html">Managed Node Pools on Amazon Elastic Kubernetes Service (Amazon EKS)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../nodes/managed-kubernetes/gke-managed-node-pools.html">Managed Node Pools on Google Kubernetes Engine (GKE)</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Volumes</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../volumes/create-volumes.html">Create Volumes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../volumes/pvc-ownership-and-permission.html">PVC Ownership and Permission</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../volumes/rwx-volumes.html">ReadWriteMany (RWX) Volumes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../volumes/clone-volumes.html">Clone Volumes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../volumes/detach-volumes.html">Detach Volumes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../volumes/delete-volumes.html">Delete Volumes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../volumes/use-as-iscsi-target.html">Use a Volume as an iSCSI Target</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../volumes/identify-workloads.html">Identify Workloads that Use a Volume</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../volumes/volume-size.html">Volume Size</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../volumes/volume-expansion.html">Volume Expansion</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../volumes/volume-attachment.html">SUSE Storage VolumeAttachment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../volumes/trim-filesystem.html">Trim the Filesystem</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../volumes/volume-conditions.html">Volume Conditions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../volumes/volume-encryption.html">Volume Encryption</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../volumes/storageclass-parameters.html">StorageClass Parameters</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../../volumes/backing-images/backing-images.html">Backing Images</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../volumes/backing-images/backing-image-encryption.html">Backing Image Encryption</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">High Availability</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../high-availability/automatic-replica-balancing.html">Automatic Replica Balancing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../high-availability/replica-rebuilding.html">Replica Rebuilding</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../high-availability/fast-replica-rebuilding.html">Fast Replica Rebuilding</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../high-availability/offline-replica-rebuilding.html">Offline Replica Rebuilding</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../high-availability/revision_counter.html">Revision Counter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../high-availability/data-locality.html">Data Locality</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../high-availability/kubernetes-cluster-autoscaler.html">Kubernetes Cluster Autoscaler Support (Experimental)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../high-availability/rwx-volume-fast-failover.html">RWX Volume Fast Failover (Experimental)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../high-availability/volume-recovery.html">Volume Recovery</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../high-availability/node-failure.html">Node Failure Management</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Snapshots and Backups</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="volume-snapshots-backups.html">Volume Snapshots and Backups</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="create-snapshot.html">Create a Snapshot</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="snapshot-space-management.html">Snapshot Space Management</a>
  </li>
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="configure-backup-target.html">Configure a Backup Target</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="create-backup.html">Create a Backup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="sync-backup-volumes-manually.html">Manually Synchronize Backup Volumes</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="create-recurring-backup-snapshot-job.html">Create a Recurring Snapshot or Backup Job</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="restore-volume-from-backup.html">Restore a Volume from a Backup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="restore-recurring-job-from-backup.html">Restore a Recurring Job from a Backup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="restore-volume-statefulset.html">Restore a Volume for a Kubernetes StatefulSet</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../csi-snapshots/csi-snapshots.html">CSI Snapshots</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../csi-snapshots/csi-snapshot-longhorn-backing-image.html">CSI Volume Snapshot Associated with a SUSE® Storage Backing Image</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../csi-snapshots/csi-snapshot-longhorn-backup.html">CSI Volume Snapshot Associated with a SUSE® Storage Backup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../csi-snapshots/csi-snapshot-longhorn-snapshot.html">CSI Volume Snapshot Associated with a SUSE® Storage Snapshot</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../csi-snapshots/enable-csi-snapshot-creation.html">Enable CSI Snapshot Creation on a Cluster</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../system-backups/system-backups.html">SUSE® Storage System Backups</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../system-backups/restore-to-cluster-using-rancher-snapshot.html">Restore the SUSE® Storage System to a Cluster Using a Rancher Snapshot</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../system-backups/restore-to-new-cluster-using-velero.html">Restore the SUSE® Storage System to a New Cluster Using Velero</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../system-backups/create-system-backup.html">Create a SUSE Storage System Backup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../system-backups/restore-system.html">Restore the SUSE® Storage System</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../backing-image-backups.html">Backing Image Backup</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../restore-cluster-rancher-snapshot.html">Restore a Cluster Using a Rancher Snapshot</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Data Integrity and Recovery</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../data-integrity-recovery/snapshot-data-integrity-check.html">Snapshot Data Integrity Check</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../data-integrity-recovery/orphaned-data-cleanup.html">Orphaned Data Cleanup</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../data-integrity-recovery/orphaned-instance-cleanup.html">Orphaned Instance Cleanup</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../data-integrity-recovery/disaster-recovery-volumes.html">Disaster Recovery Volumes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Data Recovery</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../data-integrity-recovery/data-recovery/identify-corrupted-replicas.html">Identify Corrupted Replicas</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../data-integrity-recovery/data-recovery/retrieve-volume-data-from-replica.html">Retrieve Volume Data from a Single Replica</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../data-integrity-recovery/data-recovery/recover-from-data-errors.html">Identify and Recover from Data Errors</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../data-integrity-recovery/data-recovery/recover-from-full-disk.html">Recover from a Full Disk</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../data-integrity-recovery/data-recovery/recover-without-system.html">Recover from a SUSE® Storage Backup without the System Installed</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Observability</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../observability/configure-prometheus-grafana.html">Configure Prometheus and Grafana to Monitor SUSE® Storage</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../observability/alert-rule-examples.html">Alert Rule Examples</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../observability/longhorn-metrics.html">SUSE® Storage Metrics for Monitoring</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../observability/integrate-with-rancher-monitoring.html">Integrate SUSE® Storage Metrics into the Rancher Monitoring System</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../observability/kubelet-volume-metrics.html">Kubelet Volume Metrics</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Troubleshooting and Maintenance</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../troubleshooting-maintenance/support-bundle.html">Support Bundle</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../troubleshooting-maintenance/troubleshooting.html">Troubleshooting Problems</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../troubleshooting-maintenance/v2-data-engine-issues.html">Troubleshooting</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../troubleshooting-maintenance/maintenance.html">Node Maintenance and Kubernetes Upgrade Guide</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">SUSE® Storage</span>
    <span class="version">1.10 (Dev)</span>
  </div>
  <ul class="components">
        <li class="component">
          <div class="title"><a href="../../../../../admission-controller/1.29/en/introduction.html">Admission Controller</a></div>
          <ul class="versions">
            <li class="version">
              <a href="../../../../../admission-controller/1.30/en/introduction.html">1.30-next</a>
            </li>
            <li class="version is-latest">
              <a href="../../../../../admission-controller/1.29/en/introduction.html">1.29</a>
            </li>
            <li class="version">
              <a href="../../../../../admission-controller/1.28/en/introduction.html">1.28</a>
            </li>
            <li class="version">
              <a href="../../../../../admission-controller/1.27/en/introduction.html">1.27</a>
            </li>
            <li class="version">
              <a href="../../../../../admission-controller/1.26/en/introduction.html">1.26</a>
            </li>
            <li class="version">
              <a href="../../../../../admission-controller/1.25/en/introduction.html">1.25</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../../cluster-api/latest/en/index.html">Cluster API</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../../cluster-api/latest/en/index.html">Latest</a>
            </li>
            <li class="version">
              <a href="../../../../../cluster-api/v0.24/en/index.html">0.24</a>
            </li>
            <li class="version">
              <a href="../../../../../cluster-api/v0.23/en/index.html">0.23</a>
            </li>
            <li class="version">
              <a href="../../../../../cluster-api/v0.22/en/index.html">0.22</a>
            </li>
            <li class="version">
              <a href="../../../../../cluster-api/v0.21/en/index.html">0.21</a>
            </li>
            <li class="version">
              <a href="../../../../../cluster-api/v0.20/en/index.html">0.20</a>
            </li>
            <li class="version">
              <a href="../../../../../cluster-api/v0.19/en/index.html">0.19</a>
            </li>
            <li class="version">
              <a href="../../../../../cluster-api/v0.18/en/index.html">0.18</a>
            </li>
            <li class="version">
              <a href="../../../../../cluster-api/v0.17/en/index.html">0.17</a>
            </li>
            <li class="version">
              <a href="../../../../../cluster-api/v0.16/en/index.html">0.16</a>
            </li>
            <li class="version">
              <a href="../../../../../cluster-api/v0.15/en/index.html">0.15</a>
            </li>
            <li class="version">
              <a href="../../../../../cluster-api/v0.14/en/index.html">0.14</a>
            </li>
            <li class="version">
              <a href="../../../../../cluster-api/v0.13/en/index.html">0.13</a>
            </li>
            <li class="version">
              <a href="../../../../../cluster-api/v0.12/en/index.html">0.12</a>
            </li>
            <li class="version">
              <a href="../../../../../cluster-api/v0.11/en/index.html">0.11</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../../continuous-delivery/v0.12/en/index.html">Continuous Delivery</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../../continuous-delivery/v0.12/en/index.html">0.12</a>
            </li>
            <li class="version">
              <a href="../../../../../continuous-delivery/v0.11/en/index.html">0.11</a>
            </li>
            <li class="version">
              <a href="../../../../../continuous-delivery/v0.10/en/index.html">0.10</a>
            </li>
            <li class="version">
              <a href="../../../../../continuous-delivery/v0.9/en/index.html">0.9</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../../k3s/latest/en/introduction.html">K3s</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../../k3s/latest/en/introduction.html">Latest</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../../os-manager/next/en/index.html">OS Manager</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../../os-manager/next/en/index.html">Next</a>
            </li>
            <li class="version">
              <a href="../../../../../os-manager/latest/en/index.html">Latest</a>
            </li>
            <li class="version">
              <a href="../../../../../os-manager/1.7/en/index.html">1.7</a>
            </li>
            <li class="version">
              <a href="../../../../../os-manager/1.6/en/index.html">1.6</a>
            </li>
            <li class="version">
              <a href="../../../../../os-manager/1.5/en/index.html">1.5</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../../rke2/latest/en/introduction.html">RKE2</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../../rke2/latest/en/introduction.html">Latest</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../../suse-observability/latest/en/classic.html">SUSE Observability</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../../suse-observability/latest/en/classic.html">Latest</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../../rancher-manager/latest/en/about-rancher/what-is-rancher.html">SUSE® Rancher Manager</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../../rancher-manager/latest/en/about-rancher/what-is-rancher.html">latest</a>
            </li>
            <li class="version">
              <a href="../../../../../rancher-manager/v2.12/en/about-rancher/what-is-rancher.html">v2.12</a>
            </li>
            <li class="version">
              <a href="../../../../../rancher-manager/v2.11/en/about-rancher/what-is-rancher.html">v2.11</a>
            </li>
            <li class="version">
              <a href="../../../../../rancher-manager/v2.10/en/about-rancher/what-is-rancher.html">v2.10</a>
            </li>
            <li class="version">
              <a href="../../../../../rancher-manager/v2.9/en/about-rancher/what-is-rancher.html">v2.9</a>
            </li>
            <li class="version">
              <a href="../../../../../rancher-manager/v2.8/en/about-rancher/what-is-rancher.html">v2.8</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../../security/5.4/en/overview.html">SUSE® Security</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../../security/5.4/en/overview.html">5.4</a>
            </li>
            <li class="version">
              <a href="../../../../../security/5.3/en/overview.html">5.3</a>
            </li>
          </ul>
        </li>
        <li class="component is-current">
          <div class="title"><a href="../../../../latest/en/longhorn-documentation.html">SUSE® Storage</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../latest/en/longhorn-documentation.html">Latest</a>
            </li>
            <li class="version">
              <a href="../../../../1.11/en/longhorn-documentation.html">1.11 (Dev)</a>
            </li>
            <li class="version is-current">
              <a href="../../longhorn-documentation.html">1.10 (Dev)</a>
            </li>
            <li class="version">
              <a href="../../../../1.9/en/longhorn-documentation.html">1.9 (Latest)</a>
            </li>
            <li class="version">
              <a href="../../../../1.8/en/longhorn-documentation.html">1.8</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../../virtualization/v1.5/en/introduction/overview.html">SUSE® Virtualization</a></div>
          <ul class="versions">
            <li class="version">
              <a href="../../../../../virtualization/v1.6/en/introduction/overview.html">v1.6 (Dev)</a>
            </li>
            <li class="version is-latest">
              <a href="../../../../../virtualization/v1.5/en/introduction/overview.html">v1.5 (Latest)</a>
            </li>
            <li class="version">
              <a href="../../../../../virtualization/v1.4/en/introduction/overview.html">v1.4</a>
            </li>
            <li class="version">
              <a href="../../../../../virtualization/v1.3/en/introduction/overview.html">v1.3</a>
            </li>
          </ul>
        </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
<ul>
    <li>
      <a href="https://documentation.suse.com/" title="documentation.suse.com" aria-label="SUSE Documentation Home">Documentation Home</a>
    </li>
    <li>
      <a href="https://documentation.suse.com/cloudnative/storage" title="SUSE Storage" aria-label="SUSE Documentation - SUSE Storage">
        SUSE Storage
      </a>
    </li>
      <li>
          Snapshots and Backups
      </li>
  </ul>
</nav><div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">1.10 (Dev)</button>
  <div class="version-menu">
    <a class="version" href="../../../../latest/en/snapshots-backups/volume-snapshots-backups/configure-backup-target.html">Latest</a>
    <a class="version" href="../../../../1.11/en/snapshots-backups/volume-snapshots-backups/configure-backup-target.html">1.11 (Dev)</a>
    <a class="version is-current" href="configure-backup-target.html">1.10 (Dev)</a>
    <a class="version" href="../../../../1.9/en/snapshots-backups/volume-snapshots-backups/configure-backup-target.html">1.9 (Latest)</a>
    <a class="version" href="../../../../1.8/en/snapshots-backups/volume-snapshots-backups/configure-backup-target.html">1.8</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/rancher/longhorn-product-docs/edit/main/docs/version-1.10/modules/en/pages/snapshots-backups/volume-snapshots-backups/configure-backup-target.adoc"><strong>Edit</strong></a></div>
        <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <label class="visual-search-label-bc" for="search-input">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>
          <input label="Search" aria-label="Search" id="search-input" type="text" placeholder="Search the docs" >
          <label class="filter checkbox" style="display: none">
            <input type="checkbox" data-facet-filter="component:storage" checked> Only this project
          </label>
        </div>
      </div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="On this page" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This is unreleased documentation for SUSE® Storage 1.10 (Dev).</p>
</div>
</td>
</tr>
</table>
</div>
<h1 class="page">Configure a Backup Target</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>A backup target is an endpoint used to access a backupstore. Backup targets can be configured on the SUSE Storage UI (<strong>Settings &gt; Backup Target</strong>). A backupstore is a server that stores the backups of Longhorn volumes. You can use NFS, SMB/CIFS, Azure Blob Storage, and S3-compatible servers.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Starting with v1.8.0, SUSE Storage supports usage of multiple backupstores. Setting the default backup target before creating a new one is recommended.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Saving to an object store such as S3 is preferable because it generally offers better reliability.  Another advantage is that you do not need to mount and unmount the target, which can complicate failover and upgrades.</p>
</div>
<div class="paragraph">
<p>For more information about how the backupstore works in SUSE Storage, see <a href="../../introduction/concepts.html#_3_backups_and_secondary_storage" class="xref page">Concepts</a>.</p>
</div>
<div class="paragraph">
<p>If you don&#8217;t have access to AWS S3 or want to give the backupstore a try first, we&#8217;ve also provided a way to <a href="#_set_up_a_local_testing_backupstore">setup a local S3 testing backupstore</a> using <a href="https://minio.io/">MinIO</a>.</p>
</div>
<div class="paragraph">
<p>SUSE Storage also supports setting up recurring snapshot/backup jobs for volumes, via SUSE Storage UI or Kubernetes Storage Class. See <a href="create-recurring-backup-snapshot-job.html" class="xref page">here</a> for details.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>The lifecycle of Longhorn backups within the backupstore is managed entirely by SUSE Storage. <strong>Applying retention policies directly on the backupstore is strictly prohibited</strong>.</p>
</li>
<li>
<p>SUSE Storage attempts to clean up backup-related custom resources in the following scenarios:</p>
</li>
<li>
<p>The NFS server becomes unavailable and sends an empty response.</p>
</li>
<li>
<p>A race condition occurs between related Longhorn backup controllers.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The backup information is resynchronized during the next polling interval. For more information, see <a href="https://github.com/longhorn/longhorn/issues/9530">Issue #9530</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_default_backup_target"><a class="anchor" href="#_default_backup_target"></a>Default Backup Target</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The default backup target (<code>default</code>) is automatically created during a fresh installation. You can set the default backup target during or after the installation using either Helm or a <a href="https://raw.githubusercontent.com/longhorn/longhorn/v1.8.0/deploy/longhorn.yaml">manifest YAML file</a> (<code>longhorn.yaml</code>).</p>
</div>
<div class="sect2">
<h3 id="_set_the_default_backup_target_using_helm"><a class="anchor" href="#_set_the_default_backup_target_using_helm"></a>Set the Default Backup Target Using Helm</h3>
<div class="paragraph">
<p>In the <code>values.yaml</code> file, you can set three parameters to manage the default backup target.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>defaultBackupStore.backupTarget</code>: Endpoint used to access the default backupstore.</p>
</li>
<li>
<p><code>defaultBackupStore.backupTargetCredentialSecret</code>: Name of the Kubernetes secret associated with the default backup target.</p>
</li>
<li>
<p><code>defaultBackupStore.pollInterval</code>: Number of seconds that SUSE Storage waits before checking the default backupstore for new backups.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml"># -- Setting that allows you to update the default backupstore.
defaultBackupStore:
  # -- Endpoint used to access the default backupstore.
  backupTarget: ~
  # -- Name of the Kubernetes secret associated with the default backup target.
  backupTargetCredentialSecret: ~
  # -- Number of seconds that {longhorn-product-name} waits before checking the default backupstore for new backups.
  pollInterval: ~</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_set_the_default_backup_target_using_a_manifest_yaml_file"><a class="anchor" href="#_set_the_default_backup_target_using_a_manifest_yaml_file"></a>Set the Default Backup Target Using a Manifest YAML File</h3>
<div class="paragraph">
<p>Starting with v1.8.0, you can use a new <code>ConfigMap</code> resource named <code>longhorn-default-resource</code> to manage settings of resources, including the default backup target resource.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>backup-target</code>: Endpoint used to access the default backupstore.</p>
</li>
<li>
<p><code>backup-target-credential-secret</code>: Name of the Kubernetes secret associated with the default backup target.</p>
</li>
<li>
<p><code>backupstore-poll-interval</code>: Number of seconds that Longhorn waits before checking the default backupstore for new backups.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml"># Example
apiVersion: v1
kind: ConfigMap
metadata:
  name: longhorn-default-resource
  namespace: longhorn-system
data:
  default-resource.yaml: |
    "backup-target": "s3://example@us-west-1/"
    "backup-target-credential-secret": "example-secret"
    "backupstore-poll-interval": "180"</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_set_up_aws_s3_backupstore"><a class="anchor" href="#_set_up_aws_s3_backupstore"></a>Set up AWS S3 Backupstore</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a new bucket in <a href="https://aws.amazon.com/s3/">AWS S3.</a></p>
</li>
<li>
<p>Set permissions for SUSE Storage. There are two options for setting up the credentials. The first is that you can set up a Kubernetes secret with the credentials of an AWS IAM user. The second is that you can use a third-party application to manage temporary AWS IAM permissions for a Pod via annotations rather than operating with AWS credentials.</p>
<div class="ulist">
<ul>
<li>
<p>Option 1: Create a Kubernetes secret with IAM user credentials</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Follow the <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_users_create.html#id_users_create_console">guide</a> to create a new AWS IAM user, with the following permissions set. Edit the <code>Resource</code> section to use your S3 bucket name:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "GrantLonghornBackupstoreAccess0",
      "Effect": "Allow",
      "Action": [
        "s3:PutObject",
        "s3:GetObject",
        "s3:ListBucket",
        "s3:DeleteObject"
      ],
      "Resource": [
        "arn:aws:s3:::&lt;your-bucket-name&gt;",
        "arn:aws:s3:::&lt;your-bucket-name&gt;/*"
      ]
    }
  ]
}</code></pre>
</div>
</div>
</li>
<li>
<p>Create a Kubernetes secret with a name such as <code>aws-secret</code> in the namespace where SUSE Storage is placed (<code>longhorn-system</code> by default). The secret must be created in the <code>longhorn-system</code> namespace for SUSE Storage to access it:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">kubectl create secret generic &lt;aws-secret&gt; \
    --from-literal=AWS_ACCESS_KEY_ID=&lt;your-aws-access-key-id&gt; \
    --from-literal=AWS_SECRET_ACCESS_KEY=&lt;your-aws-secret-access-key&gt; \
    -n longhorn-system</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Option 2: Set permissions with IAM temporary credentials by AWS STS AssumeRole (kube2iam or kiam)</p>
<div class="paragraph">
<p><a href="https://github.com/jtblin/kube2iam">kube2iam</a> or <a href="https://github.com/uswitch/kiam">kiam</a> is a Kubernetes application that allows managing AWS IAM permissions for Pod via annotations rather than operating on AWS credentials. Follow the instructions in the GitHub repository for kube2iam or kiam to install it into the Kubernetes cluster.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Follow the <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-service.html#roles-creatingrole-service-console">guide</a> to create a new AWS IAM role for AWS S3 service, with the following permissions set:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "GrantLonghornBackupstoreAccess0",
      "Effect": "Allow",
      "Action": [
        "s3:PutObject",
        "s3:GetObject",
        "s3:ListBucket",
        "s3:DeleteObject"
      ],
      "Resource": [
        "arn:aws:s3:::&lt;your-bucket-name&gt;",
        "arn:aws:s3:::&lt;your-bucket-name&gt;/*"
      ]
    }
  ]
}</code></pre>
</div>
</div>
</li>
<li>
<p>Edit the AWS IAM role with the following trust relationship:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Principal": {
          "Service": "ec2.amazonaws.com"
      },
      "Action": "sts:AssumeRole"
    },
    {
      "Effect": "Allow",
      "Principal": {
        "AWS": "arn:aws:iam::&lt;AWS_ACCOUNT_ID&gt;:role/&lt;AWS_EC2_NODE_INSTANCE_ROLE&gt;"
      },
      "Action": "sts:AssumeRole"
    }
  ]
}</code></pre>
</div>
</div>
</li>
<li>
<p>Create a Kubernetes secret with a name such as <code>aws-secret</code> in the namespace where Longhorn is placed (<code>longhorn-system</code> by default). The secret must be created in the <code>longhorn-system</code> namespace for SUSE Storage to access it:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">kubectl create secret generic &lt;aws-secret&gt; \
    --from-literal=AWS_IAM_ROLE_ARN=&lt;your-aws-iam-role-arn&gt; \
    -n longhorn-system</code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>On the SUSE Storage UI, go to <strong>Backup and Restore &gt; Backup Targets</strong>, and then create or edit a backup target.</p>
<div class="paragraph">
<p>Set <strong>URL</strong> to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text"> s3://&lt;your-bucket-name&gt;@&lt;your-aws-region&gt;/</code></pre>
</div>
</div>
<div class="paragraph">
<p>Make sure that you have <code>/</code> at the end, otherwise you will get an error. A subdirectory (prefix) may be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-text hljs" data-lang="text"> s3://&lt;your-bucket-name&gt;@&lt;your-aws-region&gt;/mypath/</code></pre>
</div>
</div>
<div class="paragraph">
<p>Also make sure you&#8217;ve set <strong><code>&lt;your-aws-region&gt;</code> in the URL</strong>.</p>
</div>
<div class="paragraph">
<p>For example, For AWS, you can find the region codes <a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Concepts.RegionsAndAvailabilityZones.html">here.</a></p>
</div>
<div class="paragraph">
<p>For Google Cloud Storage, you can find the region codes <a href="https://cloud.google.com/storage/docs/locations">here.</a></p>
</div>
<div class="paragraph">
<p>Set <strong>Credential Secret</strong> to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>aws-secret</pre>
</div>
</div>
<div class="paragraph">
<p>This is the secret name with AWS credentials or AWS IAM role.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Result:</strong> SUSE Storage can store backups in S3. To create a backup, see <a href="create-backup.html" class="xref page">this section</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you operate SUSE Storage behind a proxy and you want to use AWS S3 as the backupstore, you must provide SUSE Storage information about your proxy in the <code>aws-secret</code> as below:
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">kubectl create secret generic &lt;aws-secret&gt; \
    --from-literal=AWS_ACCESS_KEY_ID=&lt;your-aws-access-key-id&gt; \
    --from-literal=AWS_SECRET_ACCESS_KEY=&lt;your-aws-secret-access-key&gt; \
    --from-literal=HTTP_PROXY=&lt;your-proxy-ip-and-port&gt; \
    --from-literal=HTTPS_PROXY=&lt;your-proxy-ip-and-port&gt; \
    --from-literal=NO_PROXY=&lt;excluded-ip-list&gt; \
    -n longhorn-system</code></pre>
</div>
</div>
<div class="paragraph">
<p>Make sure <code>NO_PROXY</code> contains the network addresses, network address ranges and domains that should be excluded from using the proxy. In order for SUSE Storage to operate, the minimum required values for <code>NO_PROXY</code> are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>localhost</p>
</li>
<li>
<p>127.0.0.1</p>
</li>
<li>
<p>0.0.0.0</p>
</li>
<li>
<p>10.0.0.0/8 (K8s components' IPs)</p>
</li>
<li>
<p>192.168.0.0/16 (internal IPs in the cluster)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_set_up_gcp_cloud_storage_backupstore"><a class="anchor" href="#_set_up_gcp_cloud_storage_backupstore"></a>Set up GCP Cloud Storage Backupstore</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a new bucket in <a href="https://console.cloud.google.com/storage/browser?referrer=search&amp;project=elite-protocol-319303">Google Cloud Storage</a></p>
</li>
<li>
<p>Create a GCP serviceaccount in <a href="https://console.cloud.google.com/iam-admin">IAM &amp; Admin</a></p>
</li>
<li>
<p>Give the GCP serviceaccount permissions to read, write, and delete objects in the bucket.</p>
<div class="paragraph">
<p>The serviceaccount will require the <code>roles/storage.objectAdmin</code> role to read, write, and delete objects in the bucket.</p>
</div>
<div class="paragraph">
<p>Here is a reference to the GCP IAM roles you have available for granting access to a serviceaccount <a href="https://cloud.google.com/storage/docs/access-control/iam-roles" class="bare">https://cloud.google.com/storage/docs/access-control/iam-roles</a>.</p>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Consider creating an IAM condition to reduce how many buckets this serviceaccount has object admin access to. On the Google Cloud console, go to <strong>Cloud Storage &gt; Buckets</strong>, and select the target bucket. On the <strong>Bucket details</strong> screen, go to the <strong>Permissions</strong> tab, click <strong>Grant Access</strong>, and grant your service account Storage Object Admin permissions for the target bucket.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Navigate to your <a href="https://console.cloud.google.com/storage/browser">buckets in cloud storage</a> and select your newly created bucket.</p>
</li>
<li>
<p>Go to the cloud storage&#8217;s settings menu and navigate to the <a href="https://console.cloud.google.com/storage/settings;tab=interoperability">interoperability tab</a></p>
</li>
<li>
<p>Scroll down to <em>Service account HMAC</em> and press <code>+ CREATE A KEY FOR A SERVICE ACCOUNT</code></p>
</li>
<li>
<p>Select the GCP serviceaccount you created earlier and press <code>CREATE KEY</code></p>
</li>
<li>
<p>Save the <em>Access Key</em> and <em>Secret</em>.</p>
<div class="paragraph">
<p>Also note down the configured <em>Storage URI</em> under the <em>Request Endpoint</em> while you&#8217;re in the interoperability menu.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Access Key will be mapped to the <code>AWS_ACCESS_KEY_ID</code> field in the Kubernetes secret we create later.</p>
</li>
<li>
<p>The Secret will be mapped to the <code>AWS_SECRET_ACCESS_KEY</code> field in the Kubernetes secret we create later.</p>
</li>
<li>
<p>The Storage URI will be mapped to the <code>AWS_ENDPOINTS</code> field in the Kubernetes secret we create later.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Go to the SUSE Storage UI. In the top navigation bar, click <strong>Backup and Restore/Backup Targets</strong>, and create or edit a backup target.</p>
<div class="paragraph">
<p>Set <strong>URL</strong> to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>s3://${BUCKET_NAME}@us/</pre>
</div>
</div>
<div class="paragraph">
<p>Set <strong>Credential Secret</strong> to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>longhorn-gcp-backups</pre>
</div>
</div>
</li>
<li>
<p>Create a Kubernetes secret named <code>longhorn-gcp-backups</code> in the <code>longhorn-system</code> namespace with the following content:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: v1
kind: Secret
metadata:
  name: longhorn-gcp-backups
  namespace: longhorn-system
type: Opaque
stringData:
  AWS_ACCESS_KEY_ID: GOOG1EBYHGDE4WIGH2RDYNZWWWDZ5GMQDRMNSAOTVHRAILWAMIZ2O4URPGOOQ
  AWS_ENDPOINTS: https://storage.googleapis.com
  AWS_SECRET_ACCESS_KEY: BKoKpIW021s7vPtraGxDOmsJbkV/0xOVBG73m+8f</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The secret can be named whatever you like as long as they match what is in SUSE Storage&#8217;s settings.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once the secret is created and SUSE Storage&#8217;s settings are saved, navigate to the backup tab in SUSE Storage. If there are any issues, they should pop up as a toast notification.</p>
</div>
<div class="paragraph">
<p>If you don&#8217;t get any error messages, try creating a backup and confirm the content is pushed out to your new bucket.</p>
</div>
<div class="paragraph">
<p>The <strong>Backup Target</strong> screen on the SUSE Storage UI displays the status of each backup target. If the status is <strong>Error</strong> and no other details are provided, you can use your browser&#8217;s <strong>Inspect</strong> feature to view the response data for <code>/v1/backuptargets</code>. Errors from GCP are labeled "AWS Error" (for example, <code>AWS Error: AccessDenied</code>). For more information, see <a href="https://github.com/longhorn/longhorn/issues/10428">Issue #10428</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_set_up_a_local_testing_backupstore"><a class="anchor" href="#_set_up_a_local_testing_backupstore"></a>Set up a Local Testing Backupstore</h2>
<div class="sectionbody">
<div class="paragraph">
<p>SUSE Storage provides sample backupstore server setups for testing purposes.  You can find samples for AWS S3 (MinIO), Azure, CIFS and NFS in the <code>longhorn/deploy/backupstores</code> folder.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Set up a MinIO S3 server for the backupstore in the <code>longhorn-system</code> namespace.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console"> kubectl create -f https://raw.githubusercontent.com/longhorn/longhorn/v1.10.0/deploy/backupstores/minio-backupstore.yaml</code></pre>
</div>
</div>
</li>
<li>
<p>Go to the SUSE Storage UI. click <strong>Backup and Restore/Backup Targets</strong>, and create or edit a backup target.</p>
<div class="paragraph">
<p>Set <strong>URL</strong> to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> s3://backupbucket@us-east-1/</pre>
</div>
</div>
<div class="paragraph">
<p>Set <strong>Credential Secret</strong> to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> minio-secret</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>minio-secret</code> yaml looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml"> apiVersion: v1
 kind: Secret
 metadata:
   name: minio-secret
   namespace: longhorn-system
 type: Opaque
 data:
   AWS_ACCESS_KEY_ID: bG9uZ2hvcm4tdGVzdC1hY2Nlc3Mta2V5 # longhorn-test-access-key
   AWS_SECRET_ACCESS_KEY: bG9uZ2hvcm4tdGVzdC1zZWNyZXQta2V5 # longhorn-test-secret-key
   AWS_ENDPOINTS: aHR0cHM6Ly9taW5pby1zZXJ2aWNlLmRlZmF1bHQ6OTAwMA== # https://minio-service.default:9000
   AWS_CERT: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURMRENDQWhTZ0F3SUJBZ0lSQU1kbzQycGhUZXlrMTcvYkxyWjVZRHN3RFFZSktvWklodmNOQVFFTEJRQXcKR2pFWU1CWUdBMVVFQ2hNUFRHOXVaMmh2Y200Z0xTQlVaWE4wTUNBWERUSXdNRFF5TnpJek1EQXhNVm9ZRHpJeApNakF3TkRBek1qTXdNREV4V2pBYU1SZ3dGZ1lEVlFRS0V3OU1iMjVuYUc5eWJpQXRJRlJsYzNRd2dnRWlNQTBHCkNTcUdTSWIzRFFFQkFRVUFBNElCRHdBd2dnRUtBb0lCQVFEWHpVdXJnUFpEZ3pUM0RZdWFlYmdld3Fvd2RlQUQKODRWWWF6ZlN1USs3K21Oa2lpUVBvelVVMmZvUWFGL1BxekJiUW1lZ29hT3l5NVhqM1VFeG1GcmV0eDBaRjVOVgpKTi85ZWFJNWRXRk9teHhpMElPUGI2T0RpbE1qcXVEbUVPSXljdjRTaCsvSWo5Zk1nS0tXUDdJZGxDNUJPeThkCncwOVdkckxxaE9WY3BKamNxYjN6K3hISHd5Q05YeGhoRm9tb2xQVnpJbnlUUEJTZkRuSDBuS0lHUXl2bGhCMGsKVHBHSzYxc2prZnFTK3hpNTlJeHVrbHZIRXNQcjFXblRzYU9oaVh6N3lQSlorcTNBMWZoVzBVa1JaRFlnWnNFbQovZ05KM3JwOFhZdURna2kzZ0UrOElXQWRBWHExeWhqRDdSSkI4VFNJYTV0SGpKUUtqZ0NlSG5HekFnTUJBQUdqCmF6QnBNQTRHQTFVZER3RUIvd1FFQXdJQ3BEQVRCZ05WSFNVRUREQUtCZ2dyQmdFRkJRY0RBVEFQQmdOVkhSTUIKQWY4RUJUQURBUUgvTURFR0ExVWRFUVFxTUNpQ0NXeHZZMkZzYUc5emRJSVZiV2x1YVc4dGMyVnlkbWxqWlM1awpaV1poZFd4MGh3Ui9BQUFCTUEwR0NTcUdTSWIzRFFFQkN3VUFBNElCQVFDbUZMMzlNSHVZMzFhMTFEajRwMjVjCnFQRUM0RHZJUWozTk9kU0dWMmQrZjZzZ3pGejFXTDhWcnF2QjFCMVM2cjRKYjJQRXVJQkQ4NFlwVXJIT1JNU2MKd3ViTEppSEtEa0Jmb2U5QWI1cC9VakpyS0tuajM0RGx2c1cvR3AwWTZYc1BWaVdpVWorb1JLbUdWSTI0Q0JIdgpnK0JtVzNDeU5RR1RLajk0eE02czNBV2xHRW95YXFXUGU1eHllVWUzZjFBWkY5N3RDaklKUmVWbENtaENGK0JtCmFUY1RSUWN3cVdvQ3AwYmJZcHlERFlwUmxxOEdQbElFOW8yWjZBc05mTHJVcGFtZ3FYMmtYa2gxa3lzSlEralAKelFadHJSMG1tdHVyM0RuRW0yYmk0TktIQVFIcFc5TXUxNkdRakUxTmJYcVF0VEI4OGpLNzZjdEg5MzRDYWw2VgotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0t</code></pre>
</div>
</div>
<div class="paragraph">
<p>For more information on creating a secret, see <a href="https://kubernetes.io/docs/concepts/configuration/secret/#creating-a-secret-manually">the Kubernetes documentation.</a> The secret must be created in the <code>longhorn-system</code> namespace for SUSE Storage to access it.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Make sure to use <code>echo -n</code> when generating the base64 encoding, otherwise a new line will be added at the end of the string and it will cause error when accessing the S3.
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Click the <strong>Backup</strong> tab in the UI. It should report an empty list without any errors.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Result:</strong> SUSE Storage can store backups in S3. To create a backup, see <a href="create-backup.html" class="xref page">this section.</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_a_self_signed_ssl_certificate_for_s3_communication"><a class="anchor" href="#_using_a_self_signed_ssl_certificate_for_s3_communication"></a>Using a self-signed SSL certificate for S3 communication</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you want to use a self-signed SSL certificate, you can specify AWS_CERT in the Kubernetes secret you provided to SUSE Storage. See the example in <a href="#_set_up_a_local_testing_backupstore">Set up a Local Testing Backupstore</a>.
It&#8217;s important to note that the certificate needs to be in PEM format, and must be its own CA. Or one must include a certificate chain that contains the CA certificate.
To include multiple certificates, one can just concatenate the different certificates (PEM files).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_enable_virtual_hosted_style_access_for_s3_compatible_backupstore"><a class="anchor" href="#_enable_virtual_hosted_style_access_for_s3_compatible_backupstore"></a>Enable virtual-hosted-style access for S3 compatible Backupstore</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>You may need to enable this new addressing approach for your S3 compatible Backupstore when</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>you want to switch to this new access style right now so that you won&#8217;t need to worry about <a href="https://aws.amazon.com/blogs/aws/amazon-s3-path-deprecation-plan-the-rest-of-the-story/">Amazon S3 Path Deprecation Plan</a>;</p>
</li>
<li>
<p>the backupstore you are using supports virtual-hosted-style access only, e.g., Alibaba Cloud(Aliyun) OSS;</p>
</li>
<li>
<p>you have configured <code>MINIO_DOMAIN</code> environment variable to <a href="https://min.io/docs/minio/linux/administration/object-management.html#path-vs-virtual-host-bucket-access">enable virtual-host-style requests for the MinIO server</a>;</p>
</li>
<li>
<p>the error <code>...... error: AWS Error: SecondLevelDomainForbidden Please use virtual hosted style to access. .....</code> is triggered.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>The way to enable virtual-hosted-style access</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add a new field <code>VIRTUAL_HOSTED_STYLE</code> with value <code>true</code> to your backup target secret. e.g.:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml"> apiVersion: v1
 kind: Secret
 metadata:
   name: s3-compatible-backup-target-secret
   namespace: longhorn-system
 type: Opaque
 data:
   AWS_ACCESS_KEY_ID: bG9uZ2hvcm4tdGVzdC1hY2Nlc3Mta2V5
   AWS_SECRET_ACCESS_KEY: bG9uZ2hvcm4tdGVzdC1zZWNyZXQta2V5
   AWS_ENDPOINTS: aHR0cHM6Ly9taW5pby1zZXJ2aWNlLmRlZmF1bHQ6OTAwMA==
   VIRTUAL_HOSTED_STYLE: dHJ1ZQ== # true</code></pre>
</div>
</div>
</li>
<li>
<p>Deploy or update the secret.</p>
</li>
<li>
<p>Create the corresponding backup target in <strong>Backup and Restore &gt; Backup Targets</strong> by providing the following details:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p><strong>Name</strong>: Enter the desired name for your backup target.</p>
</li>
<li>
<p><strong>URL</strong>: Specify the S3 URL using the format <code>s3://&lt;bucket-name&gt;@&lt;region&gt;/</code>.</p>
</li>
<li>
<p><strong>Credential Secret</strong>: Select the credential secret. For this example, it is <code>s3-compatible-backup-target-secret</code>.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_set_up_nfs_backupstore"><a class="anchor" href="#_set_up_nfs_backupstore"></a>Set up NFS Backupstore</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Ensure that the NFS server supports NFSv4 and that the target URL points to the service.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>nfs://longhorn-test-nfs-svc.default:/opt/backupstore</pre>
</div>
</div>
<div class="paragraph">
<p>The default mount options are <code>actimeo=1,soft,timeo=300,retry=2</code>.  To use other options, append the keyword "nfsOptions" and the options string to the target URL.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>nfs://longhorn-test-nfs-svc.default:/opt/backupstore?nfsOptions=soft,timeo=330,retrans=3</pre>
</div>
</div>
<div class="paragraph">
<p>Any mount options that you specify will replace, not add to, the default options.</p>
</div>
<div class="paragraph">
<p>You can find an example NFS backupstore for testing purpose <a href="https://github.com/longhorn/longhorn/blob/v1.10.0/deploy/backupstores/nfs-backupstore.yaml">here</a>.</p>
</div>
<div class="paragraph">
<p><strong>Result:</strong> SUSE Storage can store backups in NFS. To create a backup, see <a href="create-backup.html" class="xref page">this section.</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_set_up_smbcifs_backupstore"><a class="anchor" href="#_set_up_smbcifs_backupstore"></a>Set up SMB/CIFS Backupstore</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before configuring a SMB/CIFS backupstore, a credential secret for the backupstore can be created and deployed by</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">  #!/bin/bash

  USERNAME=${Username of SMB/CIFS Server}
  PASSWORD=${Password of SMB/CIFS Server}

  CIFS_USERNAME=`echo -n ${USERNAME} | base64`
  CIFS_PASSWORD=`echo -n ${PASSWORD} | base64`

  cat &lt;&lt;EOF &gt;&gt;cifs_secret.yml
  apiVersion: v1
  kind: Secret
  metadata:
    name: cifs-secret
    namespace: longhorn-system
  type: Opaque
  data:
    CIFS_USERNAME: ${CIFS_USERNAME}
    CIFS_PASSWORD: ${CIFS_PASSWORD}
  EOF

  kubectl apply -f cifs_secret.yml</code></pre>
</div>
</div>
<div class="paragraph">
<p>On the SUSE Storage UI, go to <strong>Backup and Restore &gt; Backup Targets</strong>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create or edit a backup target.</p>
<div class="paragraph">
<p>Set <strong>URL</strong> to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> cifs://longhorn-test-cifs-svc.default/backupstore</pre>
</div>
</div>
<div class="paragraph">
<p>The default CIFS mount option is "soft".  To use other options, append the keyword "cifsOptions" and the options string to the target URL.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> cifs://longhorn-test-cifs-svc.default/backupstore?cifsOptions=rsize=65536,wsize=65536,soft</pre>
</div>
</div>
<div class="paragraph">
<p>Any mount options that you specify will replace, not add to, the default options.</p>
</div>
</li>
<li>
<p>Set <strong>Backup Target Credential Secret</strong>.</p>
<div class="paragraph">
<p>Set <strong>Credential Secret</strong> to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> cifs-secret</pre>
</div>
</div>
<div class="paragraph">
<p>This is the secret name with CIFS credentials.</p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>You can find an example CIFS backupstore for testing purpose <a href="https://github.com/longhorn/longhorn/blob/v1.10.0/deploy/backupstores/cifs-backupstore.yaml">here</a>.</p>
</div>
<div class="paragraph">
<p><strong>Result:</strong> SUSE Storage can store backups in CIFS. To create a backup, see <a href="create-backup.html" class="xref page">this section.</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_set_up_azure_blob_storage_backupstore"><a class="anchor" href="#_set_up_azure_blob_storage_backupstore"></a>Set up Azure Blob Storage Backupstore</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Verify that a container for the backupstore exists in <a href="https://portal.azure.com/">Azure Blob Storage</a>.</p>
</li>
<li>
<p>Grant the Azure service account permissions to read, write, and delete objects in the container.</p>
<div class="paragraph">
<p>For more information, see <a href="https://learn.microsoft.com/en-us/azure/storage/blobs/blob-containers-portal">Manage blob containers using the Azure portal</a> in the Microsoft documentation.</p>
</div>
</li>
<li>
<p>Go to <strong>Home &#8594; <code>serviceaccount</code> &#8594; Security + networking &#8594; Access keys</strong>.</p>
</li>
<li>
<p>Save the following information:</p>
<div class="ulist">
<ul>
<li>
<p><code>Storage account name</code>: Maps to the <code>AZBLOB_ACCOUNT_NAME</code> field in the Kubernetes secret that you will create.</p>
</li>
<li>
<p><code>Key</code>: Maps to the <code>AZBLOB_ACCOUNT_KEY</code> field in the Kubernetes secret that you will create.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Go to the SUSE Storage UI. In the top navigation bar, click <strong>Backup and Restore/Backup Targets</strong>, and create or edit a backup target.</p>
<div class="paragraph">
<p>Set <strong>URL</strong>. The target URL should look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-txt hljs" data-lang="txt">azblob://[your-container-name]@core.windows.net/</code></pre>
</div>
</div>
<div class="paragraph">
<p>Make sure that you have <code>/</code> at the end, otherwise you will get an error. A subdirectory (prefix) may be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-txt hljs" data-lang="txt">azblob://[your-container-name]@core.windows.net/my-path/</code></pre>
</div>
</div>
<div class="paragraph">
<p>Set <strong>Credential Secret</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-txt hljs" data-lang="txt">longhorn-azblob-secret</code></pre>
</div>
</div>
</li>
<li>
<p>Create a Kubernetes secret named <code>longhorn-azblob-secret</code>.</p>
<div class="paragraph">
<p>This secret is used to access the backupstore in the SUSE Storage namespace (default: <code>longhorn-system</code>) with the following content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">#!/bin/bash
cat &lt;&lt;EOF &gt;&gt;longhorn-azblob-secret.yml
apiVersion: v1
kind: Secret
metadata:
  name: longhorn-azblob-secret
  namespace: longhorn-system
type: Opaque
stringData:
  AZBLOB_ACCOUNT_NAME: "&lt;Storage account name&gt;"
  AZBLOB_ACCOUNT_KEY:  "&lt;Key&gt;"
  ...
  # Parameters below are used for the compatible azure server for instance `Azurite` or
  # you have a proxy to redirect the requests.
  #AZBLOB_ENDPOINT: ""
  #AZBLOB_CERT: ""
  #HTTP_PROXY: ""
  #HTTPS_PROXY: ""
EOF
kubectl apply -f longhorn-azblob-secret.yml</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>After configuring the above settings, you can manage backups on Azure Blob storage. See <a href="create-backup.html" class="xref page">how to create backup</a> for details.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="snapshot-space-management.html">Snapshot Space Management</a></span>
  <span class="next"><a href="create-backup.html">Create a Backup</a></span>
</nav>
</article>
  </div>
</main>
</div>
<script src="../../../../../_/js/site.js"></script>
<script async src="../../../../../_/js/vendor/highlight.js"></script>
<script src="../../../../../_/js/vendor/lunr.js"></script>
<script src="../../../../../_/js/vendor/lunr-languages.js"></script>
<script src="../../../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../../../.." data-snippet-length="100" data-stylesheet="../../../../../_/css/search.css"></script>
<script async src="../../../../../search-index.js"></script>
<script src="../../../../../_/js/vendor/langSelection.js"></script>
<script async src="../../../../../_/js/vendor/tabs.js"></script>


<script src="../../../../../_/js/CNLanguageSwitcher.js"></script>
  </body>
</html>
