<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SUSE Storage VolumeAttachment :: Rancher product documentation</title>
    <link rel="canonical" href="https://documentation.suse.com/cloudnative/storage/latest/en/volumes/volume-attachment.html">
    <link rel="prev" href="volume-expansion.html">
    <link rel="next" href="trim-filesystem.html">
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../../../../_/css/site.css">
<meta http-equiv="last-modified" content="2025-07-16"/>
<link rel="stylesheet" href="../../../../_/css/search.css">
<link rel="icon" href="../../../../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="../../../../_/css/font-styles.css">
<link rel="stylesheet" href="../../../../_/fonts/css/all.css">
<link rel="stylesheet" href="../../../../_/css/site-extra.css">
<link rel="stylesheet" href="../../../../_/css/vendor/tabs.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=SUSE:wght@100..800&display=swap&family=SUSE+Mono:ital,wght@0,100..800;1,100..800" rel="stylesheet">
<link href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css" rel="stylesheet">
<!-- <link href="https://fonts.googleapis.com/css?family=Montserrat|Roboto&display=swap" rel="stylesheet"> -->
<link rel="stylesheet" href="../../../../_/css/vendor/light.css">
<script src="/docserv/res/lightheaded/analytics.js" type="text/javascript"></script>

<script type="module">
  import { defineCustomElements, setAssetPath } from 'https://d12w0ryu9hjsx8.cloudfront.net/shared-header/1.5/shared-header.esm.js';
  defineCustomElements();
  setAssetPath("https://d12w0ryu9hjsx8.cloudfront.net/shared-header/1.5/assets");
</script>    <script>var uiRootPath = '../../../../_'</script>
  </head>
  <body class="article">
<script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs'; mermaid.initialize({"startOnLoad":true});</script><!-- Canonical link -->
<link href="https://documentation.suse.com/cloudnative/storage/latest/en/volumes/volume-attachment.html" rel="canonical"/>

<!-- Default English link -->
<link href="https://documentation.suse.com/cloudnative/storage/1.8/en/volumes/volume-attachment.html" hreflang="x-default" rel="alternate"/>

<!-- Link for the currently processed page -->
<link href="https://documentation.suse.com/cloudnative/storage/1.8/en/volumes/volume-attachment.html" hrefLang="en-US" rel="alternate" />











<shared-header language="en" languages='{
"en": { "label": "English", "url": "https://documentation.suse.com/en-us/" },
"de": { "label": "Deutsch", "url": "https://documentation.suse.com/de-de/" },
"fr": { "label": "Français", "url": "https://documentation.suse.com/fr-fr/" },
"es": { "label": "Español", "url": "https://documentation.suse.com/es-es/" },
"zh_CN": { "label": "中文", "url": "https://documentation.suse.com/zh-cn/" },
"pt_BR": { "label": "Português Brasileiro", "url": "https://documentation.suse.com/pt-br/" }
}'>
</shared-header>

<!-- Leaving as a comment, I expect it will be required again next year.
<a target=_blank"" class="survey-link" href="https://suselinux.fra1.qualtrics.com/jfe/form/SV_bEiGZbUNzLD8Tcy"> Documentation survey </a>
--><div class="body">
<div class="nav-container" data-component="storage" data-version="1.8">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title">SUSE® Storage</h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../longhorn-documentation.html">SUSE® Storage Overview</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../introduction/introduction.html">Introduction</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/concepts.html">Architecture and Concepts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/terminology.html">Terminology</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/document-conventions.html">Document Conventions</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../important-notes.html">Important Notes</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Installation and Setup</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../installation-setup/requirements.html">Requirements</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../installation-setup/best-practices.html">Best Practices</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../installation-setup/installation/installation.html">Installation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../installation-setup/installation/install-using-argocd.html">Install SUSE Storage Using ArgoCD</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../installation-setup/installation/install-using-fleet.html">Install SUSE Storage Using Fleet</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../installation-setup/installation/install-using-flux.html">Install SUSE® Storage Using Flux</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../installation-setup/installation/install-using-helm.html">Install SUSE Storage Using Helm</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../installation-setup/installation/install-using-helm-controller.html">Install SUSE Storage Using Helm Controller</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../installation-setup/installation/helm-values.html">Helm Values</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../installation-setup/installation/install-using-kubectl.html">Install SUSE Storage Using Kubectl</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../installation-setup/installation/install-using-rancher.html">Install SUSE Storage Using Rancher</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../installation-setup/installation/rancher-windows-cluster.html">Rancher Windows Cluster</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../installation-setup/installation/airgapped-environment.html">Install SUSE Storage in an Air-Gapped Environment</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Operating System and Distribution Configuration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../installation-setup/os-distro/container-optimized-os.html">Container-Optimized OS (COS)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../installation-setup/os-distro/gke.html">Google Kubernetes Engine (GKE)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../installation-setup/os-distro/k3s.html">K3s</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../installation-setup/os-distro/ocp-okd.html">Red Hat OpenShift Container Platform and OKD</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../installation-setup/os-distro/rke-coreos.html">RKE and CoreOS</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../installation-setup/os-distro/talos-linux.html">Talos Linux</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../installation-setup/setup-performance-scalability-sizing-guidelines.html">Setup, Performance, Scalability, and Sizing Guidelines</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../installation-setup/uninstallation.html">Uninstallation</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../upgrades/upgrades.html">Upgrades</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Component Upgrades</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../upgrades/longhorn-components/auto-upgrade-engine.html">Automatically Upgrade the Longhorn Engine</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../upgrades/longhorn-components/manually-upgrade-engine.html">Manually Upgrade the Longhorn Engine</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../upgrades/longhorn-components/upgrade-longhorn-manager.html">Upgrade Longhorn Manager</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Kubernetes Upgrades</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../upgrades/kubernetes/upgrade-k8s-on-aks.html">Upgrade Kubernetes on Azure Kubernetes Service (AKS)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../upgrades/kubernetes/upgrade-k8s-on-eks.html">Upgrade Kubernetes on Amazon Elastic Kubernetes Service (Amazon EKS)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../upgrades/kubernetes/upgrade-k8s-on-gke.html">Upgrade Kubernetes on Google Kubernetes Engine (GKE)</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">SUSE® Storage System</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../longhorn-system/system-access/system-access.html">System Access</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../longhorn-system/system-access/longhorn-ui.html">Access the User Interface</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../longhorn-system/system-access/create-ingress.html">Create an Ingress with Basic Authentication (nginx)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../longhorn-system/system-access/longhorn-cli.html">Command Line Interface (CLI)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../longhorn-system/system-access/install-longhorn-cli.html">Install the CLI</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../longhorn-system/system-access/longhorn-python-client.html">Python Client</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../longhorn-system/networking/networking.html">Networking</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../longhorn-system/networking/storage-network.html">Storage Network</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../longhorn-system/mtls-support.html">Mutual TLS (mTLS) Support</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../longhorn-system/customize-default-settings.html">Customize Default Settings</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../longhorn-system/settings.html">Settings</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">V2 Data Engine (Preview Feature)</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../longhorn-system/v2-data-engine/features/features.html">V2 Data Engine Features</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../longhorn-system/v2-data-engine/features/selective-engine-activation.html">Selective V2 Data Engine Activation</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../longhorn-system/v2-data-engine/features/node-disk-support.html">Node Disk Support</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../longhorn-system/v2-data-engine/features/configurable-cpu-cores.html">Configurable CPU Cores</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../longhorn-system/v2-data-engine/prerequisites.html">Prerequisites</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../longhorn-system/v2-data-engine/quick-start-guide.html">Quick Start Guide</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../longhorn-system/v2-data-engine/performance.html">Performance</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../longhorn-system/examples-resources.html">Examples of Kubernetes Resources that Use SUSE® Storage</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../longhorn-system/migrate-flexvolume.html">Migrate from the Flexvolume Driver to CSI</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Nodes</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../nodes/node-space-usage.html">Node Space Usage</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../nodes/default-disk-and-node-config.html">Configure Default Node and Disk Settings</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../nodes/storage-tags.html">Storage Tags</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../nodes/multiple-disks.html">Multiple Disks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../nodes/disks-or-nodes-eviction.html">Evicting Replicas on Disabled Disks or Nodes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../nodes/scheduling.html">Scheduling</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../nodes/node-conditions.html">Node Conditions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../nodes/node-selector.html">Node Selector</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../nodes/taints-tolerations.html">Taints and Tolerations</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../nodes/priority-class.html">Priority Class</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Managed Kubernetes</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../nodes/managed-kubernetes/aks-managed-node-groups.html">Managed Node Groups on Azure Kubernetes Service (AKS)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../nodes/managed-kubernetes/eks-managed-node-pools.html">Managed Node Pools on Amazon Elastic Kubernetes Service (Amazon EKS)</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../nodes/managed-kubernetes/gke-managed-node-pools.html">Managed Node Pools on Google Kubernetes Engine (GKE)</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Volumes</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="create-volumes.html">Create Volumes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="pvc-ownership-and-permission.html">PVC Ownership and Permission</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="rwx-volumes.html">ReadWriteMany (RWX) Volumes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="clone-volumes.html">Clone Volumes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="detach-volumes.html">Detach Volumes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="delete-volumes.html">Delete Volumes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="use-as-iscsi-target.html">Use a Volume as an iSCSI Target</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="identify-workloads.html">Identify Workloads that Use a Volume</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="volume-size.html">Volume Size</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="volume-expansion.html">Volume Expansion</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="volume-attachment.html">SUSE Storage VolumeAttachment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="trim-filesystem.html">Trim the Filesystem</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="volume-conditions.html">Volume Conditions</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="volume-encryption.html">Volume Encryption</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="storageclass-parameters.html">StorageClass Parameters</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="backing-images/backing-images.html">Backing Images</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="backing-images/backing-image-encryption.html">Backing Image Encryption</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">High Availability</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../high-availability/automatic-replica-balancing.html">Automatic Replica Balancing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../high-availability/fast-replica-rebuilding.html">Fast Replica Rebuilding</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../high-availability/revision_counter.html">Revision Counter</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../high-availability/data-locality.html">Data Locality</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../high-availability/kubernetes-cluster-autoscaler.html">Kubernetes Cluster Autoscaler Support (Experimental)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../high-availability/rwx-volume-fast-failover.html">RWX Volume Fast Failover (Experimental)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../high-availability/volume-recovery.html">Volume Recovery</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../high-availability/node-failure.html">Node Failure Management</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Snapshots and Backups</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../snapshots-backups/volume-snapshots-backups/volume-snapshots-backups.html">Volume Snapshots and Backups</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../snapshots-backups/volume-snapshots-backups/create-snapshot.html">Create a Snapshot</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../snapshots-backups/volume-snapshots-backups/snapshot-space-management.html">Snapshot Space Management</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../snapshots-backups/volume-snapshots-backups/configure-backup-target.html">Configure a Backup Target</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../snapshots-backups/volume-snapshots-backups/create-backup.html">Create a Backup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../snapshots-backups/volume-snapshots-backups/sync-backup-volumes-manually.html">Manually Synchronize Backup Volumes</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../snapshots-backups/volume-snapshots-backups/create-recurring-backup-snapshot-job.html">Create a Recurring Snapshot or Backup Job</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../snapshots-backups/volume-snapshots-backups/restore-volume-from-backup.html">Restore a Volume from a Backup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../snapshots-backups/volume-snapshots-backups/restore-recurring-job-from-backup.html">Restore a Recurring Job from a Backup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../snapshots-backups/volume-snapshots-backups/restore-volume-statefulset.html">Restore a Volume for a Kubernetes StatefulSet</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../snapshots-backups/csi-snapshots/csi-snapshots.html">CSI Snapshots</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../snapshots-backups/csi-snapshots/csi-snapshot-longhorn-backing-image.html">CSI Volume Snapshot Associated with a SUSE® Storage Backing Image</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../snapshots-backups/csi-snapshots/csi-snapshot-longhorn-backup.html">CSI Volume Snapshot Associated with a SUSE® Storage Backup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../snapshots-backups/csi-snapshots/csi-snapshot-longhorn-snapshot.html">CSI Volume Snapshot Associated with a SUSE® Storage Snapshot</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../snapshots-backups/csi-snapshots/enable-csi-snapshot-creation.html">Enable CSI Snapshot Creation on a Cluster</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../snapshots-backups/system-backups/system-backups.html">SUSE® Storage System Backups</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../snapshots-backups/system-backups/restore-to-cluster-using-rancher-snapshot.html">Restore the SUSE® Storage System to a Cluster Using a Rancher Snapshot</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../snapshots-backups/system-backups/restore-to-new-cluster-using-velero.html">Restore the SUSE® Storage System to a New Cluster Using Velero</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../snapshots-backups/system-backups/create-system-backup.html">Create a SUSE® Storage System Backup</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../snapshots-backups/system-backups/restore-system.html">Restore the SUSE® Storage System</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../snapshots-backups/backing-image-backups.html">Backing Image Backup</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../snapshots-backups/restore-cluster-rancher-snapshot.html">Restore a Cluster Using a Rancher Snapshot</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Data Integrity and Recovery</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../data-integrity-recovery/snapshot-data-integrity-check.html">Snapshot Data Integrity Check</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../data-integrity-recovery/orphaned-data-cleanup.html">Orphaned Data Cleanup</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../data-integrity-recovery/disaster-recovery-volumes.html">Disaster Recovery Volumes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Data Recovery</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../data-integrity-recovery/data-recovery/identify-corrupted-replicas.html">Identify Corrupted Replicas</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../data-integrity-recovery/data-recovery/retrieve-volume-data-from-replica.html">Retrieve Volume Data from a Single Replica</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../data-integrity-recovery/data-recovery/recover-from-data-errors.html">Identify and Recover from Data Errors</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../data-integrity-recovery/data-recovery/recover-from-full-disk.html">Recover from a Full Disk</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../data-integrity-recovery/data-recovery/recover-without-system.html">Recover from a SUSE® Storage Backup without the System Installed</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Observability</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../observability/configure-prometheus-grafana.html">Configure Prometheus and Grafana to Monitor SUSE® Storage</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../observability/alert-rule-examples.html">Alert Rule Examples</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../observability/longhorn-metrics.html">SUSE® Storage Metrics for Monitoring</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../observability/integrate-with-rancher-monitoring.html">Integrate SUSE® Storage Metrics into the Rancher Monitoring System</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../observability/kubelet-volume-metrics.html">Kubelet Volume Metrics</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Troubleshooting and Maintenance</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../troubleshooting-maintenance/support-bundle.html">Support Bundle</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../troubleshooting-maintenance/troubleshooting.html">Troubleshooting Problems</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../troubleshooting-maintenance/v2-data-engine-issues.html">Troubleshooting</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../troubleshooting-maintenance/maintenance.html">Node Maintenance and Kubernetes Upgrade Guide</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">SUSE® Storage</span>
    <span class="version">1.8</span>
  </div>
  <ul class="components">
        <li class="component">
          <div class="title"><a href="../../../../admission-controller/1.29/en/introduction.html">Admission Controller</a></div>
          <ul class="versions">
            <li class="version">
              <a href="../../../../admission-controller/1.30/en/introduction.html">1.30-next</a>
            </li>
            <li class="version is-latest">
              <a href="../../../../admission-controller/1.29/en/introduction.html">1.29</a>
            </li>
            <li class="version">
              <a href="../../../../admission-controller/1.28/en/introduction.html">1.28</a>
            </li>
            <li class="version">
              <a href="../../../../admission-controller/1.27/en/introduction.html">1.27</a>
            </li>
            <li class="version">
              <a href="../../../../admission-controller/1.26/en/introduction.html">1.26</a>
            </li>
            <li class="version">
              <a href="../../../../admission-controller/1.25/en/introduction.html">1.25</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../cluster-api/latest/en/index.html">Cluster API</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../cluster-api/latest/en/index.html">Latest</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.24/en/index.html">0.24</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.23/en/index.html">0.23</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.22/en/index.html">0.22</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.21/en/index.html">0.21</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.20/en/index.html">0.20</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.19/en/index.html">0.19</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.18/en/index.html">0.18</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.17/en/index.html">0.17</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.16/en/index.html">0.16</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.15/en/index.html">0.15</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.14/en/index.html">0.14</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.13/en/index.html">0.13</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.12/en/index.html">0.12</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.11/en/index.html">0.11</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../continuous-delivery/v0.12/en/index.html">Continuous Delivery</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../continuous-delivery/v0.12/en/index.html">0.12</a>
            </li>
            <li class="version">
              <a href="../../../../continuous-delivery/v0.11/en/index.html">0.11</a>
            </li>
            <li class="version">
              <a href="../../../../continuous-delivery/v0.10/en/index.html">0.10</a>
            </li>
            <li class="version">
              <a href="../../../../continuous-delivery/v0.9/en/index.html">0.9</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../k3s/latest/en/introduction.html">K3s</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../k3s/latest/en/introduction.html">Latest</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../os-manager/next/en/index.html">OS Manager</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../os-manager/next/en/index.html">Next</a>
            </li>
            <li class="version">
              <a href="../../../../os-manager/latest/en/index.html">Latest</a>
            </li>
            <li class="version">
              <a href="../../../../os-manager/1.7/en/index.html">1.7</a>
            </li>
            <li class="version">
              <a href="../../../../os-manager/1.6/en/index.html">1.6</a>
            </li>
            <li class="version">
              <a href="../../../../os-manager/1.5/en/index.html">1.5</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../rke2/latest/en/introduction.html">RKE2</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../rke2/latest/en/introduction.html">Latest</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../suse-observability/latest/en/classic.html">SUSE Observability</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../suse-observability/latest/en/classic.html">Latest</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../rancher-manager/latest/en/about-rancher/what-is-rancher.html">SUSE® Rancher Manager</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../rancher-manager/latest/en/about-rancher/what-is-rancher.html">latest</a>
            </li>
            <li class="version">
              <a href="../../../../rancher-manager/v2.12/en/about-rancher/what-is-rancher.html">v2.12</a>
            </li>
            <li class="version">
              <a href="../../../../rancher-manager/v2.11/en/about-rancher/what-is-rancher.html">v2.11</a>
            </li>
            <li class="version">
              <a href="../../../../rancher-manager/v2.10/en/about-rancher/what-is-rancher.html">v2.10</a>
            </li>
            <li class="version">
              <a href="../../../../rancher-manager/v2.9/en/about-rancher/what-is-rancher.html">v2.9</a>
            </li>
            <li class="version">
              <a href="../../../../rancher-manager/v2.8/en/about-rancher/what-is-rancher.html">v2.8</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../security/5.4/en/overview.html">SUSE® Security</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../security/5.4/en/overview.html">5.4</a>
            </li>
            <li class="version">
              <a href="../../../../security/5.3/en/overview.html">5.3</a>
            </li>
          </ul>
        </li>
        <li class="component is-current">
          <div class="title"><a href="../../../latest/en/longhorn-documentation.html">SUSE® Storage</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../latest/en/longhorn-documentation.html">Latest</a>
            </li>
            <li class="version">
              <a href="../../../1.11/en/longhorn-documentation.html">1.11 (Dev)</a>
            </li>
            <li class="version">
              <a href="../../../1.10/en/longhorn-documentation.html">1.10 (Dev)</a>
            </li>
            <li class="version">
              <a href="../../../1.9/en/longhorn-documentation.html">1.9 (Latest)</a>
            </li>
            <li class="version is-current">
              <a href="../longhorn-documentation.html">1.8</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../virtualization/v1.5/en/introduction/overview.html">SUSE® Virtualization</a></div>
          <ul class="versions">
            <li class="version">
              <a href="../../../../virtualization/v1.6/en/introduction/overview.html">v1.6 (Dev)</a>
            </li>
            <li class="version is-latest">
              <a href="../../../../virtualization/v1.5/en/introduction/overview.html">v1.5 (Latest)</a>
            </li>
            <li class="version">
              <a href="../../../../virtualization/v1.4/en/introduction/overview.html">v1.4</a>
            </li>
            <li class="version">
              <a href="../../../../virtualization/v1.3/en/introduction/overview.html">v1.3</a>
            </li>
          </ul>
        </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
<ul>
    <li>
      <a href="https://documentation.suse.com/" title="documentation.suse.com" aria-label="SUSE Documentation Home">Documentation Home</a>
    </li>
    <li>
      <a href="https://documentation.suse.com/cloudnative/storage" title="SUSE Storage" aria-label="SUSE Documentation - SUSE Storage">
        SUSE Storage
      </a>
    </li>
      <li>
          Volumes
      </li>
  </ul>
</nav><div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">1.8</button>
  <div class="version-menu">
    <a class="version" href="../../../latest/en/volumes/volume-attachment.html">Latest</a>
    <a class="version" href="../../../1.11/en/volumes/volume-attachment.html">1.11 (Dev)</a>
    <a class="version" href="../../../1.10/en/volumes/volume-attachment.html">1.10 (Dev)</a>
    <a class="version" href="../../../1.9/en/volumes/volume-attachment.html">1.9 (Latest)</a>
    <a class="version is-current" href="volume-attachment.html">1.8</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/rancher/longhorn-product-docs/edit/main/docs/version-1.8/modules/en/pages/volumes/volume-attachment.adoc"><strong>Edit</strong></a></div>
        <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <label class="visual-search-label-bc" for="search-input">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>
          <input label="Search" aria-label="Search" id="search-input" type="text" placeholder="Search the docs" >
          <label class="filter checkbox" style="display: none">
            <input type="checkbox" data-facet-filter="component:storage" checked> Only this project
          </label>
        </div>
      </div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="On this page" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">SUSE Storage VolumeAttachment</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This document provides a detailed overview of the <code>VolumeAttachment</code> custom resource for SUSE Storage, its integration with Kubernetes' native <code>VolumeAttachment</code>, operational flow, and common troubleshooting scenarios.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_kubernetes_and_suse_storage_volumeattachment"><a class="anchor" href="#_kubernetes_and_suse_storage_volumeattachment"></a>Kubernetes and SUSE Storage <code>VolumeAttachment</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>To understand how volume attachments work in SUSE Storage, it is important to distinguish between <code>VolumeAttachment</code> of Kubernetes and custom <code>VolumeAttachment</code> of SUSE Storage:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Kubernetes <code>VolumeAttachment</code></strong>: This is a native Kubernetes API resource that is part of the Container Storage Interface (CSI) specification. Its primary role is to signal a CSI driver that a volume should be attached to a specific node.</p>
</li>
<li>
<p><strong>SUSE Storage <code>VolumeAttachment</code></strong>: This is a Custom Resource (CR) defined by SUSE Storage, with the full name <code>volumeattachment.longhorn.io</code>. This internal SUSE Storage resource is used by the Longhorn Manager to track and manage all attachment requests for a volume.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_suse_storage_volumeattachment"><a class="anchor" href="#_suse_storage_volumeattachment"></a>SUSE Storage <code>VolumeAttachment</code></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_volumeattachment_cr"><a class="anchor" href="#_volumeattachment_cr"></a><code>VolumeAttachment</code> CR</h3>
<div class="paragraph">
<p>To retrieve a SUSE Storage <code>VolumeAttachment</code> CR, use the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">kubectl -n longhorn-system get volumeattachment.longhorn.io &lt;volume-name&gt; -o yaml</code></pre>
</div>
</div>
<div class="paragraph">
<p>Example Output:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: v1
...
  spec:
    attachmentTickets:
      csi-f0471a334f0b249f964cd1dec461a5eb94c8d268cbbc904c1a8e9a37e2045208:
        generation: 0
        id: csi-f0471a334f0b249f964cd1dec461a5eb94c8d268cbbc904c1a8e9a37e2045208
        nodeID: rancher60-master
        parameters:
          disableFrontend: "false"
          lastAttachedBy: ""
        type: csi-attacher
    volume: pvc-b26e9514-aafd-46e0-b70c-4e3f187c7977
  status:
    attachmentTicketStatuses:
      csi-f0471a334f0b249f964cd1dec461a5eb94c8d268cbbc904c1a8e9a37e2045208:
        conditions:
        - lastProbeTime: ""
          lastTransitionTime: "2025-07-05T09:17:27Z"
          message: ""
          reason: ""
          status: "True"
          type: Satisfied
        generation: 0
        id: csi-f0471a334f0b249f964cd1dec461a5eb94c8d268cbbc904c1a8e9a37e2045208
        satisfied: true
...</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>spec.attachmentTickets</code>: A map containing all active attachment requests, also known as <strong>tickets</strong>. Each ticket includes:</p>
<div class="ulist">
<ul>
<li>
<p><code>id</code>: A unique identifier for the attachment ticket.</p>
</li>
<li>
<p><code>nodeID</code>: The ID of the node where the volume should be attached.</p>
</li>
<li>
<p><code>parameters</code>: Optional parameters for the attachment, such as <code>disableFrontend</code> and <code>lastAttachedBy</code>.</p>
</li>
<li>
<p><code>type</code>: The attacher type, indicating the source of the attachment request.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>status.attachmentTicketStatuses</code>: A map containing the current status of each active attachment ticket or request. Each entry includes:</p>
<div class="ulist">
<ul>
<li>
<p><code>conditions</code>: The current condition(s) of the ticket, including whether the request is satisfied.</p>
</li>
<li>
<p><code>satisfied</code>: A boolean value indicating whether the attachment request has been fulfilled.</p>
</li>
<li>
<p><code>generation</code>: The generation number of the ticket, used to track updates.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_understanding_attachment_tickets"><a class="anchor" href="#_understanding_attachment_tickets"></a>Understanding Attachment Tickets</h3>
<div class="paragraph">
<p>The SUSE Storage <code>VolumeAttachment</code> custom resource (CR) manages attachment requests from various internal SUSE Storage system controllers. Each request is represented as an <strong>attachment ticket</strong> within the CR.</p>
</div>
<div class="paragraph">
<p>All active tickets are stored in the <code>spec.attachmentTickets</code> map. The <code>type</code> field in each ticket (referred to as the <strong>AttacherType</strong>) identifies the source of the request. Common <code>AttacherType</code> values include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>csi-attacher</code>: The most common type, handling standard attachment requests from the Kubernetes CSI plugin, typically when mounting a volume to a pod.</p>
</li>
<li>
<p><code>longhorn-api</code>: Represents a manual attachment request initiated by a user through the SUSE Storage UI or API.</p>
</li>
<li>
<p><code>snapshot-controller</code>: Used when attaching a volume to create or restore a snapshot.</p>
</li>
<li>
<p><code>backup-controller</code>: Used when attaching a volume to perform a backup.</p>
</li>
<li>
<p><code>volume-restore-controller</code>: Used when attaching a volume during a restore operation.</p>
</li>
<li>
<p><code>volume-clone-controller</code>: Used when attaching a volume for cloning from an existing volume.</p>
</li>
<li>
<p><code>share-manager-controller</code>: Manages backend volume attachments for ReadWriteMany (RWX) volumes by attaching them to the share-manager pod.</p>
</li>
<li>
<p><code>volume-expansion-controller</code>: Handles attachments needed for online volume expansion.</p>
</li>
<li>
<p><code>volume-rebuilding-controller</code>: Used when attaching a volume to rebuild a degraded or missing replica.</p>
</li>
<li>
<p><code>salvage-controller</code>: Used during the salvage process when SUSE Storage attempts to recover and reattach a problematic volume.</p>
</li>
<li>
<p><code>volume-eviction-controller</code>: Handles attachments involved in evicting a replica from a node.</p>
</li>
<li>
<p><code>bim-ds-controller</code>: Used by the Backing Image Data Source controller when creating a volume from a backing image.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_csi_attachment_and_detachment_workflow"><a class="anchor" href="#_the_csi_attachment_and_detachment_workflow"></a>The CSI Attachment and Detachment Workflow</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To understand how SUSE Storage integrates with Kubernetes, it is important to examine how the native Kubernetes <code>VolumeAttachment</code> resource and the SUSE Storage custom <code>VolumeAttachment</code> CR interact through the CSI interface.</p>
</div>
<div class="sect2">
<h3 id="_core_components_in_the_workflow"><a class="anchor" href="#_core_components_in_the_workflow"></a>Core Components in the Workflow</h3>
<div class="paragraph">
<p>In addition to the Kubernetes and SUSE Storage <code>VolumeAttachment</code> objects, several key components work together to manage volume attachment and detachment:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>external-attacher</code>: A CSI sidecar container that monitors Kubernetes <code>VolumeAttachment</code> objects and triggers <code>ControllerPublishVolume</code> or <code>ControllerUnpublishVolume</code> gRPC calls to the Longhorn CSI driver.</p>
</li>
<li>
<p><code>longhorn-csi-plugin</code>: The Longhorn CSI driver that implements the required CSI gRPC services.</p>
</li>
<li>
<p><code>longhorn-manager</code>: The central controller in SUSE Storage that manages the full lifecycle of Longhorn volumes. It includes various sub-controllers, including the volume attachment logic.</p>
</li>
<li>
<p><code>longhorn-volume-attachment-controller</code>: A sub-controller within <code>longhorn-manager</code> that monitors the SUSE Storage <code>VolumeAttachment</code> CR and performs attach or detach operations based on its spec.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_the_csi_volume_attachment_flow"><a class="anchor" href="#_the_csi_volume_attachment_flow"></a>The CSI Volume Attachment Flow</h3>
<div class="paragraph">
<p>When a pod that uses a Longhorn PersistentVolumeClaim (PVC) is scheduled onto a node, the CSI volume attachment workflow begins.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Kubelet Request</strong>: The kubelet on the target node detects that a Longhorn volume needs to be mounted and notifies the Kubernetes <code>attach-detach-controller</code>.</p>
</li>
<li>
<p><strong>Kubernetes <code>VolumeAttachment</code> Creation</strong>: The <code>attach-detach-controller</code> creates a Kubernetes <code>VolumeAttachment</code> object, specifying the Longhorn CSI driver (<code>driver.longhorn.io</code>), the target node name, and the persistent volume name.</p>
</li>
<li>
<p><strong><code>external-attacher</code> Triggers CSI Call</strong>: The <code>external-attacher</code> sidecar container observes the new Kubernetes <code>VolumeAttachment</code> object and issues a <code>ControllerPublishVolume</code> gRPC call to the <code>longhorn-csi-plugin</code>.</p>
</li>
<li>
<p><strong>Longhorn <code>VolumeAttachment</code> CR Creation</strong>: Rather than attaching the volume directly, the <code>longhorn-csi-plugin</code> creates a Longhorn <code>VolumeAttachment</code> custom resource (CR). It adds an <strong>attachment ticket</strong> to the spec of CR to represent the attachment request.</p>
</li>
<li>
<p><strong>Longhorn Controller Reconciliation</strong>: The <code>longhorn-volume-attachment-controller</code>, a sub-controller within <code>longhorn-manager</code>, detects the new ticket and begins reconciliation. It verifies that the volume is available and updates the <code>spec.nodeID</code> field of the corresponding Volume CR with the target node name.</p>
</li>
<li>
<p><strong><code>longhorn-manager</code> Executes Attachment</strong>: After detecting that <code>spec.nodeID</code> is set, <code>longhorn-manager</code> starts the Longhorn Engine on the specified node to complete the attachment.</p>
</li>
<li>
<p><strong>Volume Attachment Completion</strong>:</p>
<div class="ulist">
<ul>
<li>
<p><code>longhorn-manager</code> updates the status of the Volume CR to reflect that the volume is attached.</p>
</li>
<li>
<p>The <code>longhorn-volume-attachment-controller</code> updates the status of the Longhorn <code>VolumeAttachment</code> CR to indicate success.</p>
</li>
<li>
<p>The <code>longhorn-csi-plugin</code> receives the successful status and responds to the <code>external-attacher</code>.</p>
</li>
<li>
<p>Finally, the <code>external-attacher</code> marks the <code>status.attached</code> field of the Kubernetes <code>VolumeAttachment</code> object as <code>true</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Kubelet Mounts the Volume</strong>: Once the volume is marked as attached, the kubelet proceeds with the <code>NodeStageVolume</code> and <code>NodePublishVolume</code> CSI calls to mount the volume into the pod’s container.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_the_csi_volume_detachment_flow"><a class="anchor" href="#_the_csi_volume_detachment_flow"></a>The CSI Volume Detachment Flow</h3>
<div class="paragraph">
<p>When a pod using a Longhorn volume is deleted or rescheduled, the CSI detachment workflow begins.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Kubelet Request</strong>: The kubelet signals to the Kubernetes <code>attach-detach-controller</code> that the volume is no longer needed on the node.</p>
</li>
<li>
<p><strong>Kubernetes <code>VolumeAttachment</code> Deletion</strong>: The <code>attach-detach-controller</code> deletes the corresponding Kubernetes <code>VolumeAttachment</code> object.</p>
</li>
<li>
<p><strong><code>external-attacher</code> Triggers CSI Call</strong>: The <code>external-attacher</code> observes the deletion and initiates a <code>ControllerUnpublishVolume</code> gRPC call to the <code>longhorn-csi-plugin</code>.</p>
</li>
<li>
<p><strong>Attachment Ticket Removal</strong>: The <code>longhorn-csi-plugin</code> processes the request by updating the SUSE Storage <code>VolumeAttachment</code> CR to remove the relevant attachment ticket.</p>
</li>
<li>
<p><strong>Longhorn Controller Reconciliation</strong>: The <code>longhorn-volume-attachment-controller</code> detects that the ticket has been removed. If no other tickets exist for the volume, it clears the <code>spec.nodeID</code> field in the Longhorn Volume CR.</p>
</li>
<li>
<p><strong><code>longhorn-manager</code> Executes Detachment</strong>: With the <code>spec.nodeID</code> cleared, <code>longhorn-manager</code> initiates the detachment process by stopping the Longhorn Engine on the node.</p>
</li>
<li>
<p><strong>Volume Detachment Completion</strong>:</p>
<div class="ulist">
<ul>
<li>
<p><code>longhorn-manager</code> updates the status of the Volume CR to indicate that the volume is detached.</p>
</li>
<li>
<p>The <code>longhorn-csi-plugin</code> receives confirmation and responds with success to the <code>external-attacher</code>.</p>
</li>
<li>
<p>The <code>external-attacher</code> removes the finalizer from the Kubernetes <code>VolumeAttachment</code> object, allowing the API server to fully delete it.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_summary_of_the_workflow"><a class="anchor" href="#_summary_of_the_workflow"></a>Summary of the Workflow</h3>
<div class="paragraph">
<p>SUSE Storage extends the native volume attachment mechanism of Kubernetes by introducing a custom <code>VolumeAttachment</code> CR. This design provides several advantages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Decoupling and Abstraction</strong>: The custom resource encapsulates complex attach or detach logic within SUSE Storage, reducing the responsibilities of the <code>longhorn-csi-plugin</code>.</p>
</li>
<li>
<p><strong>Fine-Grained Control</strong>: The attachment ticket system enables SUSE Storage to handle requests from multiple sources (for example, pods, snapshots, backups) while ensuring only one valid attachment per volume at any time.</p>
</li>
<li>
<p><strong>Observability and Troubleshooting</strong>: The CR provides clear visibility into the volume&#8217;s attachment state and history, simplifying monitoring and troubleshooting.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In summary, the Kubernetes <code>VolumeAttachment</code> object initiates the attachment or detachment process, while SUSE Storage&#8217;s custom <code>VolumeAttachment</code> CR orchestrates and manages the actual operations internally.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_troubleshooting_volume_attachment_issues"><a class="anchor" href="#_troubleshooting_volume_attachment_issues"></a>Troubleshooting Volume Attachment Issues</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section outlines common issues related to volume attachment and provides recommended resolution steps. Before making any changes, carefully inspect system logs and relevant custom resources to avoid disrupting active workloads.</p>
</div>
<div class="sect2">
<h3 id="_volume_is_stuck_in_attaching_or_detaching_state"><a class="anchor" href="#_volume_is_stuck_in_attaching_or_detaching_state"></a>Volume is Stuck in <code>Attaching</code> or <code>Detaching</code> State</h3>
<div class="paragraph">
<p>When a volume remains in the <code>Attaching</code> or <code>Detaching</code> state for an extended period, the cause is often related to stale or conflicting attachment tickets in the SUSE Storage <code>VolumeAttachment</code> CR.</p>
</div>
<div class="sect3">
<h4 id="_possible_causes"><a class="anchor" href="#_possible_causes"></a>Possible Causes</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Stale or Orphaned Tickets</strong>: A ticket from a previous workload (for example, a deleted pod or completed backup job) was not properly removed and still exists under <code>spec.attachmentTickets</code>.</p>
</li>
<li>
<p><strong>Conflicting Tickets</strong>: An existing ticket (for example, from the CSI attacher) blocks a new request (for example, a manual detach or move to a different node).</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_resolution_steps"><a class="anchor" href="#_resolution_steps"></a>Resolution Steps</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Inspect the SUSE Storage <code>VolumeAttachment</code> CR</strong>: Use the following command to view the attachment tickets:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">kubectl -n longhorn-system get volumeattachment.longhorn.io &lt;volume-name&gt; -o yaml</code></pre>
</div>
</div>
</li>
<li>
<p><strong>Analyze Ticket Sources</strong>: Look under <code>spec.attachmentTickets</code> and check the <code>type</code> field for each ticket to identify its source (for example, <code>csi-attacher</code>, <code>backup-controller</code>, etc.).</p>
</li>
<li>
<p><strong>Remove Invalid Tickets with Caution</strong>: If you confirm a ticket is no longer needed (for example, its corresponding pod has been deleted), you may remove it by editing the CR.</p>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Deleting an active ticket can cause serious disruptions. If you remove a ticket still required by a running workload, SUSE Storage interprets this as a detach request:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The volume engine will stop on the node, causing the pod to lose storage access and encounter input-output errors, likely crashing the pod.</p>
</li>
<li>
<p>Kubernetes CSI will eventually detect the issue and re-attach the volume, recreating the ticket, but this causes downtime and may require manual pod restart.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Always verify that the workload related to the ticket is inactive before removing it.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p><strong>Verify the State</strong>: After removing invalid tickets, SUSE Storage should be able to complete the attach or detach operation successfully.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_case_study"><a class="anchor" href="#_case_study"></a>Case Study</h3>
<div class="sect3">
<h4 id="_case_1_failure_to_attach_volume_due_to_unexpected_longhorn_ui_attachment_ticket"><a class="anchor" href="#_case_1_failure_to_attach_volume_due_to_unexpected_longhorn_ui_attachment_ticket"></a>Case 1: Failure to Attach Volume Due to Unexpected <code>longhorn-ui</code> Attachment Ticket</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Issue</strong>: <a href="https://github.com/longhorn/longhorn/issues/8339">#8339</a></p>
</li>
<li>
<p><strong>Symptom</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Workloads using the affected volume remain stuck in <code>Pending</code> state.</p>
</li>
<li>
<p>The SUSE Storage <code>VolumeAttachment</code> CR contains an unexpected ticket from <code>longhorn-ui</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Workaround</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Inspect the <code>VolumeAttachment</code> CR:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">kubectl -n longhorn-system get volumeattachment.longhorn.io &lt;volume-name&gt; -o yaml</code></pre>
</div>
</div>
</li>
<li>
<p>If you find a <code>longhorn-ui</code> attachment ticket, remove the entire ticket block from the CR.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_case_2_volume_fails_to_attach_to_new_node_due_to_backup_job_stuck_in_pending_state"><a class="anchor" href="#_case_2_volume_fails_to_attach_to_new_node_due_to_backup_job_stuck_in_pending_state"></a>Case 2: Volume Fails to Attach to New Node Due to Backup Job Stuck in Pending State</h4>
<div class="ulist">
<ul>
<li>
<p><strong>Issue</strong>: <a href="https://github.com/longhorn/longhorn/issues/10090">#10090</a></p>
</li>
<li>
<p><strong>Symptom</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>When a workload is rescheduled to a different node, the volume fails to follow.</p>
</li>
<li>
<p>Backup jobs referencing non-existent snapshots remain stuck in <code>Pending</code> state, with <code>status.message</code> containing <code>failed to get the snapshot &#8230;&#8203; not found</code>.</p>
</li>
<li>
<p>These stuck backup jobs hold onto the volume, blocking detach or reattach.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Workaround</strong>:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Check the SUSE Storage <code>VolumeAttachment</code> CR for any tickets locking the volume:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">kubectl -n longhorn-system get volumeattachment.longhorn.io &lt;volume-name&gt; -o yaml</code></pre>
</div>
</div>
</li>
<li>
<p>If you see a ticket from the backup controller, a backup job is locking the volume.</p>
</li>
<li>
<p><strong>Do not delete the <code>backup-*</code> attachment ticket directly</strong>, as SUSE Storage will recreate it.</p>
</li>
<li>
<p>Instead, resolve the stuck backup job by removing any <code>Backup</code> CRs with:</p>
<div class="ulist">
<ul>
<li>
<p><code>status.state = pending</code></p>
</li>
<li>
<p><code>status.message</code> containing <code>Failed to get the Snapshot&#8230;&#8203;</code></p>
<div class="paragraph">
<p>This releases the volume and allows it to be reattached.</p>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="volume-expansion.html">Volume Expansion</a></span>
  <span class="next"><a href="trim-filesystem.html">Trim the Filesystem</a></span>
</nav>
</article>
  </div>
</main>
</div>
<script src="../../../../_/js/site.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
<script src="../../../../_/js/vendor/lunr.js"></script>
<script src="../../../../_/js/vendor/lunr-languages.js"></script>
<script src="../../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../../.." data-snippet-length="100" data-stylesheet="../../../../_/css/search.css"></script>
<script async src="../../../../search-index.js"></script>
<script src="../../../../_/js/vendor/langSelection.js"></script>
<script async src="../../../../_/js/vendor/tabs.js"></script>


<script src="../../../../_/js/CNLanguageSwitcher.js"></script>
  </body>
</html>
