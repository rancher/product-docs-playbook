<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
<title>Virtual Machine Issues | SUSE® Virtualization  v1.6 (Latest)</title>
    <link rel="canonical" href="https://documentation.suse.com/cloudnative/virtualization/v1.6/en/troubleshooting/virtual-machines.html">
    <link rel="prev" href="cluster.html">
    <link rel="next" href="monitoring.html">
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../../../../_/css/site.css">
<meta http-equiv="last-modified" content="2025-12-05"/>
<link rel="stylesheet" href="../../../../_/css/search.css">
<link rel="icon" href="../../../../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="../../../../_/css/font-styles.css">
<link rel="stylesheet" href="../../../../_/fonts/css/all.css">
<link rel="stylesheet" href="../../../../_/css/site-extra.css">
<link rel="stylesheet" href="../../../../_/css/vendor/tabs.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=SUSE:wght@100..800&display=swap&family=SUSE+Mono:ital,wght@0,100..800;1,100..800" rel="stylesheet">
<link href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css" rel="stylesheet">
<link rel="stylesheet" href="../../../../_/css/vendor/light.css">
<script src="/docserv/res/lightheaded/analytics.js" type="text/javascript"></script>
<script type="module">
  import { defineCustomElements, setAssetPath } from 'https://d12w0ryu9hjsx8.cloudfront.net/shared-header/1.10/shared-header.esm.js';
  defineCustomElements();
  setAssetPath("https://d12w0ryu9hjsx8.cloudfront.net/shared-header/1.10/assets");
</script>
<!-- Default English link -->
<link href="https://documentation.suse.com/cloudnative/virtualization/v1.6/en/troubleshooting/virtual-machines.html" hreflang="x-default" rel="alternate"/>
<!-- Link for the currently processed page -->
<link href="https://documentation.suse.com/cloudnative/virtualization/v1.6/en/troubleshooting/virtual-machines.html" hrefLang="en-US" rel="alternate" />

<!-- JSON-LD for doc metadata -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "TechArticle",
  "name": "Virtual Machine Issues | SUSE Virtualization v1.6",
  "headline": "Virtual Machine Issues",
  "description": "Virtual Machine Issues",
  "inLanguage": "en",
  "dateModified": "2025-12-05T00:00:00Z",
  "author": {
    "@type": "Organization",
    "name": "SUSE Product & Solution Documentation Team",
    "url": "https://documentation.suse.com"
  },
  "mentions": [
    {
      "@type": "SoftwareApplication",
      "name": "SUSE Virtualization",
      "softwareVersion": "v1.6",
      "applicationCategory": "Cloud Infrastructure",
      "operatingSystem": "Linux"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "SUSE",
    "url": "https://documentation.suse.com",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
    }
  }
}
</script>
<!-- end JSON-LD for doc metadata -->
    <script>var uiRootPath = '../../../../_'</script>
  </head>
  <body class="article">
<script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs'; mermaid.initialize({"startOnLoad":true});</script><shared-header
language="en"
languages='{
    "en": { "label": "English", "url": "https://documentation.suse.com/en-us/" },
    "de": { "label": "Deutsch", "url": "https://documentation.suse.com/de-de/" },
    "fr": { "label": "Français", "url": "https://documentation.suse.com/fr-fr/" },
    "es": { "label": "Español", "url": "https://documentation.suse.com/es-es/" },
    "zh_CN": { "label": "中文", "url": "https://documentation.suse.com/zh-cn/" },
    "pt_BR": { "label": "Português Brasileiro", "url": "https://documentation.suse.com/pt-br/" }
}'
enable-search='false'>
</shared-header>

<!-- Leaving as a comment, I expect it will be required again next year.
<a target=_blank"" class="survey-link" href="https://suselinux.fra1.qualtrics.com/jfe/form/SV_bEiGZbUNzLD8Tcy"> Documentation survey </a>
--><div class="body">
<div class="nav-container" data-component="virtualization" data-version="v1.6">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title">SUSE® Virtualization</h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Introduction</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/overview.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/deploy-ha-cluster.html">Deploy a High-Availability Cluster</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/deploy-singlenode-cluster.html">Deploy a Single-Node Cluster</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/glossary.html">Glossary</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../introduction/document-conventions.html">Document Conventions</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Installation and Setup</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../installation-setup/requirements.html">Hardware and Network Requirements</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Installation Media</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../installation-setup/media/net-install.html">Net Install ISO</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../installation-setup/media/install-binaries-mode.html">Install Binaries Only</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Installation Methods</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../installation-setup/methods/iso-install.html">ISO Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../installation-setup/methods/usb-install.html">USB Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../installation-setup/methods/pxe-boot-install.html">PXE Boot Installation</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Configuration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../installation-setup/config/configuration-file.html">Configuration File</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../installation-setup/config/update-configuration.html">Update the Configuration After Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../installation-setup/config/settings.html">Settings</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../installation-setup/config/cloudinitcrd.html">CloudInit CRD</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../installation-setup/post-installation.html">Post-Installation Tasks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../installation-setup/management-address.html">Management Address</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../installation-setup/external-disk.html">External Disk Support</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../installation-setup/authentication.html">Authentication</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../installation-setup/airgap.html">Air-Gapped Environment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../installation-setup/single-node-clusters.html">Single-Node Clusters</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Upgrades</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../upgrades/upgrades.html">Upgrades</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../upgrades/v1-1-2-to-v1-2-0.html">Upgrade from v1.1.2 to v1.2.0 (not recommended)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../upgrades/v1-2-0-to-v1-2-1.html">Upgrade from v1.1.2/v1.1.3/v1.2.0 to v1.2.1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../upgrades/v1-2-1-to-v1-2-2.html">Upgrade from v1.2.1 to v1.2.2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../upgrades/v1-2-2-to-v1-3-1.html">Upgrade from v1.2.2/v1.3.0 to v1.3.1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../upgrades/v1-3-1-to-v1-3-2.html">Upgrade from v1.3.1 to v1.3.2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../upgrades/v1-3-2-to-v1-4-0.html">Upgrade from v1.3.2 to v1.4.0</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../upgrades/v1-4-0-to-v1-4-1.html">Upgrade from v1.4.0 to v1.4.1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../upgrades/v1-4-1-to-v1-4-2.html">Upgrade from v1.4.1 to v1.4.2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../upgrades/v1-4-1-to-v1-4-3.html">Upgrade from v1.4.1 or v1.4.2 to v1.4.3</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../upgrades/v1-4-2-to-v1-5-0.html">Upgrade from v1.4.2 or v1.4.3 to v1.5.0</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../upgrades/v1-4-2-to-v1-5-1.html">Upgrade from v1.4.2 or v1.4.3 to v1.5.1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../upgrades/v1-4-2-to-v1-5-2.html">Upgrade from v1.4.2 or v1.4.3 to v1.5.2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../upgrades/v1-5-0-to-v1-5-1.html">Upgrade from v1.5.0 to v1.5.1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../upgrades/v1-5-0-to-v1-5-2.html">Upgrade from v1.5.0 or v1.5.1 to v1.5.2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../upgrades/v1-5-x-to-v1-6-x.html">Upgrade from v1.5.x to v1.6.x</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../upgrades/v1-6-x-to-v1-6-y.html">Upgrade from v1.6.x to v1.6.y</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../upgrades/troubleshooting.html">Troubleshooting</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Hosts</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hosts/hosts.html">Host Management</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hosts/witness-node.html">Witness Node</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../hosts/vgpu-support.html">vGPU Support</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Virtual Machines</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../virtual-machines/virtual-machines.html">Virtual Machines</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Virtual Machine Images</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../virtual-machines/vm-images/upload-image.html">Upload Images</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../virtual-machines/vm-images/custom-suse-images.html">Custom SUSE Virtual Machine Images</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../virtual-machines/vm-images/image-security.html">Image Security</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../virtual-machines/create-vm.html">Create a Virtual Machine</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../virtual-machines/create-windows-vm.html">Create a Windows Virtual Machine</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../virtual-machines/edit-vm.html">Edit a Virtual Machine</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../virtual-machines/access-vm.html">Access to the Virtual Machine</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../virtual-machines/clone-vm.html">Clone a Virtual Machine</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../virtual-machines/backup-restore.html">Virtual Machine Backup, Snapshot &amp; Restore</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../virtual-machines/live-migration.html">Live Migration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../virtual-machines/hotplug-volume.html">Hot-Plug Volumes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../virtual-machines/resource-overcommit.html">Resource Overcommit</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../virtual-machines/cpu-pinning.html">CPU Pinning</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../virtual-machines/cpu-memory-hotplug.html">CPU and Memory Hotplug</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Storage</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Volumes</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../storage/volumes/create-volume.html">Create a Volume</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../storage/volumes/edit-volume.html">Edit a Volume</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../storage/volumes/clone-volume.html">Clone a Volume</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../storage/volumes/export-volume.html">Export a Volume to Image</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../storage/volumes/volume-snapshots.html">Volume Snapshots</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../storage/volumes/volume-security.html">Volume Security</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../storage/storageclass.html">StorageClass</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../storage/csidriver.html">Third-Party Storage Support</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../storage/longhorn-v2-data-engine.html">Longhorn V2 Data Engine</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Networking</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../networking/cluster-network.html">Cluster Network</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../networking/vm-network.html">VM Network</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../networking/deep-dive.html">Networking Deep Dive</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../networking/load-balancer.html">Load Balancer</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../networking/ip-pool.html">IP Pool</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../networking/storage-network.html">Storage Network</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../networking/vm-migration-network.html">VM Migration Network</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../networking/kubeovn-vpc.html">Virtual Private Cloud</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../networking/vm-isolation.html">Virtual Machine Isolation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../networking/best-practices.html">Networking Best Practices</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Observability</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../observability/logging.html">Logging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../observability/monitoring.html">Monitoring</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Add-ons</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../add-ons/add-ons.html">Add-ons</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../add-ons/harvester-seeder.html">Harvester Seeder</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../add-ons/kubeovn-operator.html">Kube-OVN Operator (Experimental)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../add-ons/lvm-local-storage.html">CSI Driver LVM (Experimental)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../add-ons/nvidia-driver-toolkit.html">NVIDIA Driver Toolkit</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../add-ons/pcidevices-controller.html">PCI Devices Controller</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../add-ons/rancher-vcluster.html">Rancher vCluster (Experimental)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../add-ons/vm-dhcp-controller.html">VM DHCP Controller (Experimental)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../add-ons/vm-import-controller.html">VM Import Controller</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Integrations</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Rancher Integration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../integrations/rancher/rancher-integration.html">SUSE Rancher Prime Integration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../integrations/rancher/virtualization-management.html">Virtualization Management</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Node Driver</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../integrations/rancher/node-driver/node-driver.html">Harvester Node Driver</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../integrations/rancher/node-driver/rke2-cluster.html">Creating an RKE2 Kubernetes Cluster</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../integrations/rancher/node-driver/k3s-cluster.html">Creating a K3s Kubernetes Cluster</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../integrations/rancher/cloud-provider.html">Harvester Cloud Provider</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../integrations/rancher/csi-driver.html">Harvester CSI Driver</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../integrations/rancher/resource-quota.html">Resource Quotas</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../integrations/rancher/rancher-terraform-provider.html">Rancher Terraform</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../integrations/rancher/import-vm.html">Import a Cluster Built on a SUSE® Virtualization VM</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../integrations/rancher/harvester-ui-extension.html">Harvester UI Extension</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../integrations/terraform/terraform-provider.html">Terraform Provider</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Troubleshooting</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="installation.html">Installation Issues</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="operating-system.html">Operating System Issues</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="cluster.html">Cluster Issues</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="virtual-machines.html">Virtual Machine Issues</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="monitoring.html">Monitoring Issues</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="logging.html">Logging Issues</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="rancher.html">Rancher Issues</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="faq.html">FAQ</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Developer Content</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../developer/addon-development.html">Add-on Development Guide</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../api.html">API</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">SUSE® Virtualization</span>
    <span class="version">v1.6 (Latest)</span>
  </div>
  <ul class="components">
        <li class="component">
          <div class="title"><a href="../../../../admission-controller/1.31/en/introduction.html">Admission Controller</a></div>
          <ul class="versions">
            <li class="version">
              <a href="../../../../admission-controller/1.32/en/introduction.html">1.32-dev</a>
            </li>
            <li class="version is-latest">
              <a href="../../../../admission-controller/1.31/en/introduction.html">1.31-latest</a>
            </li>
            <li class="version">
              <a href="../../../../admission-controller/1.30/en/introduction.html">1.30</a>
            </li>
            <li class="version">
              <a href="../../../../admission-controller/1.29/en/introduction.html">1.29</a>
            </li>
            <li class="version">
              <a href="../../../../admission-controller/1.28/en/introduction.html">1.28</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../cluster-api/v0.25/en/index.html">Cluster API</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../cluster-api/v0.25/en/index.html">0.25</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.24/en/index.html">0.24</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.23/en/index.html">0.23</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.22/en/index.html">0.22</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.21/en/index.html">0.21</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.20/en/index.html">0.20</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.19/en/index.html">0.19</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.18/en/index.html">0.18</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.17/en/index.html">0.17</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.16/en/index.html">0.16</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.15/en/index.html">0.15</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.14/en/index.html">0.14</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.13/en/index.html">0.13</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.12/en/index.html">0.12</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.11/en/index.html">0.11</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../continuous-delivery/v0.14/en/index.html">Continuous Delivery</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../continuous-delivery/v0.14/en/index.html">0.14</a>
            </li>
            <li class="version">
              <a href="../../../../continuous-delivery/v0.13/en/index.html">0.13</a>
            </li>
            <li class="version">
              <a href="../../../../continuous-delivery/v0.12/en/index.html">0.12</a>
            </li>
            <li class="version">
              <a href="../../../../continuous-delivery/v0.11/en/index.html">0.11</a>
            </li>
            <li class="version">
              <a href="../../../../continuous-delivery/v0.10/en/index.html">0.10</a>
            </li>
            <li class="version">
              <a href="../../../../continuous-delivery/v0.9/en/index.html">0.9</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../k3s/latest/en/introduction.html">K3s</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../k3s/latest/en/introduction.html">Latest</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../os-manager/1.8/en/index.html">OS Manager</a></div>
          <ul class="versions">
            <li class="version">
              <a href="../../../../os-manager/1.9/en/index.html">1.9-dev</a>
            </li>
            <li class="version is-latest">
              <a href="../../../../os-manager/1.8/en/index.html">1.8</a>
            </li>
            <li class="version">
              <a href="../../../../os-manager/1.7/en/index.html">1.7</a>
            </li>
            <li class="version">
              <a href="../../../../os-manager/1.6/en/index.html">1.6</a>
            </li>
            <li class="version">
              <a href="../../../../os-manager/1.5/en/index.html">1.5</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../rke2/latest/en/introduction.html">RKE2</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../rke2/latest/en/introduction.html">Latest</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../suse-observability/latest/en/classic.html">SUSE Observability</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../suse-observability/latest/en/classic.html">Latest</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../rancher-srfa/latest/en/about-rancher/what-is-rancher.html">SUSE® Rancher for AWS</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../rancher-srfa/latest/en/about-rancher/what-is-rancher.html">Latest</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../rancher-manager/v2.13/en/about-rancher/what-is-rancher.html">SUSE® Rancher Manager</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../rancher-manager/v2.13/en/about-rancher/what-is-rancher.html">v2.13</a>
            </li>
            <li class="version">
              <a href="../../../../rancher-manager/v2.12/en/about-rancher/what-is-rancher.html">v2.12</a>
            </li>
            <li class="version">
              <a href="../../../../rancher-manager/v2.11/en/about-rancher/what-is-rancher.html">v2.11</a>
            </li>
            <li class="version">
              <a href="../../../../rancher-manager/v2.10/en/about-rancher/what-is-rancher.html">v2.10</a>
            </li>
            <li class="version">
              <a href="../../../../rancher-manager/v2.9/en/about-rancher/what-is-rancher.html">v2.9</a>
            </li>
            <li class="version">
              <a href="../../../../rancher-manager/v2.8/en/about-rancher/what-is-rancher.html">v2.8</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../security/5.4/en/overview.html">SUSE® Security</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../security/5.4/en/overview.html">5.4</a>
            </li>
            <li class="version">
              <a href="../../../../security/5.3/en/overview.html">5.3</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../storage/1.10/en/longhorn-documentation.html">SUSE® Storage</a></div>
          <ul class="versions">
            <li class="version">
              <a href="../../../../storage/1.11/en/longhorn-documentation.html">1.11 (Dev)</a>
            </li>
            <li class="version is-latest">
              <a href="../../../../storage/1.10/en/longhorn-documentation.html">1.10 (Latest)</a>
            </li>
            <li class="version">
              <a href="../../../../storage/1.9/en/longhorn-documentation.html">1.9</a>
            </li>
            <li class="version">
              <a href="../../../../storage/1.8/en/longhorn-documentation.html">1.8</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../suse-virtual-clusters/v1.0.1/en/introduction.html">SUSE® Virtual Clusters</a></div>
          <ul class="versions">
            <li class="version">
              <a href="../../../../suse-virtual-clusters/1.0.2/en/introduction.html">1.0.2-dev</a>
            </li>
            <li class="version is-latest">
              <a href="../../../../suse-virtual-clusters/v1.0.1/en/introduction.html">v1.0.1-latest</a>
            </li>
            <li class="version">
              <a href="../../../../suse-virtual-clusters/v1.0.0/en/introduction.html">v1.0.0</a>
            </li>
          </ul>
        </li>
        <li class="component is-current">
          <div class="title"><a href="../introduction/overview.html">SUSE® Virtualization</a></div>
          <ul class="versions">
            <li class="version">
              <a href="../../../v1.7/en/introduction/overview.html">v1.7 (Dev)</a>
            </li>
            <li class="version is-current is-latest">
              <a href="../introduction/overview.html">v1.6 (Latest)</a>
            </li>
            <li class="version">
              <a href="../../../v1.5/en/introduction/overview.html">v1.5</a>
            </li>
          </ul>
        </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
<ul>
    <li>
      <a class="home-link-dsc" href="https://documentation.suse.com/" title="documentation.suse.com" aria-label="SUSE Documentation Home"></a>
    </li>
    <li>
      <a href="https://documentation.suse.com/cloudnative/virtualization" title="SUSE Virtualization" aria-label="SUSE Documentation - SUSE Virtualization">
        SUSE Virtualization
      </a>
    </li>
      <li>
          Troubleshooting
      </li>
  </ul>
</nav><div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">v1.6 (Latest)</button>
  <div class="version-menu">
    <a class="version" href="../../../v1.7/en/troubleshooting/virtual-machines.html">v1.7 (Dev)</a>
    <a class="version is-current" href="virtual-machines.html">v1.6 (Latest)</a>
    <a class="version" href="../../../v1.5/en/troubleshooting/virtual-machines.html">v1.5</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/rancher/harvester-product-docs/edit/main/versions/v1.6/modules/en/pages/troubleshooting/virtual-machines.adoc"><strong>Edit</strong></a></div>
        <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <label class="visual-search-label-bc" for="search-input">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>
          <input label="Search" aria-label="Search" id="search-input" type="text" placeholder="Search the docs" >
          <label class="filter checkbox" style="display: none">
            <input type="checkbox" data-facet-filter="component:virtualization" checked> Only this project
          </label>
        </div>
      </div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="On this page" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Virtual Machine Issues</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The following sections contain information useful in troubleshooting issues related to SUSE Virtualization VM management.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vm_start_button_is_not_visible"><a class="anchor" href="#_vm_start_button_is_not_visible"></a>VM Start Button is Not Visible</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_issue_description"><a class="anchor" href="#_issue_description"></a>Issue Description</h3>
<div class="paragraph">
<p>On rare occasions, the <strong>Start</strong> button is unavailable on the SUSE Virtualization UI for VMs that are <em>Off</em>. Without that button, users are unable to start the VMs.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/troubleshooting/vm-start-button-is-not-visible.png" alt="vm start button is not visible">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_vm_general_operations"><a class="anchor" href="#_vm_general_operations"></a>VM General Operations</h3>
<div class="paragraph">
<p>On the SUSE Virtualization UI, the <strong>Stop</strong> button is visible after a VM is created and started.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/troubleshooting/stop-vm-from-webui.png" alt="stop vm from webui">
</div>
</div>
<div class="paragraph">
<p>The <strong>Start</strong> button is visible after the VM is stopped.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/troubleshooting/start-vm-after-vm-is-stopped-from-webui.png" alt="start vm after vm is stopped from webui">
</div>
</div>
<div class="paragraph">
<p>When the VM is powered off from inside the VM, both the <strong>Start</strong> and <strong>Restart</strong> buttons are visible.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/troubleshooting/actively-powered-off-vm.png" alt="actively powered off vm">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_general_vm_related_objects"><a class="anchor" href="#_general_vm_related_objects"></a>General VM Related Objects</h3>
<div class="sect3">
<h4 id="_a_running_vm"><a class="anchor" href="#_a_running_vm"></a>A Running VM</h4>
<div class="paragraph">
<p>The objects <code>vm</code>, <code>vmi</code>, and <code>pod</code>, which are all related to the VM, exist. The status of all three objects is <code>Running</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> # kubectl get vm
NAME   AGE     STATUS    READY
vm8    7m25s   Running   True

 # kubectl get vmi
NAME   AGE   PHASE     IP            NODENAME   READY
vm8    78s   Running   10.52.0.199   harv41     True

 # kubectl get pod
NAME                      READY   STATUS    RESTARTS   AGE
virt-launcher-vm8-tl46h   1/1     Running   0          80s</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_a_vm_stopped_using_the_suse_virtualization_ui"><a class="anchor" href="#_a_vm_stopped_using_the_suse_virtualization_ui"></a>A VM Stopped Using the SUSE Virtualization UI</h4>
<div class="paragraph">
<p>Only the object <code>vm</code> exists and its status is <code>Stopped</code>. Both <code>vmi</code> and <code>pod</code> disappear.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> # kubectl get vm
NAME   AGE    STATUS    READY
vm8    123m   Stopped   False

 # kubectl get vmi
No resources found in default namespace.

 # kubectl get pod
No resources found in default namespace.
 #</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_a_vm_stopped_using_the_vms_poweroff_command"><a class="anchor" href="#_a_vm_stopped_using_the_vms_poweroff_command"></a>A VM Stopped Using the VM&#8217;s Poweroff Command</h4>
<div class="paragraph">
<p>The objects <code>vm</code>, <code>vmi</code>, and <code>pod</code>, which are all related to the VM, exist. The status of <code>vm</code> is <code>Stopped</code>, while the status of <code>pod</code> is <code>Completed</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> # kubectl get vm
NAME   AGE    STATUS    READY
vm8    134m   Stopped   False

 # kubectl get vmi
NAME   AGE     PHASE       IP            NODENAME   READY
vm8    2m49s   Succeeded   10.52.0.199   harv41     False

 # kubectl get pod
NAME                      READY   STATUS      RESTARTS   AGE
virt-launcher-vm8-tl46h   0/1     Completed   0          2m54s</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_issue_analysis"><a class="anchor" href="#_issue_analysis"></a>Issue Analysis</h3>
<div class="paragraph">
<p>When the issue occurs, the objects <code>vm</code>, <code>vmi</code>, and <code>pod</code> exist. The status of the objects is similar to that of <strong>A VM Stopped Using the VM&#8217;s Poweroff Command</strong>.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="paragraph">
<p>The VM <code>ocffm031v000</code> is not ready (<code>status: "False"</code>) because the virt-launcher pod is terminating (<code>reason: "PodTerminating"</code>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre>- apiVersion: kubevirt.io/v1
  kind: VirtualMachine
...
  status:
    conditions:
    - lastProbeTime: "2023-07-20T08:37:37Z"
      lastTransitionTime: "2023-07-20T08:37:37Z"
      message: virt-launcher pod is terminating
      reason: PodTerminating
      status: "False"
      type: Ready</pre>
</div>
</div>
<div class="paragraph">
<p>Similarly, the VMI (virtual machine instance) <code>ocffm031v000</code> is not ready (<code>status: "False"</code>) because the virt-launcher pod is terminating (<code>reason: "PodTerminating"</code>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre>- apiVersion: kubevirt.io/v1
  kind: VirtualMachineInstance
...
    name: ocffm031v000
...
  status:
    activePods:
      ec36a1eb-84a5-4421-b57b-2c14c1975018: aibfredg02
    conditions:
    - lastProbeTime: "2023-07-20T08:37:37Z"
      lastTransitionTime: "2023-07-20T08:37:37Z"
      message: virt-launcher pod is terminating
      reason: PodTerminating
      status: "False"
      type: Ready</pre>
</div>
</div>
<div class="paragraph">
<p>On the other hand, the pod <code>virt-launcher-ocffm031v000-rrkss</code> is not ready (<code>status: "False"</code>) because the pod has run to completion (<code>reason: "PodCompleted"</code>).</p>
</div>
<div class="paragraph">
<p>The underlying container <code>0d7a0f64f91438cb78f026853e6bebf502df1bdeb64878d351fa5756edc98deb</code> is terminated, and the <code>exitCode</code> is 0.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>- apiVersion: v1
  kind: Pod
...
    name: virt-launcher-ocffm031v000-rrkss
...
    ownerReferences:
    - apiVersion: kubevirt.io/v1
...
      kind: VirtualMachineInstance
      name: ocffm031v000
      uid: 8d2cf524-7e73-4713-86f7-89e7399f25db
    uid: ec36a1eb-84a5-4421-b57b-2c14c1975018
...
  status:
    conditions:
    - lastProbeTime: "2023-07-18T13:48:56Z"
      lastTransitionTime: "2023-07-18T13:48:56Z"
      message: the virtual machine is not paused
      reason: NotPaused
      status: "True"
      type: kubevirt.io/virtual-machine-unpaused
    - lastProbeTime: "null"
      lastTransitionTime: "2023-07-18T13:48:55Z"
      reason: PodCompleted
      status: "True"
      type: Initialized
    - lastProbeTime: "null"
      lastTransitionTime: "2023-07-20T08:38:56Z"
      reason: PodCompleted
      status: "False"
      type: Ready
    - lastProbeTime: "null"
      lastTransitionTime: "2023-07-20T08:38:56Z"
      reason: PodCompleted
      status: "False"
      type: ContainersReady
...
    containerStatuses:
    - containerID: containerd://0d7a0f64f91438cb78f026853e6bebf502df1bdeb64878d351fa5756edc98deb
      image: registry.suse.com/suse/sles/15.4/virt-launcher:0.54.0-150400.3.3.2
      imageID: sha256:43bb08efdabb90913534b70ec7868a2126fc128887fb5c3c1b505ee6644453a2
      lastState: {}
      name: compute
      ready: false
      restartCount: 0
      started: false
      state:
        terminated:
          containerID: containerd://0d7a0f64f91438cb78f026853e6bebf502df1bdeb64878d351fa5756edc98deb
          exitCode: 0
          finishedAt: "2023-07-20T08:38:55Z"
          reason: Completed
          startedAt: "2023-07-18T13:50:17Z"</pre>
</div>
</div>
<div class="paragraph">
<p>A critical difference is that the <code>Stop</code> and <code>Start</code> actions appear in the <code>stateChangeRequests</code> property of <code>vm</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>  status:
    conditions:
...
    printableStatus: Stopped
    stateChangeRequests:
    - action: Stop
      uid: 8d2cf524-7e73-4713-86f7-89e7399f25db
    - action: Start</pre>
</div>
</div>
<div class="sect3">
<h4 id="_root_cause"><a class="anchor" href="#_root_cause"></a>Root Cause</h4>
<div class="paragraph">
<p>The root cause of this issue is under investigation.</p>
</div>
<div class="paragraph">
<p>It is notable that the <a href="https://github.com/harvester/harvester/blob/7357d0b660557566bf9ff2e83790635aea71d1bc/pkg/api/vm/formatter.go#L166">source code</a> checks the status of <code>vm</code> and assumes that the object is starting. No <code>Start</code> and <code>Restart</code> operations are added to the object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>func (vf *vmformatter) canStart(vm *kubevirtv1.VirtualMachine, vmi *kubevirtv1.VirtualMachineInstance) bool {
  if vf.isVMStarting(vm) {
    return false
  }
..
}

func (vf *vmformatter) canRestart(vm *kubevirtv1.VirtualMachine, vmi *kubevirtv1.VirtualMachineInstance) bool {
  if vf.isVMStarting(vm) {
    return false
  }
...
}

func (vf *vmformatter) isVMStarting(vm *kubevirtv1.VirtualMachine) bool {
  for _, req := range vm.Status.StateChangeRequests {
    if req.Action == kubevirtv1.StartRequest {
      return true
    }
  }
  return false
}</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_workaround"><a class="anchor" href="#_workaround"></a>Workaround</h3>
<div class="paragraph">
<p>To address the issue, you can force delete the pod using the command <code>kubectl delete pod virt-launcher-ocffm031v000-rrkss -n namespace --force</code>.</p>
</div>
<div class="paragraph">
<p>After the pod is successfully deleted, the <code>Start</code> button becomes visible again on the SUSE Virtualization UI.</p>
</div>
</div>
<div class="sect2">
<h3 id="_related_issue"><a class="anchor" href="#_related_issue"></a>Related Issue</h3>
<div class="paragraph">
<p><a href="https://github.com/harvester/harvester/issues/4659" class="bare">https://github.com/harvester/harvester/issues/4659</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_vm_stuck_in_starting_state_with_error_messsage_not_a_device_node"><a class="anchor" href="#_vm_stuck_in_starting_state_with_error_messsage_not_a_device_node"></a>VM Stuck in Starting State with Error Messsage <code>not a device node</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p><em>Impacted versions: v1.3.0</em></p>
</div>
<div class="sect2">
<h3 id="_issue_description_2"><a class="anchor" href="#_issue_description_2"></a>Issue Description</h3>
<div class="paragraph">
<p>Some VMs may fail to start and then become unresponsive after the cluster or some nodes are restarted. On the <strong>Dashboard</strong> screen of the SUSE Virtualization UI, the status of the affected VMs is stuck at <em>Starting</em>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/troubleshooting/vm-stuck-at-starting.png" alt="vm stuck at starting">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_issue_analysis_2"><a class="anchor" href="#_issue_analysis_2"></a>Issue Analysis</h3>
<div class="paragraph">
<p>The status of the pod related to the affected VM is <code>CreateContainerError</code>.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ kubectl get pods
NAME                      READY   STATUS                 RESTARTS   AGE
virt-launcher-vm1-w9bqs   0/2     CreateContainerError   0          9m39s</pre>
</div>
</div>
<div class="paragraph">
<p>The phrase <code>failed to generate spec: not a device node</code> can be found in the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$kubectl get pods -oyaml
apiVersion: v1
items:
  apiVersion: v1
  kind: Pod
  metadata:
...
    containerStatuses:
    - image: registry.suse.com/suse/sles/15.5/virt-launcher:1.1.0-150500.8.6.1
      imageID: ""
      lastState: {}
      name: compute
      ready: false
      restartCount: 0
      started: false
      state:
        waiting:
          message: 'failed to generate container "50f0ec402f6e266870eafb06611850a5a03b2a0a86fdd6e562959719ccc003b5"
            spec: failed to generate spec: not a device node'
          reason: CreateContainerError</pre>
</div>
</div>
<div class="paragraph">
<p><code>kubelet.log</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>file path: /var/lib/rancher/rke2/agent/logs/kubelet.log

E0205 20:44:31.683371    2837 pod_workers.go:1294] "Error syncing pod, skipping" err="failed to \"StartContainer\" for \"compute\" with CreateContainerError: \"failed t
o generate container \\\"255d42ec2e01d45b4e2480d538ecc21865cf461dc7056bc159a80ee68c411349\\\" spec: failed to generate spec: not a device node\"" pod="default/virt-laun
cher-caddytest-9tjzj" podUID=d512bf3e-f215-4128-960a-0658f7e63c7c</pre>
</div>
</div>
<div class="paragraph">
<p><code>containerd.log</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>file path: /var/lib/rancher/rke2/agent/containerd/containerd.log

time="2024-02-21T11:24:00.140298800Z" level=error msg="CreateContainer within sandbox \"850958f388e63f14a683380b3c52e57db35f21c059c0d93666f4fdaafe337e56\" for &amp;ContainerMetadata{Name:compute,Attempt:0,} failed" error="failed to generate container \"5ddad240be2731d5ea5210565729cca20e20694e364e72ba14b58127e231bc79\" spec: failed to generate spec: not a device node"</pre>
</div>
</div>
<div class="paragraph">
<p>After adding debug information to <code>containerd</code>, it identifies the error message <code>not a device node</code> is upon the file <code>pvc-3c1b28fb-*</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>time="2024-02-22T15:15:08.557487376Z" level=error msg="CreateContainer within sandbox \"d23af3219cb27228623cf8168ec27e64e836ed44f2b2f9cf784f0529a7f92e1e\" for &amp;ContainerMetadata{Name:compute,Attempt:0,} failed" error="failed to generate container \"e4ed94fb5e9145e8716bcb87aae448300799f345197d52a617918d634d9ca3e1\" spec: failed to generate spec: get device path: /var/lib/kubelet/plugins/kubernetes.io/csi/volumeDevices/publish/pvc-3c1b28fb-683e-4bf5-9869-c9107a0f1732/20291c6b-62c3-4456-be8a-fbeac118ec19 containerPath: /dev/disk-0 error: not a device node"</pre>
</div>
</div>
<div class="paragraph">
<p>This is a CSI related file, but it is an empty file instead of the expected device file. Then the containerd denied the <code>CreateContainer</code> request.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">$ ls /var/lib/kubelet/plugins/kubernetes.io/csi/volumeDevices/publish/pvc-3c1b28fb-683e-4bf5-9869-c9107a0f1732/ -alth
total 8.0K
drwxr-x--- 2 root root 4.0K Feb 22 15:10 .
-rw-r--r-- 1 root root    0 Feb 22 14:28 aa851da3-cee1-45be-a585-26ae766c16ca
-rw-r--r-- 1 root root    0 Feb 22 14:07 20291c6b-62c3-4456-be8a-fbeac118ec19
drwxr-x--- 4 root root 4.0K Feb 22 14:06 ..
-rw-r--r-- 1 root root    0 Feb 21 15:48 4333c9fd-c2c8-4da2-9b5a-1a310f80d9fd
-rw-r--r-- 1 root root    0 Feb 21 09:18 becc0687-b6f5-433e-bfb7-756b00deb61b

$file /var/lib/kubelet/plugins/kubernetes.io/csi/volumeDevices/publish/pvc-3c1b28fb-683e-4bf5-9869-c9107a0f1732/20291c6b-62c3-4456-be8a-fbeac118ec19
: empty</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output listed above directly contrasts with the following example, which shows the expected device file of a running VM.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ ls  /var/lib/kubelet/plugins/kubernetes.io/csi/volumeDevices/publish/pvc-732f8496-103b-4a08-83af-8325e1c314b7/ -alth
total 8.0K
drwxr-x--- 2 root root  4.0K Feb 21 10:53 .
drwxr-x--- 4 root root  4.0K Feb 21 10:53 ..
brw-rw---- 1 root root 8, 16 Feb 21 10:53 4883af80-c202-4529-a2c6-4e7f15fe5a9b</pre>
</div>
</div>
<div class="sect3">
<h4 id="_root_cause_2"><a class="anchor" href="#_root_cause_2"></a>Root Cause</h4>
<div class="paragraph">
<p>After the cluster or specific nodes are rebooted, the kubelet calls <code>NodePublishVolume</code> for the new pod without first calling <code>NodeStageVolume</code>. Moreover, the Longhorn CSI plugin bind mounts the regular file at the staging target path (previously used by the deleted pod) to the target path, and the operation is considered successful.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_workaround_2"><a class="anchor" href="#_workaround_2"></a>Workaround</h3>
<div class="paragraph">
<p>Cluster level operation:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Find the backing pods of the affected VMs and the related Longhorn volumes.</p>
<div class="listingblock">
<div class="content">
<pre> $ kubectl get pods
 NAME                      READY   STATUS                 RESTARTS   AGE
 virt-launcher-vm1-nxfm4   0/2     CreateContainerError   0          7m11s

 $ kubectl get pvc -A
 NAMESPACE                  NAME                       STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS           AGE
 default                    vm1-disk-0-9gc6h           Bound    pvc-f1798969-5b72-4d76-9f0e-64854af7b59c   1Gi        RWX            longhorn-image-fxsqr   7d22h</pre>
</div>
</div>
</li>
<li>
<p><a href="#_general_vm_related_objects">Stop</a> the affected VMs from SUSE Virtualization UI.</p>
<div class="paragraph">
<p>The VM may stuck in <code>Stopping</code>, continue the next step.</p>
</div>
</li>
<li>
<p>Delete the backing pods forcely.</p>
<div class="listingblock">
<div class="content">
<pre> $ kubectl delete pod virt-launcher-vm1-nxfm4 --force
 Warning: Immediate deletion does not wait for confirmation that the running resource has been terminated. The resource may continue to run on the cluster indefinitely.
 pod "virt-launcher-vm1-nxfm4" force deleted</pre>
</div>
</div>
<div class="paragraph">
<p>The VM is off now.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/troubleshooting/vm-is-off.png" alt="vm is off">
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Node level operation, node by node:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="../hosts/hosts.html#_cordoning_a_node" class="xref page">Cordon</a> a node.</p>
</li>
<li>
<p>Unmout all the affected Longhorn volumes in this node.</p>
<div class="paragraph">
<p>You need to ssh to this node and execute the <code>sudo -i umount path</code> command.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> $ umount /var/lib/kubelet/plugins/kubernetes.io/csi/volumeDevices/pvc-f1798969-5b72-4d76-9f0e-64854af7b59c/dev/*
 umount: /var/lib/kubelet/plugins/kubernetes.io/csi/volumeDevices/pvc-f1798969-5b72-4d76-9f0e-64854af7b59c/dev/4b2ab666-27bd-4e3c-a218-fb3d48a72e69: not mounted.
 umount: /var/lib/kubelet/plugins/kubernetes.io/csi/volumeDevices/pvc-f1798969-5b72-4d76-9f0e-64854af7b59c/dev/6aaf2bbe-f688-4dcd-855a-f9e2afa18862: not mounted.
 umount: /var/lib/kubelet/plugins/kubernetes.io/csi/volumeDevices/pvc-f1798969-5b72-4d76-9f0e-64854af7b59c/dev/91488f09-ff22-45f4-afc0-ca97f67555e7: not mounted.
 umount: /var/lib/kubelet/plugins/kubernetes.io/csi/volumeDevices/pvc-f1798969-5b72-4d76-9f0e-64854af7b59c/dev/bb4d0a15-737d-41c0-946c-85f4a56f072f: not mounted.
 umount: /var/lib/kubelet/plugins/kubernetes.io/csi/volumeDevices/pvc-f1798969-5b72-4d76-9f0e-64854af7b59c/dev/d2a54e32-4edc-4ad8-a748-f7ef7a2cacab: not mounted.</pre>
</div>
</div>
</li>
<li>
<p><a href="../hosts/hosts.html#_cordoning_a_node" class="xref page">Uncordon</a> this node.</p>
</li>
<li>
<p><a href="#_general_vm_related_objects">Start</a> the affected VMs from harvester UI.</p>
<div class="paragraph">
<p>Wait some time, the VM will run successfully.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../_images/troubleshooting/start-vm-and-run.png" alt="start vm and run">
</div>
</div>
<div class="paragraph">
<p>The newly generated csi file is an expected device file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> $ ls /var/lib/kubelet/plugins/kubernetes.io/csi/volumeDevices/publish/pvc-f1798969-5b72-4d76-9f0e-64854af7b59c/ -alth
 ...
 brw-rw---- 1 root root 8, 64 Mar  6 11:47 7beb531d-a781-4775-ba5e-8773773d77f1</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_related_issues"><a class="anchor" href="#_related_issues"></a>Related Issues</h3>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/harvester/harvester/issues/5109" class="bare">https://github.com/harvester/harvester/issues/5109</a></p>
</li>
<li>
<p><a href="https://github.com/longhorn/longhorn/issues/8009" class="bare">https://github.com/longhorn/longhorn/issues/8009</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_virtual_machine_ip_address_not_displayed"><a class="anchor" href="#_virtual_machine_ip_address_not_displayed"></a>Virtual Machine IP Address Not Displayed</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_the_qemu_guest_agent_package_is_not_installed"><a class="anchor" href="#_the_qemu_guest_agent_package_is_not_installed"></a>The <code>qemu-guest-agent</code> Package Is Not Installed</h3>
<div class="sect3">
<h4 id="_description"><a class="anchor" href="#_description"></a>Description</h4>
<div class="paragraph">
<p>The <strong>Virtual Machines</strong> screen on the SUSE Virtualization UI does not display the IP address of a newly created or imported virtual machine.</p>
</div>
</div>
<div class="sect3">
<h4 id="_analysis"><a class="anchor" href="#_analysis"></a>Analysis</h4>
<div class="paragraph">
<p>This issue usually occurs when the <code>qemu-guest-agent</code> package is not installed on the virtual machine. To determine if this is the root cause, check the status of the <code>VirtualMachineInstance</code> object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">$ kubectl get vmi -n &lt;NAMESPACE&gt; &lt;NAME&gt; -ojsonpath='{.status.interfaces[0].infoSource}'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The output does not contain the string <code>guest-agent</code> when the <code>qemu-guest-agent</code> package is not installed.</p>
</div>
</div>
<div class="sect3">
<h4 id="_workaround_3"><a class="anchor" href="#_workaround_3"></a>Workaround</h4>
<div class="paragraph">
<p>You can <a href="../virtual-machines/create-vm.html#_installing_the_qemu_guest_agent" class="xref page">install the QEMU guest agent</a> by editing the virtual machine configuration.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>On the SUSE Virtualization UI, go to <strong>Virtual Machines</strong>.</p>
</li>
<li>
<p>Locate the affected virtual machine, and then select <strong>⋮ &#8594; Edit Config</strong>.</p>
</li>
<li>
<p>On the <strong>Advanced Options</strong> tab, under <strong>Cloud Config</strong>, select <strong>Install guest agent</strong>.</p>
</li>
<li>
<p>Click <strong>Save</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>However, cloud-init is run only once (when the virtual machine is started for the first time). To apply new <strong>Cloud Config</strong> settings, you must delete the cloud-init directory in the virtual machine.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">$ sudo rm -rf /var/lib/cloud/*</code></pre>
</div>
</div>
<div class="paragraph">
<p>After deleting the directory, you must restart the virtual machine so that cloud-init is run again and the <code>qemu-guest-agent</code> package is installed.</p>
</div>
</div>
<div class="sect3">
<h4 id="_related_issue_2"><a class="anchor" href="#_related_issue_2"></a>Related Issue</h4>
<div class="paragraph">
<p><a href="https://github.com/harvester/harvester/issues/6644" class="bare">https://github.com/harvester/harvester/issues/6644</a></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ipv6_race_condition_between_virt_launcher_pod_and_guest_operating_system"><a class="anchor" href="#_ipv6_race_condition_between_virt_launcher_pod_and_guest_operating_system"></a>IPv6 Race Condition Between virt-launcher Pod and Guest Operating System</h3>
<div class="sect3">
<h4 id="_description_2"><a class="anchor" href="#_description_2"></a>Description</h4>
<div class="paragraph">
<p>The SUSE Virtualization UI does not display the IP address of the virtual machine whenever the <code>virt-launcher</code> pod&#8217;s network interface acquires an IPv6 link-local address.</p>
</div>
</div>
<div class="sect3">
<h4 id="_analysis_2"><a class="anchor" href="#_analysis_2"></a>Analysis</h4>
<div class="paragraph">
<p>The QEMU guest agent is responsible for reporting information about the guest operating system, including interface details, to the virtual machine instance for displaying on the SUSE Virtualization UI. The issue occurs when the virtual machine&#8217;s pod interface acquires an IPv6 link-local address and reports it to the virtual machine instance before the QEMU guest agent can provide its own information. Once this happens, the IPv4 address from the QEMU guest agent is never reported due to a bug in KubeVirt.</p>
</div>
<div class="paragraph">
<p>You can check the IP address of the pod interface and the virtual machine instance using the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Retrieve the IP address of the virtual machine instance:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>$ kubectl get vmi -n &lt;NAMESPACE&gt; &lt;NAME&gt; -ojsonpath='{.status.interfaces[0].ipAddress}'</pre>
</div>
</div>
<div class="paragraph">
<p>The output only shows the IPv6 link-local address.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Retrieve the IP address of the pod interface:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre>$ kubectl exec -it -n &lt;namespace&gt; &lt;pod-name&gt; -- /bin/bash -c "ip a show label pod\*"</pre>
</div>
</div>
<div class="paragraph">
<p>The output matches the IPv6 address from the virtual machine instance.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To retrieve the assigned IPv4 address, open the virtual machine&#8217;s serial console and run <code>ip a</code> inside the guest operating system.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This issue generally does not affect the virtual machine&#8217;s operations and uptime. You can still access the virtual machine via SSH using its network interface&#8217;s IPv4 address. In certain cases, this issue may impact Rancher integration, causing the provisioning and joining of nodes in the guest cluster to time out.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_workaround_4"><a class="anchor" href="#_workaround_4"></a>Workaround</h4>
<div class="paragraph">
<p>The workaround is to disable IPv6 in the <a href="operating-system.html#_how_to_permanently_edit_kernel_parameters" class="xref page">kernel parameters</a> of SUSE Virtualization.</p>
</div>
<div class="paragraph">
<p>In the above example, add <code>ipv6.disable=1</code> and reboot the nodes to prevent virtual machine pod interfaces from acquiring an IPv6 link-local address.</p>
</div>
</div>
<div class="sect3">
<h4 id="_related_issues_2"><a class="anchor" href="#_related_issues_2"></a>Related Issues</h4>
<div class="paragraph">
<p><a href="https://github.com/harvester/harvester/issues/6955">#6955</a> and <a href="https://github.com/kubevirt/kubevirt/issues/12697">#12697</a></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_virtual_machine_ip_address_intermittently_not_displayed"><a class="anchor" href="#_virtual_machine_ip_address_intermittently_not_displayed"></a>Virtual Machine IP Address Intermittently Not Displayed</h3>
<div class="sect3">
<h4 id="_description_3"><a class="anchor" href="#_description_3"></a>Description</h4>
<div class="paragraph">
<p>The IP address of new virtual machines intermittently disappears and reappears on the SUSE Virtualization UI.</p>
</div>
</div>
<div class="sect3">
<h4 id="_analysis_3"><a class="anchor" href="#_analysis_3"></a>Analysis</h4>
<div class="paragraph">
<p>The QEMU guest agent is responsible for reporting information about the guest operating system, including interface details, to the virtual machine instance for displaying on the SUSE Virtualization UI. The issue occurs when the virtual machine instance is updated with domain data that contain empty network interfaces, which is caused by an upstream KubeVirt issue.</p>
</div>
<div class="paragraph">
<p>This behavior is more commonly observed in Alma Linux 9 and Rocky Linux 9, wherein the QEMU guest agent frequently updates file system information to the virtual machine instance.</p>
</div>
<div class="paragraph">
<p>To check if the issue exists in your environment, run the following command at different times:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ kubectl get vmi -n &lt;NAMESPACE&gt; &lt;NAME&gt; -ojsonpath='{.status.interfaces[0].ipAddress}'</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>ipAddress</code> field may be empty when you run the command.</p>
</div>
<div class="paragraph">
<p>To retrieve the assigned IPv4 address, open the virtual machine&#8217;s serial console and run <code>ip a</code> inside the guest operating system.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This issue generally does not affect the virtual machine&#8217;s operations and uptime. You can still access the virtual machine via SSH using its network interface&#8217;s IPv4 address.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_workaround_5"><a class="anchor" href="#_workaround_5"></a>Workaround</h4>
<div class="paragraph">
<p>While no direct workaround is available for this issue, an [upstream fix](<a href="https://github.com/kubevirt/kubevirt/pull/13624" class="bare">https://github.com/kubevirt/kubevirt/pull/13624</a>) has optimized the code to reduce unnecessary updates from the QEMU guest agent. This enhancement may prevent the issue from occurring.</p>
</div>
</div>
<div class="sect3">
<h4 id="_related_issues_3"><a class="anchor" href="#_related_issues_3"></a>Related Issues</h4>
<div class="paragraph">
<p><a href="https://github.com/harvester/harvester/issues/3990">#3990</a> and <a href="https://github.com/kubevirt/kubevirt/issues/12698">#12698</a></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_unschedulable_virtual_machines"><a class="anchor" href="#_unschedulable_virtual_machines"></a>Unschedulable virtual machines</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A virtual machine may be marked <code>Unschedulable</code> because of an unsatisfied affinity rule.</p>
</div>
<div class="paragraph">
<p>Specifically, the <code>VirtualMachine</code> object contains an affinity rule similar to the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: kubevirt.io/v1
kind: VirtualMachine
metadata:
  name: vm100
  namespace: default
    spec:
      affinity:
        nodeAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            nodeSelectorTerms:
              - matchExpressions:
                  - key: network.harvesterhci.io/cn2
                    operator: In
                    values:
                      - 'true'</code></pre>
</div>
</div>
<div class="paragraph">
<p>The pod status is <code>Pending</code>, and the error message indicates that no node meets the affinity rule&#8217;s criteria.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">$ kubectl get pods
NAME                        READY   STATUS    RESTARTS   AGE
virt-launcher-vm100-f4nh4   0/2     Pending   0          5m12s
$ kubectl get pods virt-launcher-vm100-f4nh4 -oyaml
apiVersion: v1
kind: Pod
metadata:
  name: virt-launcher-vm100-f4nh4
  namespace: default
spec:
  affinity:
    nodeAffinity:
      requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
        - matchExpressions:
          - key: network.harvesterhci.io/cn2
            operator: In
            values:
            - "true"
...
status:
  conditions:
  - lastProbeTime: null
    lastTransitionTime: "2025-07-28T16:21:56Z"
    message: '0/2 nodes are available: 1 node(s) didn''t match Pod''s node affinity/selector,
      1 node(s) had untolerated taint {node.kubernetes.io/unreachable: }. preemption:
      0/2 nodes are available: 2 Preemption is not helpful for scheduling.'
    reason: Unschedulable
    status: "False"
    type: PodScheduled
...</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_root_cause_3"><a class="anchor" href="#_root_cause_3"></a>Root cause</h3>
<div class="paragraph">
<p>SUSE Virtualization may <a href="../virtual-machines/create-vm.html#_automatically_applied_affinity_rules" class="xref page">automatically apply affinity rules</a> based on how a virtual machine is configured. In the example, the virtual machine <code>vm100</code> attaches to the cluster network <code>cn2</code>, and SUSE Virtualization applies the affinity rule <code>network.harvesterhci.io/cn2</code>. However, no nodes meet the rule&#8217;s criteria, so the virtual machine cannot be scheduled.</p>
</div>
</div>
<div class="sect2">
<h3 id="_solution"><a class="anchor" href="#_solution"></a>Solution</h3>
<div class="paragraph">
<p>To ensure that the <code>Pending</code> pod can be scheduled, verify that the cluster network (for example, <code>cn2</code>) is configured on the active nodes and that the corresponding label (for example, <code>network.harvesterhci.io/cn2</code>) is applied to those same nodes.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_unintentional_virtual_machine_template_modification_via_cloud_config_yaml"><a class="anchor" href="#_unintentional_virtual_machine_template_modification_via_cloud_config_yaml"></a>Unintentional virtual machine template modification via cloud config YAML</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you use a template to create a virtual machine and then modify that virtual machine&#8217;s user data using the <strong>Edit as YAML</strong> feature, the source template may be unintentionally modified once you save the changes.</p>
</div>
<div class="paragraph">
<p>This issue occurs because the system does not properly dissociate the configuration inheritance. Because the new configuration remains linked to the source template, saving the changes automatically overwrites the template&#8217;s data.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Avoid using the <strong>Edit as YAML</strong> feature when creating virtual machines, especially when using a template. Instead, use the dedicated fields and options available on the <strong>Virtual Machine: Create</strong> screen.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To mitigate the issue, perform the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Identify the name and namespace of the affected virtual machine.</p>
</li>
<li>
<p>Identify the Cloud Config secret that is associated with the affected virtual machine.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Get the current Secret name linked to the VM's cloudInitNoCloud volume source:
VM_NAME=&lt;VM_NAME&gt;
VM_NAMESPACE=&lt;VM_NAMESPACE&gt;

SECRET=$(kubectl get vm $VM_NAME -n $VM_NAMESPACE -o jsonpath='{.spec.template.spec.volumes[?(@.cloudInitNoCloud)].cloudInitNoCloud.secretRef.name}')
SECRET_NAMESPACE=$(kubectl get secret -A | grep $SECRET  | awk '{print $1}')
echo "Current Secret: $SECRET_NAMESPACE -&gt; $SECRET"</code></pre>
</div>
</div>
</li>
<li>
<p>Create an independent copy of the secret.</p>
<div class="paragraph">
<p>Export the current secret, remove the identifying metadata, assign a unique name, and then apply the secret.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Define a new, unique name for the secret
NEW_SECRET="$VM_NAME-$(date +%s)"
# Export, clean, rename, and create the new Secret
kubectl get secret $SECRET -n $SECRET_NAMESPACE -o json | \
  jq 'del(.metadata.creationTimestamp, .metadata.resourceVersion, .metadata.uid, .metadata.ownerReferences, .metadata.annotations["kubectl.kubernetes.io/last-applied-configuration"], .metadata.selfLink)' | \
  jq '.metadata.name = "'"$NEW_SECRET"'"' | \
  jq '.metadata.namespace = "'"$VM_NAMESPACE"'"' | \
  kubectl apply -n $VM_NAMESPACE -f -</code></pre>
</div>
</div>
</li>
<li>
<p>Update the virtual machine configuration to use the new secret.</p>
<div class="paragraph">
<p>Point the virtual machine&#8217;s <code>cloudInitNoCloud</code> volume source to the new secret.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash"># Patch the VM to replace the secretRef name
VOLUME_INDEX=$(kubectl get vm $VM_NAME -n $NAMESPACE -o json | jq '.spec.template.spec.volumes |  to_entries[] |    select(.value.cloudInitNoCloud != null) | .key')
kubectl patch vm $VM_NAME -n $VM_NAMESPACE --type='json' \
  -p='[{"op": "replace", "path": "/spec/template/spec/volumes/'$VOLUME_INDEX'/cloudInitNoCloud/secretRef/name", "value": "'"$NEW_SECRET"'"}, {"op": "replace", "path": "/spec/template/spec/volumes/'$VOLUME_INDEX'/cloudInitNoCloud/networkDataSecretRef/name", "value": "'"$NEW_SECRET"'"}]'</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Once the Cloud Config is backed by a unique secret, you can use the SUSE Virtualization UI&#8217;s YAML editor to edit the virtual machine configuration without affecting the source template.</p>
</div>
<div class="paragraph">
<p>Related issue: <a href="https://github.com/harvester/harvester/issues/9207">#9207</a></p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="cluster.html">Cluster Issues</a></span>
  <span class="next"><a href="monitoring.html">Monitoring Issues</a></span>
</nav>
</article>
  </div>
</main>
</div>
<script src="../../../../_/js/site.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
<script src="../../../../_/js/vendor/lunr.js"></script>
<script src="../../../../_/js/vendor/lunr-languages.js"></script>
<script src="../../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../../.." data-snippet-length="100" data-stylesheet="../../../../_/css/search.css"></script>
<script async src="../../../../search-index.js"></script>
<script src="../../../../_/js/vendor/langSelection.js"></script>
<script async src="../../../../_/js/vendor/tabs.js"></script>


<script src="../../../../_/js/CNLanguageSwitcher.js"></script>
  </body>
</html>
