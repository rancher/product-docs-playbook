<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
<title>Harvester CSI Driver | SUSE® Virtualization  v1.7 (Dev)</title>
    <link rel="canonical" href="https://documentation.suse.com/cloudnative/virtualization/v1.6/en/integrations/rancher/csi-driver.html">
    <link rel="prev" href="cloud-provider.html">
    <link rel="next" href="resource-quota.html">
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../../../../../_/css/site.css">
<meta http-equiv="last-modified" content="2026-01-02"/>
<link rel="stylesheet" href="../../../../../_/css/search.css">
<link rel="icon" href="../../../../../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="../../../../../_/css/font-styles.css">
<link rel="stylesheet" href="../../../../../_/fonts/css/all.css">
<link rel="stylesheet" href="../../../../../_/css/site-extra.css">
<link rel="stylesheet" href="../../../../../_/css/vendor/tabs.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=SUSE:wght@100..800&display=swap&family=SUSE+Mono:ital,wght@0,100..800;1,100..800" rel="stylesheet">
<link href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css" rel="stylesheet">
<link rel="stylesheet" href="../../../../../_/css/vendor/light.css">
<script src="/docserv/res/lightheaded/analytics.js" type="text/javascript"></script>
<script type="module">
  import { defineCustomElements, setAssetPath } from 'https://d12w0ryu9hjsx8.cloudfront.net/shared-header/1.10/shared-header.esm.js';
  defineCustomElements();
  setAssetPath("https://d12w0ryu9hjsx8.cloudfront.net/shared-header/1.10/assets");
</script>
<!-- Default English link -->
<link href="https://documentation.suse.com/cloudnative/virtualization/v1.7/en/integrations/rancher/csi-driver.html" hreflang="x-default" rel="alternate"/>
<!-- Link for the currently processed page -->
<link href="https://documentation.suse.com/cloudnative/virtualization/v1.7/en/integrations/rancher/csi-driver.html" hrefLang="en-US" rel="alternate" />

<!-- JSON-LD for doc metadata -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "TechArticle",
  "name": "Harvester CSI Driver | SUSE Virtualization v1.7",
  "headline": "Harvester CSI Driver",
  "description": "Harvester CSI Driver",
  "inLanguage": "en",
  "dateModified": "2026-01-02T00:00:00Z",
  "author": {
    "@type": "Organization",
    "name": "SUSE Product & Solution Documentation Team",
    "url": "https://documentation.suse.com"
  },
  "mentions": [
    {
      "@type": "SoftwareApplication",
      "name": "SUSE Virtualization",
      "softwareVersion": "v1.7",
      "applicationCategory": "Cloud Infrastructure",
      "operatingSystem": "Linux"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "SUSE",
    "url": "https://documentation.suse.com",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
    }
  }
}
</script>
<!-- end JSON-LD for doc metadata -->
    <script>var uiRootPath = '../../../../../_'</script>
  </head>
  <body class="article">
<script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs'; mermaid.initialize({"startOnLoad":true});</script><shared-header
language="en"
languages='{
    "en": { "label": "English", "url": "https://documentation.suse.com/en-us/" },
    "de": { "label": "Deutsch", "url": "https://documentation.suse.com/de-de/" },
    "fr": { "label": "Français", "url": "https://documentation.suse.com/fr-fr/" },
    "es": { "label": "Español", "url": "https://documentation.suse.com/es-es/" },
    "zh_CN": { "label": "中文", "url": "https://documentation.suse.com/zh-cn/" },
    "pt_BR": { "label": "Português Brasileiro", "url": "https://documentation.suse.com/pt-br/" }
}'
enable-search='false'>
</shared-header>

<!-- Leaving as a comment, I expect it will be required again next year.
<a target=_blank"" class="survey-link" href="https://suselinux.fra1.qualtrics.com/jfe/form/SV_bEiGZbUNzLD8Tcy"> Documentation survey </a>
--><div class="body">
<div class="nav-container" data-component="virtualization" data-version="v1.7">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title">SUSE® Virtualization</h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Introduction</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../introduction/overview.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../introduction/deploy-ha-cluster.html">Deploy a High-Availability Cluster</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../introduction/deploy-singlenode-cluster.html">Deploy a Single-Node Cluster</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../introduction/glossary.html">Glossary</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../introduction/document-conventions.html">Document Conventions</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Installation and Setup</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../installation-setup/requirements.html">Hardware and Network Requirements</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Installation Media</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../installation-setup/media/net-install.html">Net Install ISO</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../installation-setup/media/install-binaries-mode.html">Install Binaries Only</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Installation Methods</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../installation-setup/methods/iso-install.html">ISO Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../installation-setup/methods/usb-install.html">USB Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../installation-setup/methods/pxe-boot-install.html">PXE Boot Installation</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Configuration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../installation-setup/config/configuration-file.html">Configuration File</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../installation-setup/config/update-configuration.html">Update the Configuration After Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../installation-setup/config/settings.html">Settings</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../installation-setup/config/cloudinitcrd.html">CloudInit CRD</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../installation-setup/post-installation.html">Post-Installation Tasks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../installation-setup/management-address.html">Management Address</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../installation-setup/external-disk.html">External Disk Support</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../installation-setup/authentication.html">Authentication</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../installation-setup/airgap.html">Air-Gapped Environment</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../installation-setup/single-node-clusters.html">Single-Node Clusters</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Upgrades</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../upgrades/upgrades.html">Upgrades</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../upgrades/v1-1-2-to-v1-2-0.html">Upgrade from v1.1.2 to v1.2.0 (not recommended)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../upgrades/v1-2-0-to-v1-2-1.html">Upgrade from v1.1.2/v1.1.3/v1.2.0 to v1.2.1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../upgrades/v1-2-1-to-v1-2-2.html">Upgrade from v1.2.1 to v1.2.2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../upgrades/v1-2-2-to-v1-3-1.html">Upgrade from v1.2.2/v1.3.0 to v1.3.1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../upgrades/v1-3-1-to-v1-3-2.html">Upgrade from v1.3.1 to v1.3.2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../upgrades/v1-3-2-to-v1-4-0.html">Upgrade from v1.3.2 to v1.4.0</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../upgrades/v1-4-0-to-v1-4-1.html">Upgrade from v1.4.0 to v1.4.1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../upgrades/v1-4-1-to-v1-4-2.html">Upgrade from v1.4.1 to v1.4.2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../upgrades/v1-4-1-to-v1-4-3.html">Upgrade from v1.4.1 or v1.4.2 to v1.4.3</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../upgrades/v1-4-2-to-v1-5-0.html">Upgrade from v1.4.2 or v1.4.3 to v1.5.0</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../upgrades/v1-4-2-to-v1-5-1.html">Upgrade from v1.4.2 or v1.4.3 to v1.5.1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../upgrades/v1-4-2-to-v1-5-2.html">Upgrade from v1.4.2 or v1.4.3 to v1.5.2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../upgrades/v1-5-0-to-v1-5-1.html">Upgrade from v1.5.0 to v1.5.1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../upgrades/v1-5-0-to-v1-5-2.html">Upgrade from v1.5.0 or v1.5.1 to v1.5.2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../upgrades/v1-5-x-to-v1-6-x.html">Upgrade from v1.5.x to v1.6.x</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../upgrades/v1-6-x-to-v1-6-y.html">Upgrade from v1.6.x to v1.6.y</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../upgrades/v1-6-x-to-v1-7-x.html">Upgrade from v1.6.x to v1.7.x</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../upgrades/v1-7-x-to-v1-7-y.html">Upgrade from v1.7.x to v1.7.y</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../upgrades/troubleshooting.html">Troubleshooting</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Hosts</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../hosts/hosts.html">Host Management</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../hosts/witness-node.html">Witness Node</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../hosts/vgpu-support.html">vGPU Support</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Virtual Machines</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../virtual-machines/virtual-machines.html">Virtual Machines</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Virtual Machine Images</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../virtual-machines/vm-images/upload-image.html">Upload Images</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../virtual-machines/vm-images/custom-suse-images.html">Custom SUSE Virtual Machine Images</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../virtual-machines/vm-images/image-security.html">Image Security</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../virtual-machines/create-vm.html">Create a Virtual Machine</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../virtual-machines/create-windows-vm.html">Create a Windows Virtual Machine</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../virtual-machines/edit-vm.html">Edit a Virtual Machine</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../virtual-machines/access-vm.html">Access to the Virtual Machine</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../virtual-machines/clone-vm.html">Clone a Virtual Machine</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../virtual-machines/backup-restore.html">Virtual Machine Backup, Snapshot &amp; Restore</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../virtual-machines/live-migration.html">Live Migration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../virtual-machines/hotplug-volume.html">Hot-Plug Volumes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../virtual-machines/resource-overcommit.html">Resource Overcommit</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../virtual-machines/cpu-pinning.html">CPU Pinning</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../virtual-machines/cpu-memory-hotplug.html">CPU and Memory Hotplug</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../virtual-machines/nic-hotplug.html">NIC Hotplug</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Storage</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Volumes</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../storage/volumes/create-volume.html">Create a Volume</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../storage/volumes/edit-volume.html">Edit a Volume</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../storage/volumes/clone-volume.html">Clone a Volume</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../storage/volumes/export-volume.html">Export a Volume to Image</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../storage/volumes/volume-snapshots.html">Volume Snapshots</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../storage/volumes/volume-security.html">Volume Security</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../storage/storageclass.html">StorageClass</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../storage/csidriver.html">Third-Party Storage Support</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../storage/longhorn-v2-data-engine.html">Longhorn V2 Data Engine</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../storage/storage-validator.html">Storage Validator</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Networking</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../networking/cluster-network.html">Cluster Network</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../networking/vm-network.html">VM Network</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../networking/deep-dive.html">Networking Deep Dive</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../networking/load-balancer.html">Load Balancer</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../networking/ip-pool.html">IP Pool</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../networking/storage-network.html">Storage Network</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../networking/vm-migration-network.html">VM Migration Network</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../networking/kubeovn-vpc.html">Virtual Private Cloud</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../networking/vm-isolation.html">Virtual Machine Isolation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../networking/best-practices.html">Networking Best Practices</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Observability</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../observability/logging.html">Logging</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../observability/monitoring.html">Monitoring</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Add-ons</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../add-ons/add-ons.html">Add-ons</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../add-ons/harvester-seeder.html">Harvester Seeder</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../add-ons/kubeovn-operator.html">Kube-OVN Operator (Experimental)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../add-ons/lvm-local-storage.html">CSI Driver LVM (Experimental)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../add-ons/nvidia-driver-toolkit.html">NVIDIA Driver Toolkit</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../add-ons/pcidevices-controller.html">PCI Devices Controller</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../add-ons/rancher-vcluster.html">Rancher vCluster (Experimental)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../add-ons/virtual-machine-auto-balance.html">Virtual Machine Auto Balance (Experimental)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../add-ons/vm-dhcp-controller.html">VM DHCP Controller (Experimental)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../add-ons/vm-import-controller.html">VM Import Controller</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Integrations</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Rancher Integration</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="rancher-integration.html">SUSE Rancher Prime Integration</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="virtualization-management.html">Virtualization Management</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Node Driver</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="node-driver/node-driver.html">Harvester Node Driver</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="node-driver/rke2-cluster.html">Creating an RKE2 Kubernetes Cluster</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="node-driver/k3s-cluster.html">Creating a K3s Kubernetes Cluster</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="cloud-provider.html">Harvester Cloud Provider</a>
  </li>
  <li class="nav-item is-current-page" data-depth="3">
    <a class="nav-link" href="csi-driver.html">Harvester CSI Driver</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="resource-quota.html">Resource Quotas</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="rancher-terraform-provider.html">Rancher Terraform</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="import-vm.html">Import a Cluster Built on a SUSE® Virtualization VM</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="harvester-ui-extension.html">Harvester UI Extension</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../terraform/terraform-provider.html">Terraform Provider</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Troubleshooting</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../troubleshooting/installation.html">Installation Issues</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../troubleshooting/operating-system.html">Operating System Issues</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../troubleshooting/cluster.html">Cluster Issues</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../troubleshooting/virtual-machines.html">Virtual Machine Issues</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../troubleshooting/monitoring.html">Monitoring Issues</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../troubleshooting/logging.html">Logging Issues</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../troubleshooting/rancher.html">Rancher Issues</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../troubleshooting/faq.html">FAQ</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Developer Content</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../developer/addon-development.html">Add-on Development Guide</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../api.html">API</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">SUSE® Virtualization</span>
    <span class="version">v1.7 (Dev)</span>
  </div>
  <ul class="components">
        <li class="component">
          <div class="title"><a href="../../../../../admission-controller/1.31/en/introduction.html">Admission Controller</a></div>
          <ul class="versions">
            <li class="version">
              <a href="../../../../../admission-controller/1.32/en/introduction.html">1.32-dev</a>
            </li>
            <li class="version is-latest">
              <a href="../../../../../admission-controller/1.31/en/introduction.html">1.31-latest</a>
            </li>
            <li class="version">
              <a href="../../../../../admission-controller/1.30/en/introduction.html">1.30</a>
            </li>
            <li class="version">
              <a href="../../../../../admission-controller/1.29/en/introduction.html">1.29</a>
            </li>
            <li class="version">
              <a href="../../../../../admission-controller/1.28/en/introduction.html">1.28</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../../cluster-api/v0.25/en/index.html">Cluster API</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../../cluster-api/v0.25/en/index.html">0.25</a>
            </li>
            <li class="version">
              <a href="../../../../../cluster-api/v0.24/en/index.html">0.24</a>
            </li>
            <li class="version">
              <a href="../../../../../cluster-api/v0.23/en/index.html">0.23</a>
            </li>
            <li class="version">
              <a href="../../../../../cluster-api/v0.22/en/index.html">0.22</a>
            </li>
            <li class="version">
              <a href="../../../../../cluster-api/v0.21/en/index.html">0.21</a>
            </li>
            <li class="version">
              <a href="../../../../../cluster-api/v0.20/en/index.html">0.20</a>
            </li>
            <li class="version">
              <a href="../../../../../cluster-api/v0.19/en/index.html">0.19</a>
            </li>
            <li class="version">
              <a href="../../../../../cluster-api/v0.18/en/index.html">0.18</a>
            </li>
            <li class="version">
              <a href="../../../../../cluster-api/v0.17/en/index.html">0.17</a>
            </li>
            <li class="version">
              <a href="../../../../../cluster-api/v0.16/en/index.html">0.16</a>
            </li>
            <li class="version">
              <a href="../../../../../cluster-api/v0.15/en/index.html">0.15</a>
            </li>
            <li class="version">
              <a href="../../../../../cluster-api/v0.14/en/index.html">0.14</a>
            </li>
            <li class="version">
              <a href="../../../../../cluster-api/v0.13/en/index.html">0.13</a>
            </li>
            <li class="version">
              <a href="../../../../../cluster-api/v0.12/en/index.html">0.12</a>
            </li>
            <li class="version">
              <a href="../../../../../cluster-api/v0.11/en/index.html">0.11</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../../continuous-delivery/v0.14/en/index.html">Continuous Delivery</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../../continuous-delivery/v0.14/en/index.html">0.14</a>
            </li>
            <li class="version">
              <a href="../../../../../continuous-delivery/v0.13/en/index.html">0.13</a>
            </li>
            <li class="version">
              <a href="../../../../../continuous-delivery/v0.12/en/index.html">0.12</a>
            </li>
            <li class="version">
              <a href="../../../../../continuous-delivery/v0.11/en/index.html">0.11</a>
            </li>
            <li class="version">
              <a href="../../../../../continuous-delivery/v0.10/en/index.html">0.10</a>
            </li>
            <li class="version">
              <a href="../../../../../continuous-delivery/v0.9/en/index.html">0.9</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../../k3s/latest/en/introduction.html">K3s</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../../k3s/latest/en/introduction.html">Latest</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../../os-manager/1.8/en/index.html">OS Manager</a></div>
          <ul class="versions">
            <li class="version">
              <a href="../../../../../os-manager/1.9/en/index.html">1.9-dev</a>
            </li>
            <li class="version is-latest">
              <a href="../../../../../os-manager/1.8/en/index.html">1.8</a>
            </li>
            <li class="version">
              <a href="../../../../../os-manager/1.7/en/index.html">1.7</a>
            </li>
            <li class="version">
              <a href="../../../../../os-manager/1.6/en/index.html">1.6</a>
            </li>
            <li class="version">
              <a href="../../../../../os-manager/1.5/en/index.html">1.5</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../../rke2/latest/en/introduction.html">RKE2</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../../rke2/latest/en/introduction.html">Latest</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../../suse-observability/latest/en/classic.html">SUSE Observability</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../../suse-observability/latest/en/classic.html">Latest</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../../rancher-srfa/latest/en/about-rancher/what-is-rancher.html">SUSE® Rancher for AWS</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../../rancher-srfa/latest/en/about-rancher/what-is-rancher.html">Latest</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../../rancher-manager/v2.13/en/about-rancher/what-is-rancher.html">SUSE® Rancher Manager</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../../rancher-manager/v2.13/en/about-rancher/what-is-rancher.html">v2.13</a>
            </li>
            <li class="version">
              <a href="../../../../../rancher-manager/v2.12/en/about-rancher/what-is-rancher.html">v2.12</a>
            </li>
            <li class="version">
              <a href="../../../../../rancher-manager/v2.11/en/about-rancher/what-is-rancher.html">v2.11</a>
            </li>
            <li class="version">
              <a href="../../../../../rancher-manager/v2.10/en/about-rancher/what-is-rancher.html">v2.10</a>
            </li>
            <li class="version">
              <a href="../../../../../rancher-manager/v2.9/en/about-rancher/what-is-rancher.html">v2.9</a>
            </li>
            <li class="version">
              <a href="../../../../../rancher-manager/v2.8/en/about-rancher/what-is-rancher.html">v2.8</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../../security/5.4/en/overview.html">SUSE® Security</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../../security/5.4/en/overview.html">5.4</a>
            </li>
            <li class="version">
              <a href="../../../../../security/5.3/en/overview.html">5.3</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../../storage/1.10/en/longhorn-documentation.html">SUSE® Storage</a></div>
          <ul class="versions">
            <li class="version">
              <a href="../../../../../storage/1.11/en/longhorn-documentation.html">1.11 (Dev)</a>
            </li>
            <li class="version is-latest">
              <a href="../../../../../storage/1.10/en/longhorn-documentation.html">1.10 (Latest)</a>
            </li>
            <li class="version">
              <a href="../../../../../storage/1.9/en/longhorn-documentation.html">1.9</a>
            </li>
            <li class="version">
              <a href="../../../../../storage/1.8/en/longhorn-documentation.html">1.8</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../../suse-virtual-clusters/v1.0.1/en/introduction.html">SUSE® Virtual Clusters</a></div>
          <ul class="versions">
            <li class="version">
              <a href="../../../../../suse-virtual-clusters/1.0.2/en/introduction.html">1.0.2-dev</a>
            </li>
            <li class="version is-latest">
              <a href="../../../../../suse-virtual-clusters/v1.0.1/en/introduction.html">v1.0.1-latest</a>
            </li>
            <li class="version">
              <a href="../../../../../suse-virtual-clusters/v1.0.0/en/introduction.html">v1.0.0</a>
            </li>
          </ul>
        </li>
        <li class="component is-current">
          <div class="title"><a href="../../../../v1.6/en/introduction/overview.html">SUSE® Virtualization</a></div>
          <ul class="versions">
            <li class="version is-current">
              <a href="../../introduction/overview.html">v1.7 (Dev)</a>
            </li>
            <li class="version is-latest">
              <a href="../../../../v1.6/en/introduction/overview.html">v1.6 (Latest)</a>
            </li>
            <li class="version">
              <a href="../../../../v1.5/en/introduction/overview.html">v1.5</a>
            </li>
          </ul>
        </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
<ul>
    <li>
      <a class="home-link-dsc" href="https://documentation.suse.com/" title="documentation.suse.com" aria-label="SUSE Documentation Home"></a>
    </li>
    <li>
      <a href="https://documentation.suse.com/cloudnative/virtualization" title="SUSE Virtualization" aria-label="SUSE Documentation - SUSE Virtualization">
        SUSE Virtualization
      </a>
    </li>
      <li>
          Integrations
      </li>
  </ul>
</nav><div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">v1.7 (Dev)</button>
  <div class="version-menu">
    <a class="version is-current" href="csi-driver.html">v1.7 (Dev)</a>
    <a class="version" href="../../../../v1.6/en/integrations/rancher/csi-driver.html">v1.6 (Latest)</a>
    <a class="version" href="../../../../v1.5/en/integrations/rancher/csi-driver.html">v1.5</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/rancher/harvester-product-docs/edit/main/versions/v1.7/modules/en/pages/integrations/rancher/csi-driver.adoc"><strong>Edit</strong></a></div>
        <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <label class="visual-search-label-bc" for="search-input">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>
          <input label="Search" aria-label="Search" id="search-input" type="text" placeholder="Search the docs" >
          <label class="filter checkbox" style="display: none">
            <input type="checkbox" data-facet-filter="component:virtualization" checked> Only this project
          </label>
        </div>
      </div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="On this page" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This is unreleased documentation for SUSE® Virtualization v1.7 (Dev).</p>
</div>
</td>
</tr>
</table>
</div>
<h1 class="page">Harvester CSI Driver</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The Harvester Container Storage Interface (CSI) driver provides a standard CSI interface used by guest Kubernetes clusters. It connects to the host cluster and hot-plugs host volumes to the virtual machines to provide native storage performance.</p>
</div>
<div class="paragraph">
<p>The Harvester CSI Driver supports the following features:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2857%;">
<col style="width: 14.2858%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Harvester CSI Driver Version</th>
<th class="tableblock halign-left valign-top">SUSE Virtualization Version</th>
<th class="tableblock halign-left valign-top">Storage Tiering</th>
<th class="tableblock halign-left valign-top">RWX Volumes</th>
<th class="tableblock halign-left valign-top">Online Resizing</th>
<th class="tableblock halign-left valign-top">Third-Party Storage</th>
<th class="tableblock halign-left valign-top">Volume Snapshots</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1.15</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All versions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#10006;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#10006;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#10006;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#10006;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1.20</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">v1.4 and later</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#10006;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#10006;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#10006;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1.24</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">v1.6 and later</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#10006;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1.25</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">v1.7 and later</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#10004;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#10004;</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A <a href="https://github.com/harvester/harvester/issues/6849">known issue</a> in v0.1.20 of the Harvester CSI Driver causes volumes to get stuck when the host cluster is running a SUSE Virtualization version that was released before v1.4.0.</p>
</div>
<div class="paragraph">
<p>This issue was fixed in v0.1.21. If your system is affected, you can follow the suggested <a href="https://github.com/harvester/harvester/issues/6849#issuecomment-2462545795">workaround</a>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Harvester CSI Driver Version</th>
<th class="tableblock halign-left valign-top">SUSE Virtualization Version</th>
<th class="tableblock halign-left valign-top">Affected?</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v0.1.21 and later</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All versions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v0.1.20</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">v1.4.0 and later</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v0.1.20</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">v1.3.2 and earlier</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">v0.1.18 and earlier</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All versions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_deploying"><a class="anchor" href="#_deploying"></a>Deploying</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_prerequisites"><a class="anchor" href="#_prerequisites"></a>Prerequisites</h3>
<div class="ulist">
<ul>
<li>
<p>The Kubernetes cluster is built on top of SUSE Virtualization virtual machines.</p>
</li>
<li>
<p>The SUSE Virtualization virtual machines that run as guest Kubernetes nodes are in the same namespace.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Currently, the Harvester CSI Driver only supports single-node read-write (RWO) volumes. Check <a href="https://github.com/harvester/harvester/issues/1992">issue #1992</a> for information regarding possible multi-node read-only (ROX) and read-write (RWX) support.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_deploying_with_harvester_rke2_node_driver"><a class="anchor" href="#_deploying_with_harvester_rke2_node_driver"></a>Deploying with Harvester RKE2 node driver</h3>
<div class="paragraph">
<p>When spinning up a Kubernetes cluster using Rancher RKE2 node driver, the Harvester CSI driver will be deployed automatically when Harvester cloud provider is selected.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/rancher/rke2-cloud-provider.png" alt="select-harvester-cloud-provider">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_install_csi_driver_manually_in_the_rke2_cluster"><a class="anchor" href="#_install_csi_driver_manually_in_the_rke2_cluster"></a>Install CSI driver manually in the RKE2 cluster</h3>
<div class="paragraph">
<p>If you prefer to install the Harvester CSI driver without enabling the Harvester cloud provider, you can refer to the following steps:</p>
</div>
<div class="sect3">
<h4 id="_prerequisites_of_manual_install"><a class="anchor" href="#_prerequisites_of_manual_install"></a>Prerequisites of manual install</h4>
<div class="paragraph">
<p>Ensure that you have the following prerequisites in place:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You have <code>kubectl</code> and <code>jq</code> installed on your system.</p>
</li>
<li>
<p>You have the <code>kubeconfig</code> file for your bare-metal Harvester cluster. You can find the <code>kubeconfig</code> file from one of the Harvester management nodes in the <code>/etc/rancher/rke2/rke2.yaml</code> path.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">  export KUBECONFIG=/path/to/your/harvester-kubeconfig</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Perform the following steps to deploy the Harvester CSI driver manually:</p>
</div>
</div>
<div class="sect3">
<h4 id="_deploy_harvester_csi_driver"><a class="anchor" href="#_deploy_harvester_csi_driver"></a>Deploy Harvester CSI driver</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Generate the <code>cloud-config</code>. You can generate the <code>cloud-config</code> file using the <a href="https://raw.githubusercontent.com/harvester/harvester-csi-driver/master/deploy/generate_addon_csi.sh">generate_addon_csi.sh</a> script. It is available on the <a href="https://github.com/harvester/harvester-csi-driver">harvester/harvester-csi-driver</a> repo.</p>
<div class="paragraph">
<p><code>&lt;serviceaccount name&gt;</code> usually corresponds to your guest cluster name, and <code>&lt;namespace&gt;</code> should match the machine pool&#8217;s namespace.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">./generate_addon_csi.sh &lt;serviceaccount name&gt; &lt;namespace&gt; RKE2</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/rancher/creating_guest_cluster.png" alt="creating guest cluster">
</div>
</div>
<div class="paragraph">
<p>The generated output will be similar to the following one:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell"> ########## cloud-config ############
 apiVersion: v1
 clusters:
 - cluster: &lt;token&gt;
     server: https://&lt;YOUR HOST HARVESTER VIP&gt;:6443
   name: default
 contexts:
 - context:
     cluster: default
     namespace: default
     user: rke2-guest-01-default-default
   name: rke2-guest-01-default-default
 current-context: rke2-guest-01-default-default
 kind: Config
 preferences: {}
 users:
 - name: rke2-guest-01-default-default
   user:
     token: &lt;token&gt;

 ########## cloud-init user data ############
 write_files:
   - encoding: b64
     content: YXBpVmVyc2lvbjogdjEKY2x1c3RlcnM6Ci0gY2x1c3RlcjoKICAgIGNlcnRpZmljYXRlLWF1dGhvcml0eS1kYXRhOiBMUzB0TFMxQ1JVZEpUaUJEUlZKVVNVWkpRMEZVUlMwdExTMHRDazFKU1VKbFZFTkRRVklyWjBGM1NVSkJaMGxDUVVSQlMwSm5aM0ZvYTJwUFVGRlJSRUZxUVd0TlUwbDNTVUZaUkZaUlVVUkVRbXg1WVRKVmVVeFlUbXdLWTI1YWJHTnBNV3BaVlVGNFRtcG5NVTE2VlhoT1JGRjNUVUkwV0VSVVNYcE5SRlY1VDFSQk5VMVVRVEJOUm05WVJGUk5lazFFVlhsT2FrRTFUVlJCTUFwTlJtOTNTa1JGYVUxRFFVZEJNVlZGUVhkM1dtTnRkR3hOYVRGNldsaEtNbHBZU1hSWk1rWkJUVlJaTkU1VVRURk5WRkV3VFVSQ1drMUNUVWRDZVhGSENsTk5ORGxCWjBWSFEwTnhSMU5OTkRsQmQwVklRVEJKUVVKSmQzRmFZMDVTVjBWU2FsQlVkalJsTUhFMk0ySmxTSEZEZDFWelducGtRa3BsU0VWbFpHTUtOVEJaUTNKTFNISklhbWdyTDJab2VXUklNME5ZVURNeFZXMWxTM1ZaVDBsVGRIVnZVbGx4YVdJMGFFZE5aekpxVVdwQ1FVMUJORWRCTVZWa1JIZEZRZ292ZDFGRlFYZEpRM0JFUVZCQ1owNVdTRkpOUWtGbU9FVkNWRUZFUVZGSUwwMUNNRWRCTVZWa1JHZFJWMEpDVWpaRGEzbEJOSEZqYldKSlVESlFWVW81Q2xacWJWVTNVV2R2WjJwQlMwSm5aM0ZvYTJwUFVGRlJSRUZuVGtsQlJFSkdRV2xCZUZKNU4xUTNRMVpEYVZWTVdFMDRZazVaVWtWek1HSnBZbWxVSzJzS1kwRnhlVmt5Tm5CaGMwcHpMM2RKYUVGTVNsQnFVVzVxZEcwMVptNTZWR3AxUVVsblRuTkdibFozWkZRMldXWXpieTg0ZFRsS05tMWhSR2RXQ2kwdExTMHRSVTVFSUVORlVsUkpSa2xEUVZSRkxTMHRMUzBLCiAgICBzZXJ2ZXI6IGh0dHBzOi8vMTkyLjE2OC4wLjEzMTo2NDQzCiAgbmFtZTogZGVmYXVsdApjb250ZXh0czoKLSBjb250ZXh0OgogICAgY2x1c3RlcjogZGVmYXVsdAogICAgbmFtZXNwYWNlOiBkZWZhdWx0CiAgICB1c2VyOiBya2UyLWd1ZXN0LTAxLWRlZmF1bHQtZGVmYXVsdAogIG5hbWU6IHJrZTItZ3Vlc3QtMDEtZGVmYXVsdC1kZWZhdWx0CmN1cnJlbnQtY29udGV4dDogcmtlMi1ndWVzdC0wMS1kZWZhdWx0LWRlZmF1bHQKa2luZDogQ29uZmlnCnByZWZlcmVuY2VzOiB7fQp1c2VyczoKLSBuYW1lOiBya2UyLWd1ZXN0LTAxLWRlZmF1bHQtZGVmYXVsdAogIHVzZXI6CiAgICB0b2tlbjogZXlKaGJHY2lPaUpTVXpJMU5pSXNJbXRwWkNJNklreGhUazQxUTBsMWFsTnRORE5TVFZKS00waE9UbGszTkV0amNVeEtjM1JSV1RoYVpUbGZVazA0YW1zaWZRLmV5SnBjM01pT2lKcmRXSmxjbTVsZEdWekwzTmxjblpwWTJWaFkyTnZkVzUwSWl3aWEzVmlaWEp1WlhSbGN5NXBieTl6WlhKMmFXTmxZV05qYjNWdWRDOXVZVzFsYzNCaFkyVWlPaUprWldaaGRXeDBJaXdpYTNWaVpYSnVaWFJsY3k1cGJ5OXpaWEoyYVdObFlXTmpiM1Z1ZEM5elpXTnlaWFF1Ym1GdFpTSTZJbkpyWlRJdFozVmxjM1F0TURFdGRHOXJaVzRpTENKcmRXSmxjbTVsZEdWekxtbHZMM05sY25acFkyVmhZMk52ZFc1MEwzTmxjblpwWTJVdFlXTmpiM1Z1ZEM1dVlXMWxJam9pY210bE1pMW5kV1Z6ZEMwd01TSXNJbXQxWW1WeWJtVjBaWE11YVc4dmMyVnlkbWxqWldGalkyOTFiblF2YzJWeWRtbGpaUzFoWTJOdmRXNTBMblZwWkNJNkltTXlZak5sTldGaExUWTBNMlF0TkRkbU1pMDROemt3TFRjeU5qWXpNbVl4Wm1aaU5pSXNJbk4xWWlJNkluTjVjM1JsYlRwelpYSjJhV05sWVdOamIzVnVkRHBrWldaaGRXeDBPbkpyWlRJdFozVmxjM1F0TURFaWZRLmFRZmU1d19ERFRsSWJMYnUzWUVFY3hmR29INGY1VnhVdmpaajJDaWlhcXB6VWI0dUYwLUR0cnRsa3JUM19ZemdXbENRVVVUNzNja1BuQmdTZ2FWNDhhdmlfSjJvdUFVZC04djN5d3M0eXpjLVFsTVV0MV9ScGJkUURzXzd6SDVYeUVIREJ1dVNkaTVrRWMweHk0X0tDQ2IwRHQ0OGFoSVhnNlMwRDdJUzFfVkR3MmdEa24wcDVXUnFFd0xmSjdEbHJDOFEzRkNUdGhpUkVHZkUzcmJGYUdOMjdfamR2cUo4WXlJQVd4RHAtVHVNT1pKZUNObXRtUzVvQXpIN3hOZlhRTlZ2ZU05X29tX3FaVnhuTzFEanllbWdvNG9OSEpzekp1VWliRGxxTVZiMS1oQUxYSjZXR1Z2RURxSTlna1JlSWtkX3JqS2tyY3lYaGhaN3lTZ3o3QQo=
     owner: root:root
     path: /var/lib/rancher/rke2/etc/config-files/cloud-provider-config
     permissions: '0644'</code></pre>
</div>
</div>
</li>
<li>
<p>Copy and paste the <code>cloud-init user data</code> content to <strong>Machine Pools</strong> &gt; <strong>Show Advanced</strong> &gt; <strong>User Data</strong>.
<span class="image"><img src="../../_images/rancher/cloud-config-userdata.png" alt="cloud config userdata"></span></p>
<div class="paragraph">
<p>The <code>cloud-provider-config</code> file will be created after you apply the cloud-init user data above. You can find it on the guest Kubernetes nodes at the path <code>/var/lib/rancher/rke2/etc/config-files/cloud-provider-config</code>.</p>
</div>
</li>
<li>
<p>Configure the <strong>Cloud Provider</strong> either to <strong>Default - RKE2 Embedded</strong> or <strong>External</strong>.</p>
<div class="imageblock">
<div class="content">
<img src="../../_images/rancher/non-harvester-cloud-provider.png" alt="non harvester cloud provider">
</div>
</div>
</li>
<li>
<p>Select <strong>Create</strong> to create your RKE2 cluster.</p>
</li>
<li>
<p>Once the RKE2 cluster is ready, install the <strong>Harvester CSI Driver</strong> chart from the Rancher marketplace. You do not need to change the <strong>cloud-config</strong> path  by default.</p>
<div class="imageblock">
<div class="content">
<img src="../../_images/rancher/install_csi_rancher_marketplace.png" alt="install csi rancher marketplace">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/rancher/donot_change_cloud_config_path.png" alt="donot change cloud config path">
</div>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you prefer not to install the Harvester CSI driver using Rancher
(<strong>Apps</strong> &gt; <strong>Charts</strong>), you can use <a href="https://helm.sh">Helm</a> instead.
The Harvester CSI driver is <a href="https://github.com/harvester/charts/tree/master/charts/harvester-csi-driver">packaged as a Helm chart</a>.
For more information, see <a href="https://charts.harvesterhci.io" class="bare">https://charts.harvesterhci.io</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By following the above steps, you should be able to see those CSI driver pods are up and running on the <code>kube-system</code> namespace, and you can verify it by provisioning a new PVC using the default StorageClass <code>harvester</code> on your RKE2 cluster.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_deploying_with_harvester_k3s_node_driver"><a class="anchor" href="#_deploying_with_harvester_k3s_node_driver"></a>Deploying with Harvester K3s node driver</h3>
<div class="paragraph">
<p>You can follow the <a href="#_deploy_harvester_csi_driver">Deploy Harvester CSI driver</a> steps described in the RKE2 section.</p>
</div>
<div class="paragraph">
<p>The only difference is in generating the <code>cloud-init</code> config where you need to specify the provider type as <code>k3s</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">./generate_addon_csi.sh &lt;serviceaccount name&gt; &lt;namespace&gt; k3s</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_customize_the_default_storageclass"><a class="anchor" href="#_customize_the_default_storageclass"></a>Customize the Default StorageClass</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Harvester CSI driver provides the interface for defining the default StorageClass. If the default StorageClass in unspecified, the Harvester CSI driver uses the default StorageClass of the host Harvester cluster.</p>
</div>
<div class="paragraph">
<p>You can use the parameter <code>host-storage-class</code> to customize the default StorageClass.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a StorageClass for the host Harvester cluster.</p>
<div class="paragraph">
<p>Example:
 <span class="image"><img src="../../_images/rancher/create-new-sc.png" alt="create new sc"></span></p>
</div>
</li>
<li>
<p>Deploy the CSI driver with the parameter <code>host-storage-class</code>.</p>
<div class="paragraph">
<p>Example:
 <span class="image"><img src="../../_images/rancher/deploy-csi-driver-with-host-storage-class.png" alt="deploy csi driver with host storage class"></span></p>
</div>
</li>
<li>
<p>Verify that the Harvester CSI driver is ready.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>On the <strong>PersistentVolumeClaims</strong> screen, create a PVC. Select <strong>Use a Storage Class to provision a new Persistent Volume</strong> and specify the StorageClass you created.</p>
<div class="paragraph">
<p>Example:
 <span class="image"><img src="../../_images/rancher/create-volume-with-harvester-csi-driver.png" alt="create volume with harvester csi driver"></span></p>
</div>
</li>
<li>
<p>Once the PVC is created, note the name of the provisioned volume and verify that the status is <strong>Bound</strong>.</p>
<div class="paragraph">
<p>Example:
 <span class="image"><img src="../../_images/rancher/check-volume-and-pvc-name.png" alt="check volume and pvc name"></span></p>
</div>
</li>
<li>
<p>On the <strong>Volumes</strong> screen, verify that the volume was provisioned using the StorageClass that you created.</p>
<div class="paragraph">
<p>Example:
 <span class="image"><img src="../../_images/rancher/check-pvc-name-on-host-harvester-volume-page.png" alt="check pvc name on host harvester volume page"></span></p>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_passthrough_custom_storageclass"><a class="anchor" href="#_passthrough_custom_storageclass"></a>Passthrough Custom StorageClass</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Beginning with Harvester CSI driver v0.1.15, it&#8217;s possible to create a PersistentVolumeClaim (PVC) using a different Harvester StorageClass on the guest Kubernetes Cluster.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A compatible Harvester CSI Driver is built into each supported RKE2 version.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_prerequisites_2"><a class="anchor" href="#_prerequisites_2"></a>Prerequisites</h3>
<div class="paragraph">
<p>Add the following prerequisites to your Harvester cluster to ensure the Harvester CSI driver displays error messages correctly. Proper RBAC settings are essential for error message visibility, especially when creating a PVC with a non-existent StorageClass, as shown in the image below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/rancher/error_event_csi_driver.png" alt="error event csi driver">
</div>
</div>
<div class="paragraph">
<p>Follow these steps to set up <strong>RBAC</strong> for error message visibility:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a new <code>clusterrole</code> named <code>harvesterhci.io:csi-driver</code> using the following manifest.</p>
<div class="listingblock">
<div class="content">
<pre> apiVersion: rbac.authorization.k8s.io/v1
 kind: ClusterRole
 metadata:
   labels:
     app.kubernetes.io/component: apiserver
     app.kubernetes.io/name: harvester
     app.kubernetes.io/part-of: harvester
   name: harvesterhci.io:csi-driver
 rules:
 - apiGroups:
   - storage.k8s.io
   resources:
   - storageclasses
   verbs:
   - get
   - list
   - watch</pre>
</div>
</div>
</li>
<li>
<p>Create a new <code>clusterrolebinding</code> associated with the <code>clusterrole</code> above with the relevant <code>serviceaccount</code> using the following manifest.</p>
<div class="listingblock">
<div class="content">
<pre> apiVersion: rbac.authorization.k8s.io/v1
 kind: ClusterRoleBinding
 metadata:
   name: &lt;namespace&gt;-&lt;serviceaccount name&gt;
 roleRef:
   apiGroup: rbac.authorization.k8s.io
   kind: ClusterRole
   name: harvesterhci.io:csi-driver
 subjects:
 - kind: ServiceAccount
   name: &lt;serviceaccount name&gt;
   namespace: &lt;namespace&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Make sure the <code>serviceaccount name</code> and <code>namespace</code> match your cloud provider settings. Perform the following steps to retrieve these details.</p>
</div>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Find the <code>rolebinding</code> associated with your cloud provider:</p>
<div class="listingblock">
<div class="content">
<pre> $ kubectl get rolebinding -A |grep harvesterhci.io:cloudprovider
 default                                 default-rke2-guest-01                                ClusterRole/harvesterhci.io:cloudprovider             7d1h</pre>
</div>
</div>
</li>
<li>
<p>Extract the <code>subjects</code> information from this <code>rolebinding</code>:</p>
<div class="listingblock">
<div class="content">
<pre> $ kubectl get rolebinding default-rke2-guest-01 -n default -o yaml |yq -e '.subjects'</pre>
</div>
</div>
</li>
<li>
<p>Identify the <code>ServiceAccount</code> information:</p>
<div class="listingblock">
<div class="content">
<pre> - kind: ServiceAccount
   name: rke2-guest-01
   namespace: default</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_deploying_2"><a class="anchor" href="#_deploying_2"></a>Deploying</h3>
<div class="paragraph">
<p>Now you can create a new StorageClass that you intend to use in your guest Kubernetes cluster.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>For administrators, you can create a desired <a href="../../storage/storageclass.html" class="xref page">StorageClass</a> (e.g., named <strong>replica-2</strong>) in your bare-metal Harvester cluster.</p>
<div class="imageblock">
<div class="content">
<img src="../../_images/rancher/sc-replica-2.png" alt="sc replica 2">
</div>
</div>
</li>
<li>
<p>Then, on the guest Kubernetes cluster, create a new StorageClass associated with the StorageClass named <strong>replica-2</strong> from the Harvester Cluster:</p>
<div class="imageblock">
<div class="content">
<img src="../../_images/rancher/downstream-cluster-sc-creation.png" alt="downstream cluster sc creation">
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>When choosing a <strong>Provisioner</strong>, select <strong>Harvester (CSI)</strong>. The <strong>Host StorageClass</strong> parameter should match the StorageClass name created on the Harvester Cluster.</p>
</li>
<li>
<p>For guest Kubernetes owners, you may request that the Harvester cluster administrator create a new StorageClass.</p>
</li>
<li>
<p>If you leave the <code>Host StorageClass</code> field empty, the default StorageClass of the Harvester cluster will be used.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>You can now create a PVC based on this new <strong>StorageClass</strong>, which utilizes the <strong>Host StorageClass</strong> to provision volumes on the bare-metal Harvester cluster.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_rwx_volume_support"><a class="anchor" href="#_rwx_volume_support"></a>RWX Volume Support</h2>
<div class="sectionbody">
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
<div class="paragraph">
<p>RWX volumes currently only work with a dedicated storage network. <a href="https://github.com/harvester/harvester/issues/7218">Issue #7218</a> tracks the enhancement that will allow RWX volumes to use various VLANs on guest clusters.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_prerequisites_3"><a class="anchor" href="#_prerequisites_3"></a>Prerequisites</h3>
<div class="ulist">
<ul>
<li>
<p>Harvester v1.4 or later is installed on the host cluster.</p>
</li>
<li>
<p>A <a href="../../networking/storage-network.html" class="xref page">storage network</a> is configured on the Harvester cluster.</p>
<div class="paragraph">
<p>Use <strong>exclude</strong> to reserve a range of IP addresses for the guest cluster virtual machines.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/rancher/configure-storage-network-01.png" alt="configure storage network 01">
</div>
</div>
</li>
<li>
<p>The <strong>Storage Network for RWX Volume</strong> setting on the embedded Longhorn UI is enabled.</p>
<div class="paragraph">
<p>Go to <strong>General</strong>, and then select <strong>Storage Network for RWX Volume Enabled</strong>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/rancher/enable-rwx-storage-network-01.png" alt="enable rwx storage network 01">
</div>
</div>
</li>
<li>
<p>You have created an RWX StorageClass on the host Harvester cluster.</p>
<div class="paragraph">
<p>On the <strong>Storage Class: Create</strong> screen, click <strong>Edit as YAML</strong> and specify the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">kind: StorageClass
apiVersion: storage.k8s.io/v1
metadata:
  name: longhorn-rwx
provisioner: driver.longhorn.io
allowVolumeExpansion: true
reclaimPolicy: Delete
volumeBindingMode: Immediate
parameters:
  numberOfReplicas: "3"
  staleReplicaTimeout: "2880"
  fromBackup: ""
  fsType: "ext4"
  nfsOptions: "vers=4.2,noresvport,softerr,timeo=600,retrans=5"</code></pre>
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/rancher/create-rwx-sc-host-cluster-01.png" alt="create rwx sc host cluster 01">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/rancher/create-rwx-sc-host-cluster-02.png" alt="create rwx sc host cluster 02">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/rancher/create-rwx-sc-host-cluster-03.png" alt="create rwx sc host cluster 03">
</div>
</div>
</li>
<li>
<p>The role-based access control (RBAC) settings are up-to-date.</p>
<div class="paragraph">
<p><a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/">RBAC authorization</a> uses a specific Kubernetes API group to drive authorization decisions regarding access to computer or network resources.</p>
</div>
<div class="paragraph">
<p>The Harvester CSI driver requires the new RBAC settings to support RWX volumes. To check the RBAC settings, run the command <code>kubectl get clusterrole harvesterhci.io:csi-driver -o yaml</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml"># kubectl get clusterrole harvesterhci.io:csi-driver -o yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
...
  name: harvesterhci.io:csi-driver
...
rules:
- apiGroups:
  - storage.k8s.io
  resources:
  - storageclasses
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - harvesterhci.io
  resources:
  - networkfilesystems
  - networkfilesystems/status
  verbs:
  - '*'
- apiGroups:
  - longhorn.io
  resources:
  - volumes
  - volumes/status
  verbs:
  - get
  - list</code></pre>
</div>
</div>
</li>
<li>
<p>The networkfs-manager pods are running.</p>
<div class="paragraph">
<p>To check the status of the networkfs-manager pods, run the command <code>kubectl get pods -n harvester-system | grep networkfs-manager</code>.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml"># kubectl get pods -n harvester-system | grep networkfs-manager
harvester-networkfs-manager-2pxhm                       1/1     Running     4 (34m ago)    3h41m
harvester-networkfs-manager-8tst2                       1/1     Running     4 (37m ago)    3h41m
harvester-networkfs-manager-xvkgp                       1/1     Running     4 (37m ago)    3h41m</code></pre>
</div>
</div>
</li>
<li>
<p>The Harvester CSI driver version is v0.1.20 or later.</p>
<div class="imageblock">
<div class="content">
<img src="../../_images/rancher/harvester-csi-driver-version.png" alt="harvester csi driver version">
</div>
</div>
</li>
<li>
<p>The virtual machine has two network interfaces: a default network interface for intra-cluster communications and allowing access from the infrastructure network (external to the Harvester cluster); and a network that can connect to the storage network.</p>
<div class="paragraph">
<p>The NAD <strong>default/vlan101</strong> is used for the storage network.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/rancher/create-guest-cluster-with-two-nics.png" alt="create guest cluster with two nics">
</div>
</div>
</li>
<li>
<p>The NFS client is installed on each node in the guest cluster.</p>
<div class="paragraph">
<p>Run any of the following commands to install the NFS client.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Debian and Ubuntu: <code>apt-get install -y nfs-common</code></p>
</li>
<li>
<p>CentOS and RHEL: <code>yum install -y nfs-utils</code></p>
</li>
<li>
<p>SUSE and OpenSUSE: <code>zypper install -y nfs-client</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>An IP is manually assigned to the storage network interface.</p>
<div class="paragraph">
<p>You can assign any of the reserved IPs using the following commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>$ ip link set &lt;storage network nic&gt; up
$ ip a add &lt;reserved IP&gt; dev &lt;storage network nic&gt;</pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>An IP that is assigned using the given commands does not persist after a reboot. To make the IP persistent, you must add it to the network configuration file of your guest operating system.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_usage"><a class="anchor" href="#_usage"></a>Usage</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a new StorageClass on the guest cluster.</p>
<div class="paragraph">
<p>On the <strong>StorageClass: Create</strong> screen, add a <strong>Host Storage Class</strong> parameter and specify the RWX StorageClass that you created on the host Harvester cluster.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/rancher/new-sc-associated-with-rwx.png" alt="new sc associated with rwx">
</div>
</div>
</li>
<li>
<p>Create an RWX PersistentVolumeClaim (PVC).</p>
<div class="paragraph">
<p>On the <strong>PersistentVolumeClaim: Create</strong> screen, configure the following settings:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Volume Claim</strong> tab: Specify the new StorageClass.</p>
<div class="imageblock">
<div class="content">
<img src="../../_images/rancher/create-rwx-pvc-01.png" alt="create rwx pvc 01">
</div>
</div>
</li>
<li>
<p><strong>Customize</strong> tab: Select <strong>Many Nodes Read-Write</strong>.</p>
<div class="imageblock">
<div class="content">
<img src="../../_images/rancher/create-rwx-pvc-02.png" alt="create rwx pvc 02">
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Verify that the RWX PVC was created successfully.</p>
<div class="imageblock">
<div class="content">
<img src="../../_images/rancher/check-rwx-pvc.png" alt="check rwx pvc">
</div>
</div>
</li>
<li>
<p>Create two pods.</p>
<div class="paragraph">
<p>On the <strong>Pod: Create</strong> screen, specify the RWX PVC.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/rancher/create-pod-with-rwx-pvc-01.png" alt="create pod with rwx pvc 01">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/rancher/create-pod-with-rwx-pvc-02.png" alt="create pod with rwx pvc 02">
</div>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/rancher/create-pod-with-rwx-pvc-03.png" alt="create pod with rwx pvc 03">
</div>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can follow the same steps to create an RWX PVC on the guest cluster and then use it on pods that require RWX volumes.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_online_volume_resizing"><a class="anchor" href="#_online_volume_resizing"></a>Online volume resizing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If the underlying storage provider supports <a href="../../storage/volumes/edit-volume.html#_online_volume_expansion" class="xref page">online volume expansion</a>, you can expand a ReadWriteOnce (RWO) volume in the guest cluster even while it is attached to a running workload.</p>
</div>
<div class="sect2">
<h3 id="_prerequisites_4"><a class="anchor" href="#_prerequisites_4"></a>Prerequisites</h3>
<div class="ulist">
<ul>
<li>
<p>SUSE Virtualization v1.6 or later</p>
</li>
<li>
<p>Harvester CSI Driver v0.1.24 or later</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_volume_snapshots"><a class="anchor" href="#_volume_snapshots"></a>Volume Snapshots</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Starting with <strong>v0.1.25</strong>, the Harvester CSI Driver supports <a href="https://kubernetes.io/docs/concepts/storage/volume-snapshots/">volume snapshots</a>, providing point-in-time backup and restore capabilities for workloads running on guest Kubernetes clusters.</p>
</div>
<div class="sect2">
<h3 id="_prerequisites_5"><a class="anchor" href="#_prerequisites_5"></a>Prerequisites</h3>
<div class="ulist">
<ul>
<li>
<p>SUSE Virtualization v1.7 or later</p>
</li>
<li>
<p>Harvester CSI Driver v0.1.25 or later</p>
</li>
<li>
<p>The CSI snapshot controller and the required manifests are properly deployed on the guest cluster. These components are deployed by default on RKE2.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_upgrade_the_csi_driver"><a class="anchor" href="#_upgrade_the_csi_driver"></a>Upgrade the CSI Driver</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The Harvester CSI Driver supports volume snapshots starting with version <strong>v0.1.25</strong>. Using this feature may require additional steps depending on your Kubernetes distribution.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>RKE2 (recommended): The CSI snapshot controller is deployed by default.</p>
</li>
<li>
<p>Other Kubernetes distributions: You must install the CSI snapshot controller on the guest cluster before upgrading the Harvester CSI Driver to <strong>v0.1.25</strong>. For installation instructions, refer to your distribution&#8217;s documentation (example: <a href="https://documentation.suse.com/cloudnative/storage/latest/en/snapshots-backups/csi-snapshots/enable-csi-snapshot-creation.html(SUSE" class="bare">https://documentation.suse.com/cloudnative/storage/latest/en/snapshots-backups/csi-snapshots/enable-csi-snapshot-creation.html(SUSE</a> Storage).</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_upgrade_rke2"><a class="anchor" href="#_upgrade_rke2"></a>Upgrade RKE2</h3>
<div class="paragraph">
<p>To upgrade the CSI driver, use the Rancher UI to upgrade RKE2. Ensure the new RKE2 version supports/bundled with the updated CSI driver version.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Go to <strong>☰</strong> &gt; <strong>Cluster Management</strong>.</p>
</li>
<li>
<p>Find the guest cluster that you want to upgrade and select <strong>⋮</strong> &gt; <strong>Edit Config</strong>.</p>
</li>
<li>
<p>Select <strong>Kubernetes Version</strong>.</p>
</li>
<li>
<p>Click <strong>Save</strong>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_upgrade_k3s"><a class="anchor" href="#_upgrade_k3s"></a>Upgrade K3s</h3>
<div class="paragraph">
<p>You can upgrade K3s using the Rancher UI.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Go to <strong>☰</strong> &gt; <strong>K3s Cluster</strong> &gt; <strong>Apps</strong> &gt; <strong>Installed Apps</strong>.</p>
</li>
<li>
<p>Find the CSI driver chart and select <strong>⋮</strong> &gt; <strong>Edit/Upgrade</strong>.</p>
</li>
<li>
<p>Select <strong>Version</strong>.</p>
</li>
<li>
<p>Select <strong>Next</strong> &gt; <strong>Update</strong>.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="cloud-provider.html">Harvester Cloud Provider</a></span>
  <span class="next"><a href="resource-quota.html">Resource Quotas</a></span>
</nav>
</article>
  </div>
</main>
</div>
<script src="../../../../../_/js/site.js"></script>
<script async src="../../../../../_/js/vendor/highlight.js"></script>
<script src="../../../../../_/js/vendor/lunr.js"></script>
<script src="../../../../../_/js/vendor/lunr-languages.js"></script>
<script src="../../../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../../../.." data-snippet-length="100" data-stylesheet="../../../../../_/css/search.css"></script>
<script async src="../../../../../search-index.js"></script>
<script src="../../../../../_/js/vendor/langSelection.js"></script>
<script async src="../../../../../_/js/vendor/tabs.js"></script>


<script src="../../../../../_/js/CNLanguageSwitcher.js"></script>
  </body>
</html>
