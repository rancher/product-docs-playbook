<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
<title>SUSE Security Admission Controller architecture | Admission Controller  1.31-latest</title>
    <link rel="canonical" href="https://documentation.suse.com/cloudnative/admission-controller/1.31/en/explanations/architecture.html">
    <link rel="prev" href="audit-scanner/policy-reports.html">
    <link rel="next" href="../howtos/tasks.html">
    <meta name="description" content="The SUSE Security Admission Controller architecture">
    <meta name="keywords" content="["SUSE Security Admission Controller", "kubewarden", "kubernetes", "architecture"]">
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../../../../_/css/site.css">
<meta http-equiv="last-modified" content="2025-11-17"/>
<link rel="stylesheet" href="../../../../_/css/search.css">
<link rel="icon" href="../../../../_/img/favicon.ico" type="image/x-icon">
<link rel="stylesheet" href="../../../../_/css/font-styles.css">
<link rel="stylesheet" href="../../../../_/fonts/css/all.css">
<link rel="stylesheet" href="../../../../_/css/site-extra.css">
<link rel="stylesheet" href="../../../../_/css/vendor/tabs.css">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=SUSE:wght@100..800&display=swap&family=SUSE+Mono:ital,wght@0,100..800;1,100..800" rel="stylesheet">
<link href="https://documentation.suse.com/docserv/res/fonts/poppins/poppins.css" rel="stylesheet">
<link rel="stylesheet" href="../../../../_/css/vendor/light.css">
<script src="/docserv/res/lightheaded/analytics.js" type="text/javascript"></script>
<script type="module">
  import { defineCustomElements, setAssetPath } from 'https://d12w0ryu9hjsx8.cloudfront.net/shared-header/1.10/shared-header.esm.js';
  defineCustomElements();
  setAssetPath("https://d12w0ryu9hjsx8.cloudfront.net/shared-header/1.10/assets");
</script>
<!-- Default English link -->
<link href="https://documentation.suse.com/cloudnative/admission-controller/1.31/en/explanations/architecture.html" hreflang="x-default" rel="alternate"/>
<!-- Link for the currently processed page -->
<link href="https://documentation.suse.com/cloudnative/admission-controller/1.31/en/explanations/architecture.html" hrefLang="en-US" rel="alternate" />

<!-- JSON-LD for doc metadata -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "TechArticle",
  "name": "SUSE Security Admission Controller architecture | SUSE Security Admission Controller 1.31",
  "headline": "SUSE Security Admission Controller architecture",
  "description": "The SUSE Security Admission Controller architecture",
  "inLanguage": "en",
  "dateModified": "2025-11-17T00:00:00Z",
  "author": {
    "@type": "Organization",
    "name": "SUSE Product & Solution Documentation Team",
    "url": "https://documentation.suse.com"
  },
  "mentions": [
    {
      "@type": "SoftwareApplication",
      "name": "SUSE Security Admission Controller",
      "softwareVersion": "1.31",
      "applicationCategory": "Cloud Infrastructure",
      "operatingSystem": "Linux"
    }
  ],
  "publisher": {
    "@type": "Organization",
    "name": "SUSE",
    "url": "https://documentation.suse.com",
    "logo": {
      "@type": "ImageObject",
      "url": "https://www.suse.com/assets/img/suse-white-logo-green.svg"
    }
  }
}
</script>
<!-- end JSON-LD for doc metadata -->
    <script>var uiRootPath = '../../../../_'</script>
  </head>
  <body class="article">
<script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs'; mermaid.initialize({"startOnLoad":true});</script><shared-header
language="en"
languages='{
    "en": { "label": "English", "url": "https://documentation.suse.com/en-us/" },
    "de": { "label": "Deutsch", "url": "https://documentation.suse.com/de-de/" },
    "fr": { "label": "Français", "url": "https://documentation.suse.com/fr-fr/" },
    "es": { "label": "Español", "url": "https://documentation.suse.com/es-es/" },
    "zh_CN": { "label": "中文", "url": "https://documentation.suse.com/zh-cn/" },
    "pt_BR": { "label": "Português Brasileiro", "url": "https://documentation.suse.com/pt-br/" }
}'
enable-search='false'>
</shared-header>

<!-- Leaving as a comment, I expect it will be required again next year.
<a target=_blank"" class="survey-link" href="https://suselinux.fra1.qualtrics.com/jfe/form/SV_bEiGZbUNzLD8Tcy"> Documentation survey </a>
--><div class="body">
<div class="nav-container" data-component="admission-controller" data-version="1.31">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title">Admission Controller</h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../introduction.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../quick-start.html">Quick start</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Tutorials</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../tutorials/writing-policies/index.html">Writing SUSE Security Admission Controller policies</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../tutorials/writing-policies/CEL/01-intro-cel.html">Introduction to CEL</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/CEL/02-reusing-vap.html">Reusing ValidatingAdmissionPolicies</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/CEL/03-context-aware.html">Context-aware CEL policies</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/CEL/04-example-sigstore.html">Sigstore host capabilities</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../tutorials/writing-policies/rust/01-intro-rust.html">Rust</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/rust/02-create-policy.html">Creating a policy</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/rust/03-define-policy-settings.html">Defining policy settings</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/rust/04-write-validation-logic.html">Writing validation logic</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/rust/05-mutation-policy.html">Creating a new mutation policy</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/rust/06-logging.html">Logging</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/rust/07-build-and-distribute.html">Building and distributing policies</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/rust/08-raw-policies.html">Raw policies</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../tutorials/writing-policies/go/01-intro-go.html">Writing policies in Go</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/go/02-scaffold.html">Creating a new validation policy</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/go/03-policy-settings.html">Defining policy settings</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/go/04-validation.html">Writing the validation logic</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/go/05-e2e-tests.html">End-to-end testing</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/go/06-logging.html">Logging</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/go/07-automate.html">Integrating with GitHub Actions</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/go/08-distribute.html">Distributing policy</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/go/09-validation-with-queries.html">Validation using JSON queries</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/go/10-raw-policies.html">Writing raw policies</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../tutorials/writing-policies/rego/01-intro-rego.html">Rego</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/rego/02-builtin-support.html">Builtin support</a>
  </li>
  <li class="nav-item" data-depth="4">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Open Policy Agent</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tutorials/writing-policies/rego/open-policy-agent/01-intro.html">Introduction to Open Policy Agent</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tutorials/writing-policies/rego/open-policy-agent/02-create-policy.html">Creating a new policy</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tutorials/writing-policies/rego/open-policy-agent/03-build-and-run.html">Build and run a OPA policy for Admission Controller</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tutorials/writing-policies/rego/open-policy-agent/04-distribute.html">Distributing an OPA policy with SUSE Security Admission Controller</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tutorials/writing-policies/rego/open-policy-agent/05-raw-policies.html">Writing raw policies</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="4">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Gatekeeper</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tutorials/writing-policies/rego/gatekeeper/01-intro.html">Gatekeeper support</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tutorials/writing-policies/rego/gatekeeper/02-create-policy.html">Creating a new Gatekeeper Rego policy</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tutorials/writing-policies/rego/gatekeeper/03-build-and-run.html">Build and run a Gatekeeper policy</a>
  </li>
  <li class="nav-item" data-depth="5">
    <a class="nav-link" href="../tutorials/writing-policies/rego/gatekeeper/04-distribute.html">Distributing a Gatekeeper policy with SUSE Security Admission Controller</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tutorials/writing-policies/dotnet.html">C#</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">TypeScript</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/typescript/01-intro-typescript.html">Writing policies in TypeScript/JavaScript</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/typescript/02-scaffold.html">Creating a new validation policy</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/typescript/03-policy-settings.html">Defining policy settings</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/typescript/04-validation.html">Writing the validation logic</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/typescript/05-e2etests.html">End-to-end testing</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tutorials/writing-policies/swift.html">Swift</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tutorials/writing-policies/other-languages.html">Other languages</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">WASI</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/wasi/01-intro-wasi.html">WASI</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../tutorials/writing-policies/wasi/02-raw-policies.html">Writing raw policies</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tutorials/writing-policies/metadata.html">Policy metadata</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Testing policies</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tutorials/testing-policies/index.html">Policy testing</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tutorials/testing-policies/02-policy-authors.html">Testing for policy authors</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../tutorials/testing-policies/03-cluster-operators.html">Testing for cluster operators</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tutorials/verifying-kubewarden.html">Verifying SUSE Security Admission Controller</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../tutorials/publish-policy-to-artifact-hub.html">Publish policies to Artifact Hub</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Explanations</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="mutating-policies.html">Mutating policies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="context-aware-policies.html">Context aware policies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="policy-groups.html">Policy Groups</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="certificates.html">Certificate rotation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="distributing-policies.html">Distributing policies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Comparisons</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="comparisons/opa-comparison.html">SUSE Security Admission Controller vs OPA Gatekeeper</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="audit-scanner/audit-scanner.html">What is the Audit Scanner?</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="audit-scanner/limitations.html">Audit Scanner - Limitations</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="audit-scanner/policy-reports.html">Audit Scanner - Policy Reports</a>
  </li>
</ul>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="architecture.html">Admission Controller architecture</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Howtos</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/tasks.html">Common tasks</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/install-kwctl.html">Install <code>kwctl</code></a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/production-deployments.html">Production deployments</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/deploy-at-scale.html">Deployment at scale</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/audit-scanner.html">Audit Scanner</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/policies.html">Configuring policies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/emergency-disable.html">Emergency disable</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Configuring Policy Servers</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/policy-servers/01-custom-cas.html">Using custom CAs</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/policy-servers/02-private-registry.html">Configuring PolicyServers to use private registries</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/policy-servers/03-production-deployments.html">Production deployments</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/policy-groups.html">Policy groups</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/psp-migration.html">PSP migration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/vap-migration.html">ValidatingAdmissionPolicy migration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/pod-security-admission-with-kubewarden.html">Pod Security Admission</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/custom-certificate-authorities.html">Custom certificate authorities</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/raw-policies.html">Raw policies</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/argocd-installation.html">ArgoCD Installation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../howtos/security-hardening/security-hardening.html">Security</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/security-hardening/secure-supply-chain.html">Secure supply chain</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/security-hardening/webhook-mtls.html">Enable mTLS with K3s</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Air gap</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/airgap/01-requirements.html">Requirements</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/airgap/02-install.html">Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/airgap/03-hauler.html">Hauler installation</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Telemetry quick starts</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/telemetry/10-opentelemetry-qs.html">Open Telemetry quick start</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/telemetry/20-tracing-qs.html">Tracing quickstart</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/telemetry/30-metrics-qs.html">Metrics quickstart</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/telemetry/40-custom-otel-collector.html">Custom OpenTelemetry Collector</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/Rancher-Fleet.html">Rancher Fleet</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Rancher UI extension</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/ui-extension/01-install.html">Quickstart</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/ui-extension/02-metrics.html">Monitoring</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/ui-extension/03-tracing.html">Tracing</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Rancher Application Collection</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/application-collection/01-verify-images.html">Verify images</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Workarounds</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/workarounds/policy-server-certificate-expiry.html">Certificate rotation, releases ≥ v1.16</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <a class="nav-link" href="../howtos/contribution-guide/contribution-guide.html">Contribution guide</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/contribution-guide/contributing.html">Contributing to documentation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../howtos/contribution-guide/suggesting-an-improvement.html">Improving documentation</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../howtos/gatekeeper-migration.html">Migrating Gatekeeper Policies to SUSE Security Admission Controller</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Reference</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/CRDs.html">Custom Resource Definitions (CRD)</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/dependency-matrix.html">Dependency matrix</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/artifacts.html">Artifacts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/upgrade-path.html">Upgrade path</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/metrics-reference.html">Metrics reference</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/monitor-mode.html">Monitor mode</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Policy specification</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../reference/spec/01-intro-spec.html">Policy communication specification</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../reference/spec/02-settings.html">Policy settings</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../reference/spec/03-validating-policies.html">Validating policies</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../reference/spec/04-mutating-policies.html">Mutating policies</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../reference/spec/05-context-aware-policies.html">Context aware policies</a>
  </li>
  <li class="nav-item" data-depth="3">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Host capabilities</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../reference/spec/host-capabilities/01-intro-host-capabilities.html">Host capabilities specification</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../reference/spec/host-capabilities/02-signature-verifier-policies.html">Signature verifier policies</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../reference/spec/host-capabilities/03-container-registry.html">Container registry capabilities</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../reference/spec/host-capabilities/04-net.html">Network capabilities</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../reference/spec/host-capabilities/05-crypto.html">Cryptographic capabilities</a>
  </li>
  <li class="nav-item" data-depth="4">
    <a class="nav-link" href="../reference/spec/host-capabilities/06-kubernetes.html">Kubernetes capabilities</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/oci-registries-support.html">OCI registry support for Admission Controller</a>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle" aria-label="Toggle expand/collapse"></button>
    <span class="nav-text">Security</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../reference/security-hardening/webhooks-hardening.html">Webhooks</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/threat-model.html">Threat Model</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/policy-evaluation-timeout.html">Policy evaluation timeout protection</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/verification-config.html">Verification configuration format</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/sources_yaml.html">Reference for sources.yaml</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/kwctl-cli.html"><code>kwctl</code> CLI</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../reference/policy-server-cli.html">Policy Server CLI</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../personas.html">For who?</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../use-cases.html">Use cases</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../organization.html">Organization</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../enterprise.html">Enterprise</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../glossary.html">Glossary</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../disclosure.html">Security disclosure</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Admission Controller</span>
    <span class="version">1.31-latest</span>
  </div>
  <ul class="components">
        <li class="component is-current">
          <div class="title"><a href="../introduction.html">Admission Controller</a></div>
          <ul class="versions">
            <li class="version">
              <a href="../../../1.32/en/introduction.html">1.32-dev</a>
            </li>
            <li class="version is-current is-latest">
              <a href="../introduction.html">1.31-latest</a>
            </li>
            <li class="version">
              <a href="../../../1.30/en/introduction.html">1.30</a>
            </li>
            <li class="version">
              <a href="../../../1.29/en/introduction.html">1.29</a>
            </li>
            <li class="version">
              <a href="../../../1.28/en/introduction.html">1.28</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../cluster-api/v0.25/en/index.html">Cluster API</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../cluster-api/v0.25/en/index.html">0.25</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.24/en/index.html">0.24</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.23/en/index.html">0.23</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.22/en/index.html">0.22</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.21/en/index.html">0.21</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.20/en/index.html">0.20</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.19/en/index.html">0.19</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.18/en/index.html">0.18</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.17/en/index.html">0.17</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.16/en/index.html">0.16</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.15/en/index.html">0.15</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.14/en/index.html">0.14</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.13/en/index.html">0.13</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.12/en/index.html">0.12</a>
            </li>
            <li class="version">
              <a href="../../../../cluster-api/v0.11/en/index.html">0.11</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../continuous-delivery/v0.14/en/index.html">Continuous Delivery</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../continuous-delivery/v0.14/en/index.html">0.14</a>
            </li>
            <li class="version">
              <a href="../../../../continuous-delivery/v0.13/en/index.html">0.13</a>
            </li>
            <li class="version">
              <a href="../../../../continuous-delivery/v0.12/en/index.html">0.12</a>
            </li>
            <li class="version">
              <a href="../../../../continuous-delivery/v0.11/en/index.html">0.11</a>
            </li>
            <li class="version">
              <a href="../../../../continuous-delivery/v0.10/en/index.html">0.10</a>
            </li>
            <li class="version">
              <a href="../../../../continuous-delivery/v0.9/en/index.html">0.9</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../k3s/latest/en/introduction.html">K3s</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../k3s/latest/en/introduction.html">Latest</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../os-manager/1.8/en/index.html">OS Manager</a></div>
          <ul class="versions">
            <li class="version">
              <a href="../../../../os-manager/1.9/en/index.html">1.9-dev</a>
            </li>
            <li class="version is-latest">
              <a href="../../../../os-manager/1.8/en/index.html">1.8</a>
            </li>
            <li class="version">
              <a href="../../../../os-manager/1.7/en/index.html">1.7</a>
            </li>
            <li class="version">
              <a href="../../../../os-manager/1.6/en/index.html">1.6</a>
            </li>
            <li class="version">
              <a href="../../../../os-manager/1.5/en/index.html">1.5</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../rke2/latest/en/introduction.html">RKE2</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../rke2/latest/en/introduction.html">Latest</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../suse-observability/latest/en/classic.html">SUSE Observability</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../suse-observability/latest/en/classic.html">Latest</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../rancher-srfa/latest/en/about-rancher/what-is-rancher.html">SUSE® Rancher for AWS</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../rancher-srfa/latest/en/about-rancher/what-is-rancher.html">Latest</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../rancher-manager/v2.13/en/about-rancher/what-is-rancher.html">SUSE® Rancher Manager</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../rancher-manager/v2.13/en/about-rancher/what-is-rancher.html">v2.13</a>
            </li>
            <li class="version">
              <a href="../../../../rancher-manager/v2.12/en/about-rancher/what-is-rancher.html">v2.12</a>
            </li>
            <li class="version">
              <a href="../../../../rancher-manager/v2.11/en/about-rancher/what-is-rancher.html">v2.11</a>
            </li>
            <li class="version">
              <a href="../../../../rancher-manager/v2.10/en/about-rancher/what-is-rancher.html">v2.10</a>
            </li>
            <li class="version">
              <a href="../../../../rancher-manager/v2.9/en/about-rancher/what-is-rancher.html">v2.9</a>
            </li>
            <li class="version">
              <a href="../../../../rancher-manager/v2.8/en/about-rancher/what-is-rancher.html">v2.8</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../security/5.4/en/overview.html">SUSE® Security</a></div>
          <ul class="versions">
            <li class="version is-latest">
              <a href="../../../../security/5.4/en/overview.html">5.4</a>
            </li>
            <li class="version">
              <a href="../../../../security/5.3/en/overview.html">5.3</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../storage/1.10/en/longhorn-documentation.html">SUSE® Storage</a></div>
          <ul class="versions">
            <li class="version">
              <a href="../../../../storage/1.11/en/longhorn-documentation.html">1.11 (Dev)</a>
            </li>
            <li class="version is-latest">
              <a href="../../../../storage/1.10/en/longhorn-documentation.html">1.10 (Latest)</a>
            </li>
            <li class="version">
              <a href="../../../../storage/1.9/en/longhorn-documentation.html">1.9</a>
            </li>
            <li class="version">
              <a href="../../../../storage/1.8/en/longhorn-documentation.html">1.8</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../suse-virtual-clusters/v1.0.1/en/introduction.html">SUSE® Virtual Clusters</a></div>
          <ul class="versions">
            <li class="version">
              <a href="../../../../suse-virtual-clusters/1.0.2/en/introduction.html">1.0.2-dev</a>
            </li>
            <li class="version is-latest">
              <a href="../../../../suse-virtual-clusters/v1.0.1/en/introduction.html">v1.0.1-latest</a>
            </li>
            <li class="version">
              <a href="../../../../suse-virtual-clusters/v1.0.0/en/introduction.html">v1.0.0</a>
            </li>
          </ul>
        </li>
        <li class="component">
          <div class="title"><a href="../../../../virtualization/v1.6/en/introduction/overview.html">SUSE® Virtualization</a></div>
          <ul class="versions">
            <li class="version">
              <a href="../../../../virtualization/v1.7/en/introduction/overview.html">v1.7 (Dev)</a>
            </li>
            <li class="version is-latest">
              <a href="../../../../virtualization/v1.6/en/introduction/overview.html">v1.6 (Latest)</a>
            </li>
            <li class="version">
              <a href="../../../../virtualization/v1.5/en/introduction/overview.html">v1.5</a>
            </li>
          </ul>
        </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
<nav class="breadcrumbs" aria-label="breadcrumbs">
<ul>
    <li>
      <a class="home-link-dsc" href="https://documentation.suse.com/" title="documentation.suse.com" aria-label="SUSE Documentation Home"></a>
    </li>
    <li>
      <a href="https://documentation.suse.com/cloudnative/admission-controller" title="Admission Controller" aria-label="SUSE Documentation - Admission Controller">
        Admission Controller
      </a>
    </li>
      <li>
          Explanations
      </li>
  </ul>
</nav><div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">1.31-latest</button>
  <div class="version-menu">
    <a class="version" href="../../../1.32/en/explanations/architecture.html">1.32-dev</a>
    <a class="version is-current" href="architecture.html">1.31-latest</a>
    <a class="version" href="../../../1.30/en/explanations/architecture.html">1.30</a>
    <a class="version" href="../../../1.29/en/explanations/architecture.html">1.29</a>
    <a class="version" href="../../../1.28/en/explanations/architecture.html">1.28</a>
  </div>
</div>
  <div class="edit-this-page"><a href="https://github.com/rancher/kubewarden-product-docs/edit/main/docs/version-1.31/modules/en/pages/explanations/architecture.adoc"><strong>Edit</strong></a></div>
        <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <label class="visual-search-label-bc" for="search-input">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>
          <input label="Search" aria-label="Search" id="search-input" type="text" placeholder="Search the docs" >
          <label class="filter checkbox" style="display: none">
            <input type="checkbox" data-facet-filter="component:admission-controller" checked> Only this project
          </label>
        </div>
      </div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="On this page" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">SUSE Security Admission Controller architecture</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>SUSE Security Admission Controller is a Kubernetes policy engine.
It uses policies written in a programming language of your choosing.
This language must generate a WebAssembly binary for SUSE Security Admission Controller to use.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_what_is_a_policy"><a class="anchor" href="#_what_is_a_policy"></a>What <em>is</em> a policy?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A policy is an <a href="https://opencontainers.org/">Open Container Initiative</a> (OCI)
artifact. It contains a WebAssembly module, the policy code, and the metadata
required by PolicyServer to perform admission request validations and
mutations.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Like <a href="https://kubernetes.io/docs/contribute/style/style-guide/">Kubernetes</a>,
SUSE Security Admission Controller uses the terms 'PolicyServer' when discussing the SUSE Security Admission Controller
policy server and <code>policy-server</code> when discussing Pod or Deployment of a
SUSE Security Admission Controller PolicyServer.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_design_principles"><a class="anchor" href="#_design_principles"></a>Design principles</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_making_use_of_core_kubernetes_features"><a class="anchor" href="#_making_use_of_core_kubernetes_features"></a>Making use of core Kubernetes features</h3>
<div class="paragraph">
<p>The team designed SUSE Security Admission Controller to use core features of Kubernetes,
without reinventing the wheel.
The project utilizes a combination of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Kubernetes Controllers</p>
</li>
<li>
<p>Custom Resource Definitions (CRDs)</p>
</li>
<li>
<p>Webhooks (Validation and Mutating)</p>
</li>
<li>
<p>the Control Plane&#8217;s event notification system</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_makes_effective_use_of_the_kubernetes_architecture"><a class="anchor" href="#_makes_effective_use_of_the_kubernetes_architecture"></a>Makes effective use of the Kubernetes architecture</h3>
<div class="paragraph">
<p>SUSE Security Admission Controller operates seamlessly within the Kubernetes ecosystem. At its
core, the SUSE Security Admission Controller controller is a Kubernetes controller, monitoring
SUSE Security Admission Controller Custom Resource Definitions (CRDs) and configuring Kubernetes
resources to execute them. This integration ensures that SUSE Security Admission Controller uses
the built-in Kubernetes mechanisms, such as controllers and CRDs, to watch,
manage, and apply security policies efficiently.</p>
</div>
</div>
<div class="sect2">
<h3 id="_extensible_policy_definition"><a class="anchor" href="#_extensible_policy_definition"></a>Extensible policy definition</h3>
<div class="paragraph">
<p>SUSE Security Admission Controller employs CRDs to define and manage SUSE Security Admission Controller resources,
which specify the rules for admission request validations. This design enables
users to extend Kubernetes' capabilities with custom admission controls,
ensuring that security and compliance policy enforcement is consistent across
the cluster.</p>
</div>
</div>
<div class="sect2">
<h3 id="_direct_admission_control"><a class="anchor" href="#_direct_admission_control"></a>Direct admission control</h3>
<div class="paragraph">
<p>When setup by the SUSE Security Admission Controller controller, the policy-server Service receives
admission requests directly from the Kubernetes control plane, using
<code>ValidationWebhooks</code> and <code>MutatingWebhooks</code>. This direct interaction
streamlines the admission control process, reducing latency and increasing
efficiency in policy enforcement.</p>
</div>
<div class="paragraph">
<p>WebAssembly offers a sand-boxed execution environment, ensuring policies run in
isolation, thus enhancing the security and stability of the policy enforcement
mechanism. This isolation prevents policies from interfering with each other or
with the host system, mitigating the risk of malicious code execution.
WebAssembly is portable and efficient, enabling policies to run across
different environments without modification. This cross-platform compatibility
ensures that SUSE Security Admission Controller policies are versatile, so you can distribute and
run them on diverse Kubernetes clusters</p>
</div>
</div>
<div class="sect2">
<h3 id="_oci_based_policy_artifacts"><a class="anchor" href="#_oci_based_policy_artifacts"></a>OCI based policy artifacts</h3>
<div class="paragraph">
<p>Policies in SUSE Security Admission Controller are OCI (Open Container Initiative) artifacts. This
standardization makes the distribution and versioning of policies easier,
Policies contain both the WebAssembly modules for enforcement logic, and
metadata necessary for the PolicyServer&#8217;s operation. Using OCI artifacts
promotes interoperability and ease of management within cloud ecosystems.</p>
</div>
</div>
<div class="sect2">
<h3 id="_fine_grained_policy_application"><a class="anchor" href="#_fine_grained_policy_application"></a>Fine-grained policy application</h3>
<div class="paragraph">
<p>SUSE Security Admission Controller associates policies with their own 'validation' or 'mutating'
webhook, allowing for fine-grained application of admission controls. This
flexibility enables administrators to tailor the enforcement of policies
according to specific needs, enhancing the security and compliance posture of
the Kubernetes cluster.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_suse_security_admission_controller_stack"><a class="anchor" href="#_the_suse_security_admission_controller_stack"></a>The SUSE Security Admission Controller stack</h2>
<div class="sectionbody">
<div class="paragraph">
<p>SUSE Security Admission Controller consists of these components:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SUSE Security Admission Controller Custom Resources are
<a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/">Kubernetes
Custom Resources</a> that simplify the process of managing policies.</p>
<div class="paragraph">
<p>SUSE Security Admission Controller integrates with Kubernetes using
<a href="https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/">Dynamic
Admission Control</a>. In particular, SUSE Security Admission Controller operates as a Kubernetes
Admission Webhook. The <code>policy-server</code> is the Webhook endpoint called by the
Kubernetes API server to validate requests.</p>
</div>
</li>
<li>
<p>The <a href="https://github.com/kubewarden/kubewarden-controller">SUSE Security Admission Controller
controller</a> is a Kubernetes controller that reconciles SUSE Security Admission Controller&#8217;s
Custom Resources. This controller creates parts of the SUSE Security Admission Controller stack.
It also translates SUSE Security Admission Controller configuration into Kubernetes directives.</p>
<div class="paragraph">
<p>The <code>kubewarden-controller</code> registers the needed
<code>MutatingWebhookConfiguration</code> or <code>ValidatingWebhookConfiguration</code> objects
with the Kubernetes API server.</p>
</div>
</li>
<li>
<p><a href="../tutorials/writing-policies/index.html" class="xref page">SUSE Security Admission Controller policies</a> are
WebAssembly modules holding the validation or mutation logic. WebAssembly
modules have detailed documentation in the
<a href="../tutorials/writing-policies/index.html" class="xref page">writing policies</a> sections.</p>
</li>
<li>
<p>The <a href="https://github.com/kubewarden/policy-server">PolicyServer</a> receives
requests for validation. It validates the requests by executing
SUSE Security Admission Controller policies.</p>
</li>
<li>
<p>The <a href="https://github.com/kubewarden/audit-scanner">audit scanner</a> inspects the
resources already in the cluster. It identifies those violating
SUSE Security Admission Controller policies.</p>
<div class="paragraph">
<p><a href="audit-scanner/audit-scanner.html" class="xref page">Audit scanner</a> constantly
checks the resources declared in the cluster, flagging the ones that no
longer adhere to the deployed SUSE Security Admission Controller policies.</p>
</div>
<div class="imageblock"><div class="mermaid content" style=" ">%%{
  init: {
    "flowchart": {
      "htmlLabels": false,
    }
  }
}%%
graph LR
    accTitle: Admission Controller architecture
    accDescr: A diagram showing the architecture of Admission Controller components.
    subgraph " "
      direction LR
      subgraph " "
        direction LR
          k8s(("Kubernetes"))
          registry[("OCI registry")]
        end
        subgraph kw["`**Admission Controller**`"]
          controller("`**Controller**`")
          subgraph policy-server["`**policy-server**`"]
            direction LR
            kw-policy-1{{"Policy 1"}}
            kw-policy-2{{"Policy 2"}}
            kw-policy-3{{"Policy 3"}}
        end
        webhooks(["ValidationWebhooks and\nMutatingWebhooks"])
        audit-scanner["KW audit scanner"]
      end
    end
    policy-server -->|"downloads\npolicies from"| registry
    controller -->|"watches for\nevents"| k8s
    controller -->|"creates"| webhooks
    controller -->|"creates\npolicy-server\ninstances"| policy-server
    k8s -. "sends admission\nrequests using" .-> webhooks
    webhooks -. "sent admission\nrequests from K8s" .-> policy-server
    audit-scanner -->|"sends audit\nadmission requests"| policy-server</div><div class="title">Figure 1. Architecture</div></div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_journey_of_a_suse_security_admission_controller_policy"><a class="anchor" href="#_the_journey_of_a_suse_security_admission_controller_policy"></a>The journey of a SUSE Security Admission Controller policy</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_default_policyserver"><a class="anchor" href="#_default_policyserver"></a>Default PolicyServer</h3>
<div class="paragraph">
<p>On a new cluster, the SUSE Security Admission Controller components defined are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Custom Resource Definitions (CRD)</p>
</li>
<li>
<p>The <code>kubewarden-controller</code> Deployment</p>
</li>
<li>
<p>A PolicyServer Custom Resource named <code>default</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When the <code>kubewarden-controller</code> notices the default PolicyServer resource, it
creates a <code>policy-server</code> deployment of the PolicyServer component.</p>
</div>
<div class="paragraph">
<p>SUSE Security Admission Controller works as a Kubernetes Admission Webhook. Kubernetes specifies
using <a href="https://en.wikipedia.org/wiki/Transport_Layer_Security">Transport Layer
Security</a> (TLS) to secure all Webhook endpoints. The <code>kubewarden-controller</code>
sets up this secure communication by:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Generating a self-signed Certificate Authority</p>
</li>
<li>
<p>Use this CA to generate a TLS certificate key for the <code>policy-server</code> Service.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>These objects are all stored as <code>Secret</code> resources in Kubernetes.</p>
</div>
<div class="paragraph">
<p>Finally, <code>kubewarden-controller</code> creates the <code>policy-server</code> Deployment and a
Kubernetes ClusterIP Service to expose it inside the cluster network.</p>
</div>
</div>
<div class="sect2">
<h3 id="_defining_the_first_policy"><a class="anchor" href="#_defining_the_first_policy"></a>Defining the first policy</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A policy must define which <code>policy-server</code> it must run on. It <strong>binds</strong> to a
<code>policy-server</code> instance. You can have different policies with the same Wasm
module and settings running in many PolicyServers. However, you can&#8217;t have a
single policy definition that runs in many PolicyServers.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>kubewarden-controller</code> notices the new <code>ClusterAdmissionPolicy</code> resource
and so finds the bound <code>policy-server</code> and reconciles it.</p>
</div>
</div>
<div class="sect2">
<h3 id="_reconciliation_of_a_policy_server"><a class="anchor" href="#_reconciliation_of_a_policy_server"></a>Reconciliation of a <code>policy-server</code></h3>
<div class="paragraph">
<p>When creating, modifying or deleting a <code>ClusterAdmissionPolicy</code> or
<code>AdmissionPolicy</code>, a reconciliation loop activates in <code>kubewarden-controller</code>,
for the <code>policy-server</code> owning the policy. This reconciliation loop creates a
<code>ConfigMap</code> with all the policies bound to the <code>policy-server</code>. Then the
Deployment rollout of the <code>policy-server</code> starts. This results in starting the
new <code>policy-server</code> instance with the updated configuration.</p>
</div>
<div class="paragraph">
<p>At start time, the <code>policy-server</code> reads its configuration from the ConfigMap
and downloads all the SUSE Security Admission Controller policies specified. You can download
SUSE Security Admission Controller policies from remote HTTP servers and container registries.</p>
</div>
<div class="paragraph">
<p>You use policy settings parameters to tune a policies' behavior. After startup
and policy download the <code>policy-server</code> checks the policy settings provided by
the user are valid.</p>
</div>
<div class="paragraph">
<p>The <code>policy-server</code> validates policy settings by invoking the
<code>validate_setting</code> function exposed by each policy. There is further
documentation in the <a href="../reference/spec/01-intro-spec.html" class="xref page">specification
reference</a> section of the documentation.</p>
</div>
<div class="paragraph">
<p>If any policies received wrong configuration parameters, from the users policy
specification, then any admission requests evaluated by that policy return an
error.</p>
</div>
<div class="paragraph">
<p>When SUSE Security Admission Controller has configured all policies, the <code>policy-server</code> spawns a
pool of worker threads to evaluate incoming requests using the SUSE Security Admission Controller
policies specified by the user.</p>
</div>
<div class="paragraph">
<p>Finally, the <code>policy-server</code> starts a HTTPS server, listening to incoming
validation requests. SUSE Security Admission Controller uses the TLS key and certificate created by
the SUSE Security Admission Controller controller to secure the web server.</p>
</div>
<div class="paragraph">
<p>The web server exposes each policy by a dedicated path following the naming
convention: <code>/validate/&lt;policy ID&gt;</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_making_kubernetes_aware_of_the_policy"><a class="anchor" href="#_making_kubernetes_aware_of_the_policy"></a>Making Kubernetes aware of the policy</h3>
<div class="paragraph">
<p>All <code>policy-server</code> instances have a
<a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/"><code>Readiness
Probe</code></a>, that <code>kubewarden-controller</code> uses to check when the <code>policy-server</code>
Deployment is ready to evaluate an
<a href="https://kubernetes.io/docs/reference/access-authn-authz/extensible-admission-controllers/#webhook-request-and-response"><code>AdmissionReview</code></a>.</p>
</div>
<div class="paragraph">
<p>Once SUSE Security Admission Controller marks the <code>policy-server</code> deployment as 'uniquely
reachable' or <code>Ready</code>, the <code>kubewarden-controller</code> makes the Kubernetes API
server aware of the new policy. This is by creating either a
<code>MutatingWebhookConfiguration</code> or a <code>ValidatingWebhookConfiguration</code> object. In
this context, 'uniquely reachable', means that all the PolicyServer instances
in the cluster have the latest policy configuration installed. The distinction,
is a fine point, but is necessary, due to how roll-out of PolicyServers works.
It&#8217;s possible to have the same policy, on different PolicyServers with
different configurations.</p>
</div>
<div class="paragraph">
<p>Each policy has a dedicated <code>MutatingWebhookConfiguration</code> or
<code>ValidatingWebhookConfiguration</code> pointing to the Webhook endpoint served by
<code>policy-server</code>. The endpoint is reachable at the <code>/validate/&lt;policy ID&gt;</code> URL.</p>
</div>
</div>
<div class="sect2">
<h3 id="_policy_in_action"><a class="anchor" href="#_policy_in_action"></a>Policy in action</h3>
<div class="paragraph">
<p>Now that all the necessary plumbing is complete, Kubernetes starts sending
Admission Review requests to the right <code>policy-server</code> endpoints.</p>
</div>
<div class="paragraph">
<p>A <code>policy-server</code> receives the Admission Request object and, based on the
endpoint that received the request, uses the correct policy to evaluate it.</p>
</div>
<div class="paragraph">
<p>SUSE Security Admission Controller evaluates each policy inside its own dedicated WebAssembly
sand-box. The communication between a <code>policy-server</code> instance (the "host") and
the WebAssembly policy (the "guest") uses the waPC communication protocol. The
protocol description is part of the
<a href="../tutorials/writing-policies/index.html" class="xref page">writing policies</a> documentation.
Policies can also use the interfaces provided by the
<a href="../tutorials/writing-policies/wasi/01-intro-wasi.html" class="xref page">Web Assembly System
Interface</a> (WASI).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_suse_security_admission_controller_handles_many_policyserver_and_policies"><a class="anchor" href="#_how_suse_security_admission_controller_handles_many_policyserver_and_policies"></a>How SUSE Security Admission Controller handles many PolicyServer and policies</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A cluster can have many PolicyServers and SUSE Security Admission Controller policies defined.
There are benefits of having many PolicyServers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>You can isolate noisy namespaces or tenants, or those generating many policy
evaluations, from the rest of the cluster so as not to adversely affect other
cluster operations.</p>
</li>
<li>
<p>You can run mission-critical policies in a dedicated PolicyServer pool,
making your infrastructure more resilient.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A PolicyServer resource defines each <code>policy-server</code> and a
<code>ClusterAdmissionPolicy</code> or <code>AdmissionPolicy</code> resource defines each policy.</p>
</div>
<div class="paragraph">
<p>A <code>ClusterAdmissionPolicy</code> and an <code>AdmissionPolicy</code> bind to a <code>policy-server</code>.
Any <code>ClusterAdmissionPolicy</code> not specifying a <code>policy-server</code> binds to the
default PolicyServer. If a <code>ClusterAdmissionPolicy</code> references a
<code>policy-server</code> that doesn&#8217;t exist, its state is <code>unschedulable</code>.</p>
</div>
<div class="paragraph">
<p>Each <code>policy-server</code> defines many validation endpoints, one for each policy
defined in its configuration file. You can load the same policy many times,
with different configuration parameters.</p>
</div>
<div class="paragraph">
<p>The <code>ValidatingWebhookConfiguration</code> and <code>MutatingWebhookConfiguration</code>
resources make the Kubernetes API server aware of these policies. Then
<code>kubewarden-controller</code> keeps the API server and configuration resources in
synchronization.</p>
</div>
<div class="paragraph">
<p>The Kubernetes API server dispatches incoming admission requests to the correct
validation endpoint exposed by <code>policy-server</code>.</p>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="audit-scanner/policy-reports.html">Audit Scanner - Policy Reports</a></span>
  <span class="next"><a href="../howtos/tasks.html">Common tasks</a></span>
</nav>
</article>
  </div>
</main>
</div>
<script src="../../../../_/js/site.js"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
<script src="../../../../_/js/vendor/lunr.js"></script>
<script src="../../../../_/js/vendor/lunr-languages.js"></script>
<script src="../../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../../.." data-snippet-length="100" data-stylesheet="../../../../_/css/search.css"></script>
<script async src="../../../../search-index.js"></script>
<script src="../../../../_/js/vendor/langSelection.js"></script>
<script async src="../../../../_/js/vendor/tabs.js"></script>


<script src="../../../../_/js/CNLanguageSwitcher.js"></script>
  </body>
</html>
